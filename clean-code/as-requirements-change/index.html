<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.46">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <meta name="google-site-verification" content="sHfBWIoCUOYFXJ3b0ulN8jp9jpD8SEW5Wpxvlk-UABA"><link rel="apple-touch-icon" sizes="180x180" href="/TIL/assets/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/TIL/assets/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/TIL/assets/favicons/favicon-16x16.png"><link rel="manifest" href="/TIL/manifest.webmanifest"><link rel="mask-icon" href="/TIL/assets/favicons/safari-pinned-tab.svg" color="#3a0839"><link rel="shortcut icon" href="/TIL/assets/favicons/favicon.ico"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+KR&display=swap"><meta name="msapplication-TileColor" content="#3a0839"><meta name="msapplication-config" content="/TIL/browserconfig.xml"><meta name="theme-color" content="#ffffff"><title>요구사항의 변화로 알아가는 클린코드 | 개발자 황준일</title><meta name="description" content="클린코드를 요구사항을 떼어놓고 클린코드를 이야기할 수 있을까?">
    <link rel="modulepreload" href="/TIL/assets/app.04106e09.js"><link rel="modulepreload" href="/TIL/assets/index.html.b4434d11.js"><link rel="modulepreload" href="/TIL/assets/index.html.c56a491a.js"><link rel="prefetch" href="/TIL/assets/index.html.e3c9c4d5.js"><link rel="prefetch" href="/TIL/assets/index.html.9d7f9d2c.js"><link rel="prefetch" href="/TIL/assets/index.html.8ef265a2.js"><link rel="prefetch" href="/TIL/assets/index.html.56c2b30c.js"><link rel="prefetch" href="/TIL/assets/index.html.48d3ca80.js"><link rel="prefetch" href="/TIL/assets/index.html.cf823089.js"><link rel="prefetch" href="/TIL/assets/index.html.9142fa77.js"><link rel="prefetch" href="/TIL/assets/index.html.d406d7df.js"><link rel="prefetch" href="/TIL/assets/index.html.18daa096.js"><link rel="prefetch" href="/TIL/assets/index.html.d494b22b.js"><link rel="prefetch" href="/TIL/assets/index.html.5d51c050.js"><link rel="prefetch" href="/TIL/assets/index.html.2c4351ad.js"><link rel="prefetch" href="/TIL/assets/index.html.fe742539.js"><link rel="prefetch" href="/TIL/assets/index.html.5f2a8612.js"><link rel="prefetch" href="/TIL/assets/index.html.cf3dff03.js"><link rel="prefetch" href="/TIL/assets/index.html.ea474703.js"><link rel="prefetch" href="/TIL/assets/index.html.4f1dd5b2.js"><link rel="prefetch" href="/TIL/assets/index.html.44b16a03.js"><link rel="prefetch" href="/TIL/assets/index.html.4ace73ea.js"><link rel="prefetch" href="/TIL/assets/index.html.57714077.js"><link rel="prefetch" href="/TIL/assets/index.html.fea87cba.js"><link rel="prefetch" href="/TIL/assets/index.html.d734e525.js"><link rel="prefetch" href="/TIL/assets/index.html.122595b7.js"><link rel="prefetch" href="/TIL/assets/index.html.7ce08fea.js"><link rel="prefetch" href="/TIL/assets/index.html.b86ed36c.js"><link rel="prefetch" href="/TIL/assets/index.html.b5fddc2b.js"><link rel="prefetch" href="/TIL/assets/index.html.dc7ee95c.js"><link rel="prefetch" href="/TIL/assets/index.html.1b5cc355.js"><link rel="prefetch" href="/TIL/assets/index.html.e3a3cfd5.js"><link rel="prefetch" href="/TIL/assets/index.html.c3ee5282.js"><link rel="prefetch" href="/TIL/assets/index.html.52630013.js"><link rel="prefetch" href="/TIL/assets/index.html.0b9d7d3a.js"><link rel="prefetch" href="/TIL/assets/index.html.cb1f8ea2.js"><link rel="prefetch" href="/TIL/assets/index.html.e29be526.js"><link rel="prefetch" href="/TIL/assets/index.html.ac31388d.js"><link rel="prefetch" href="/TIL/assets/index.html.7d12ff88.js"><link rel="prefetch" href="/TIL/assets/index.html.f6c2c2bf.js"><link rel="prefetch" href="/TIL/assets/index.html.f178f2f0.js"><link rel="prefetch" href="/TIL/assets/index.html.d9fe15d3.js"><link rel="prefetch" href="/TIL/assets/index.html.1368b499.js"><link rel="prefetch" href="/TIL/assets/index.html.4cfe19cc.js"><link rel="prefetch" href="/TIL/assets/index.html.3b68ec49.js"><link rel="prefetch" href="/TIL/assets/index.html.891e655a.js"><link rel="prefetch" href="/TIL/assets/index.html.7b33d973.js"><link rel="prefetch" href="/TIL/assets/index.html.95676cfb.js"><link rel="prefetch" href="/TIL/assets/index.html.edbed47a.js"><link rel="prefetch" href="/TIL/assets/index.html.36fc8f61.js"><link rel="prefetch" href="/TIL/assets/index.html.5b911251.js"><link rel="prefetch" href="/TIL/assets/index.html.f3942f07.js"><link rel="prefetch" href="/TIL/assets/index.html.aa720688.js"><link rel="prefetch" href="/TIL/assets/index.html.8f10b58b.js"><link rel="prefetch" href="/TIL/assets/index.html.8f677a7d.js"><link rel="prefetch" href="/TIL/assets/index.html.65eef5d2.js"><link rel="prefetch" href="/TIL/assets/index.html.bc7ab6bb.js"><link rel="prefetch" href="/TIL/assets/index.html.b76c19ed.js"><link rel="prefetch" href="/TIL/assets/index.html.be55147e.js"><link rel="prefetch" href="/TIL/assets/index.html.508280c0.js"><link rel="prefetch" href="/TIL/assets/index.html.a07dbd4c.js"><link rel="prefetch" href="/TIL/assets/index.html.9947f154.js"><link rel="prefetch" href="/TIL/assets/index.html.874fc0ce.js"><link rel="prefetch" href="/TIL/assets/index.html.3667939f.js"><link rel="prefetch" href="/TIL/assets/index.html.59eb21a9.js"><link rel="prefetch" href="/TIL/assets/index.html.06e2fa75.js"><link rel="prefetch" href="/TIL/assets/index.html.84037637.js"><link rel="prefetch" href="/TIL/assets/index.html.2f4100d2.js"><link rel="prefetch" href="/TIL/assets/index.html.0d6f8185.js"><link rel="prefetch" href="/TIL/assets/404.html.0f07aaf0.js"><link rel="prefetch" href="/TIL/assets/index.html.b89cdb20.js"><link rel="prefetch" href="/TIL/assets/index.html.2dbb42b2.js"><link rel="prefetch" href="/TIL/assets/index.html.18bbf59e.js"><link rel="prefetch" href="/TIL/assets/index.html.794303a3.js"><link rel="prefetch" href="/TIL/assets/index.html.cfbb02f0.js"><link rel="prefetch" href="/TIL/assets/index.html.77ce4df0.js"><link rel="prefetch" href="/TIL/assets/index.html.997f9343.js"><link rel="prefetch" href="/TIL/assets/index.html.a0f7bfad.js"><link rel="prefetch" href="/TIL/assets/index.html.9468dbaf.js"><link rel="prefetch" href="/TIL/assets/index.html.51d46c8c.js"><link rel="prefetch" href="/TIL/assets/index.html.50954586.js"><link rel="prefetch" href="/TIL/assets/index.html.dfd1a119.js"><link rel="prefetch" href="/TIL/assets/index.html.b9ce9215.js"><link rel="prefetch" href="/TIL/assets/index.html.058f7192.js"><link rel="prefetch" href="/TIL/assets/index.html.3c67f0a4.js"><link rel="prefetch" href="/TIL/assets/index.html.55f4861a.js"><link rel="prefetch" href="/TIL/assets/index.html.800cd76e.js"><link rel="prefetch" href="/TIL/assets/index.html.45f5c5a7.js"><link rel="prefetch" href="/TIL/assets/index.html.d154eccd.js"><link rel="prefetch" href="/TIL/assets/index.html.8c8dc346.js"><link rel="prefetch" href="/TIL/assets/index.html.7c11bedb.js"><link rel="prefetch" href="/TIL/assets/index.html.083c0275.js"><link rel="prefetch" href="/TIL/assets/index.html.14a29a78.js"><link rel="prefetch" href="/TIL/assets/index.html.015ad2b4.js"><link rel="prefetch" href="/TIL/assets/index.html.362dd394.js"><link rel="prefetch" href="/TIL/assets/index.html.04b6f622.js"><link rel="prefetch" href="/TIL/assets/index.html.5dfc8ca5.js"><link rel="prefetch" href="/TIL/assets/index.html.232f751f.js"><link rel="prefetch" href="/TIL/assets/index.html.eaad3793.js"><link rel="prefetch" href="/TIL/assets/index.html.166beafb.js"><link rel="prefetch" href="/TIL/assets/index.html.945fbd4c.js"><link rel="prefetch" href="/TIL/assets/index.html.7002b70b.js"><link rel="prefetch" href="/TIL/assets/index.html.4a68300d.js"><link rel="prefetch" href="/TIL/assets/index.html.0336d2a0.js"><link rel="prefetch" href="/TIL/assets/index.html.7f85cce8.js"><link rel="prefetch" href="/TIL/assets/index.html.2b298f67.js"><link rel="prefetch" href="/TIL/assets/index.html.97eb3fb5.js"><link rel="prefetch" href="/TIL/assets/index.html.0dfab9d9.js"><link rel="prefetch" href="/TIL/assets/index.html.e9d41501.js"><link rel="prefetch" href="/TIL/assets/index.html.3168d306.js"><link rel="prefetch" href="/TIL/assets/index.html.86c8995c.js"><link rel="prefetch" href="/TIL/assets/index.html.365851b7.js"><link rel="prefetch" href="/TIL/assets/index.html.b2bfe30f.js"><link rel="prefetch" href="/TIL/assets/index.html.5ef0d50b.js"><link rel="prefetch" href="/TIL/assets/index.html.851238bc.js"><link rel="prefetch" href="/TIL/assets/index.html.2a5c2459.js"><link rel="prefetch" href="/TIL/assets/index.html.0667f2ac.js"><link rel="prefetch" href="/TIL/assets/index.html.c65072ec.js"><link rel="prefetch" href="/TIL/assets/index.html.8e40b48e.js"><link rel="prefetch" href="/TIL/assets/index.html.13373268.js"><link rel="prefetch" href="/TIL/assets/index.html.cedd955b.js"><link rel="prefetch" href="/TIL/assets/index.html.dec6a883.js"><link rel="prefetch" href="/TIL/assets/index.html.fe9788ab.js"><link rel="prefetch" href="/TIL/assets/index.html.bd7aba3c.js"><link rel="prefetch" href="/TIL/assets/index.html.ab7a6034.js"><link rel="prefetch" href="/TIL/assets/index.html.183dbe39.js"><link rel="prefetch" href="/TIL/assets/index.html.a4386ac8.js"><link rel="prefetch" href="/TIL/assets/index.html.d9afa800.js"><link rel="prefetch" href="/TIL/assets/index.html.0f88a083.js"><link rel="prefetch" href="/TIL/assets/index.html.38ff06cb.js"><link rel="prefetch" href="/TIL/assets/index.html.d28ce194.js"><link rel="prefetch" href="/TIL/assets/index.html.872b2ad1.js"><link rel="prefetch" href="/TIL/assets/index.html.b9f34e18.js"><link rel="prefetch" href="/TIL/assets/index.html.2baafaa6.js"><link rel="prefetch" href="/TIL/assets/index.html.d9bfefb6.js"><link rel="prefetch" href="/TIL/assets/index.html.84adc96c.js"><link rel="prefetch" href="/TIL/assets/404.html.4e879e85.js"><link rel="prefetch" href="/TIL/assets/404.3d3eb881.js"><link rel="prefetch" href="/TIL/assets/Layout.f9a56ffb.js">
    <link rel="stylesheet" href="/TIL/assets/style.c195f57f.css">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/TIL/" class=""><img class="logo" src="https://avatars1.githubusercontent.com/u/18749057?s=460&amp;v=4" alt="개발자 황준일"><span class="site-name can-hide">개발자 황준일</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/TIL/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a href="/TIL/About/" class="" aria-label="About"><!--[--><!--]--> About <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/TIL/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a href="/TIL/About/" class="" aria-label="About"><!--[--><!--]--> About <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">요구사항의 변화로 알아가는 클린코드 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#초기-요구사항" class="router-link-active router-link-exact-active sidebar-item" aria-label="초기 요구사항"><!--[--><!--]--> 초기 요구사항 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_1단계-vanilla-javascript-로-구현하기" class="router-link-active router-link-exact-active sidebar-item" aria-label="1단계: Vanilla Javascript 로 구현하기"><!--[--><!--]--> 1단계: Vanilla Javascript 로 구현하기 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_1-프로젝트-세팅-생략해도-무방" class="router-link-active router-link-exact-active sidebar-item" aria-label="(1) 프로젝트 세팅 (생략해도 무방)"><!--[--><!--]--> (1) 프로젝트 세팅 (생략해도 무방) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_2-일단-구현하기" class="router-link-active router-link-exact-active sidebar-item" aria-label="(2) 일단 구현하기"><!--[--><!--]--> (2) 일단 구현하기 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_3-1단계-데모" class="router-link-active router-link-exact-active sidebar-item" aria-label="(3) 1단계 데모"><!--[--><!--]--> (3) 1단계 데모 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_4-새로운-요구사항을-토대로-문제-분석하기" class="router-link-active router-link-exact-active sidebar-item" aria-label="(4) 새로운 요구사항을 토대로 문제 분석하기"><!--[--><!--]--> (4) 새로운 요구사항을 토대로 문제 분석하기 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_4-어떻게-개선할-수-있을까" class="router-link-active router-link-exact-active sidebar-item" aria-label="(4) 어떻게 개선할 수 있을까?"><!--[--><!--]--> (4) 어떻게 개선할 수 있을까? <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_2단계-현재-코드-리팩토링" class="router-link-active router-link-exact-active sidebar-item" aria-label="2단계: 현재 코드 리팩토링"><!--[--><!--]--> 2단계: 현재 코드 리팩토링 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_1-테스트-작성" class="router-link-active router-link-exact-active sidebar-item" aria-label="(1) 테스트 작성"><!--[--><!--]--> (1) 테스트 작성 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_2-상태와-상태를-변경하는-함수-정의하기" class="router-link-active router-link-exact-active sidebar-item" aria-label="(2) 상태와 상태를 변경하는 함수 정의하기"><!--[--><!--]--> (2) 상태와 상태를 변경하는 함수 정의하기 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_3-상태를-기반으로-ui를-표현하기" class="router-link-active router-link-exact-active sidebar-item" aria-label="(3) 상태를 기반으로 UI를 표현하기"><!--[--><!--]--> (3) 상태를 기반으로 UI를 표현하기 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_4-함수와-ui를-이벤트로-연결하기" class="router-link-active router-link-exact-active sidebar-item" aria-label="(4) 함수와 UI를 이벤트로 연결하기"><!--[--><!--]--> (4) 함수와 UI를 이벤트로 연결하기 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_5-파일-분할" class="router-link-active router-link-exact-active sidebar-item" aria-label="(5) 파일 분할"><!--[--><!--]--> (5) 파일 분할 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_6-간단한-단위-테스트-작성" class="router-link-active router-link-exact-active sidebar-item" aria-label="(6) 간단한 단위 테스트 작성"><!--[--><!--]--> (6) 간단한 단위 테스트 작성 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_8-2단계-데모" class="router-link-active router-link-exact-active sidebar-item" aria-label="(8) 2단계 데모"><!--[--><!--]--> (8) 2단계 데모 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_9-summary" class="router-link-active router-link-exact-active sidebar-item" aria-label="(9) Summary"><!--[--><!--]--> (9) Summary <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_3단계-추가-요구사항-구현하기" class="router-link-active router-link-exact-active sidebar-item" aria-label="3단계: 추가 요구사항 구현하기"><!--[--><!--]--> 3단계: 추가 요구사항 구현하기 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_1-도메인-레벨-변화" class="router-link-active router-link-exact-active sidebar-item" aria-label="(1) 도메인 레벨 변화"><!--[--><!--]--> (1) 도메인 레벨 변화 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_2-컴포넌트-레벨-변화" class="router-link-active router-link-exact-active sidebar-item" aria-label="(2) 컴포넌트 레벨 변화"><!--[--><!--]--> (2) 컴포넌트 레벨 변화 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_3-이벤트-핸들링-추가" class="router-link-active router-link-exact-active sidebar-item" aria-label="(3) 이벤트 핸들링 추가"><!--[--><!--]--> (3) 이벤트 핸들링 추가 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_4-테스트-업데이트" class="router-link-active router-link-exact-active sidebar-item" aria-label="(4) 테스트 업데이트"><!--[--><!--]--> (4) 테스트 업데이트 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_5-3단계-데모" class="router-link-active router-link-exact-active sidebar-item" aria-label="(5) 3단계 데모"><!--[--><!--]--> (5) 3단계 데모 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_6-summary" class="router-link-active router-link-exact-active sidebar-item" aria-label="(6) Summary"><!--[--><!--]--> (6) Summary <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_4단계-react로-전환-기술-요구사항의-변화" class="router-link-active router-link-exact-active sidebar-item" aria-label="4단계: React로 전환 (기술 요구사항의 변화)"><!--[--><!--]--> 4단계: React로 전환 (기술 요구사항의 변화) <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_1-react-세팅하기" class="router-link-active router-link-exact-active sidebar-item" aria-label="(1) React 세팅하기"><!--[--><!--]--> (1) React 세팅하기 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_2-각-레이어별-전환-분석" class="router-link-active router-link-exact-active sidebar-item" aria-label="(2) 각 레이어별 전환 분석"><!--[--><!--]--> (2) 각 레이어별 전환 분석 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_3-전환-과정에서-드러난-기존-설계의-장점" class="router-link-active router-link-exact-active sidebar-item" aria-label="(3) 전환 과정에서 드러난 기존 설계의 장점"><!--[--><!--]--> (3) 전환 과정에서 드러난 기존 설계의 장점 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_4-테스트-코드-작성" class="router-link-active router-link-exact-active sidebar-item" aria-label="(4) 테스트 코드 작성"><!--[--><!--]--> (4) 테스트 코드 작성 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_5-4단계-데모" class="router-link-active router-link-exact-active sidebar-item" aria-label="(5) 4단계 데모"><!--[--><!--]--> (5) 4단계 데모 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_6-summary-좋은-설계의-검증" class="router-link-active router-link-exact-active sidebar-item" aria-label="(6) Summary: 좋은 설계의 검증"><!--[--><!--]--> (6) Summary: 좋은 설계의 검증 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_5단계-react-상태관리와-성능최적화" class="router-link-active router-link-exact-active sidebar-item" aria-label="5단계: React 상태관리와 성능최적화"><!--[--><!--]--> 5단계: React 상태관리와 성능최적화 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_1-현재-코드의-문제점-분석" class="router-link-active router-link-exact-active sidebar-item" aria-label="(1) 현재 코드의 문제점 분석"><!--[--><!--]--> (1) 현재 코드의 문제점 분석 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_2-상태관리-라이브러리의-필요성" class="router-link-active router-link-exact-active sidebar-item" aria-label="(2) 상태관리 라이브러리의 필요성"><!--[--><!--]--> (2) 상태관리 라이브러리의 필요성 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_3-zustand를-활용한-문제-해결" class="router-link-active router-link-exact-active sidebar-item" aria-label="(3) Zustand를 활용한 문제 해결"><!--[--><!--]--> (3) Zustand를 활용한 문제 해결 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_4-결과-비교" class="router-link-active router-link-exact-active sidebar-item" aria-label="(4) 결과 비교"><!--[--><!--]--> (4) 결과 비교 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_5-5단계-데모" class="router-link-active router-link-exact-active sidebar-item" aria-label="(5) 5단계 데모"><!--[--><!--]--> (5) 5단계 데모 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_6-summary-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="(6) Summary"><!--[--><!--]--> (6) Summary <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#학습-과정-정리" class="router-link-active router-link-exact-active sidebar-item" aria-label="학습 과정 정리"><!--[--><!--]--> 학습 과정 정리 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_1-학습-과정의-전체-흐름" class="router-link-active router-link-exact-active sidebar-item" aria-label="(1) 학습 과정의 전체 흐름"><!--[--><!--]--> (1) 학습 과정의 전체 흐름 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_2-핵심-인사이트" class="router-link-active router-link-exact-active sidebar-item" aria-label="(2) 핵심 인사이트"><!--[--><!--]--> (2) 핵심 인사이트 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_3-학습한-내용을-실무에서-어떻게-활용할-수-있을까" class="router-link-active router-link-exact-active sidebar-item" aria-label="(3) 학습한 내용을 실무에서 어떻게 활용할 수 있을까?"><!--[--><!--]--> (3) 학습한 내용을 실무에서 어떻게 활용할 수 있을까? <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_4-전체-데모-및-코드" class="router-link-active router-link-exact-active sidebar-item" aria-label="(4) 전체 데모 및 코드"><!--[--><!--]--> (4) 전체 데모 및 코드 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#ai로-클린코드-규칙을-만들어가기" class="router-link-active router-link-exact-active sidebar-item" aria-label="AI로 클린코드 규칙을 만들어가기"><!--[--><!--]--> AI로 클린코드 규칙을 만들어가기 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_1-cursor" class="router-link-active router-link-exact-active sidebar-item" aria-label="(1) Cursor"><!--[--><!--]--> (1) Cursor <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_2-리팩토링을-위한-시스템-프롬프트-만들고-활용하기" class="router-link-active router-link-exact-active sidebar-item" aria-label="(2) 리팩토링을 위한 시스템 프롬프트 만들고 활용하기"><!--[--><!--]--> (2) 리팩토링을 위한 시스템 프롬프트 만들고 활용하기 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_99-항해플러스" class="router-link-active router-link-exact-active sidebar-item" aria-label="99. 항해플러스"><!--[--><!--]--> 99. 항해플러스 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_1-커리큘럼" class="router-link-active router-link-exact-active sidebar-item" aria-label="(1) 커리큘럼"><!--[--><!--]--> (1) 커리큘럼 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_2-멘토링" class="router-link-active router-link-exact-active sidebar-item" aria-label="(2) 멘토링"><!--[--><!--]--> (2) 멘토링 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_3-커뮤니티" class="router-link-active router-link-exact-active sidebar-item" aria-label="(3) 커뮤니티"><!--[--><!--]--> (3) 커뮤니티 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/TIL/clean-code/as-requirements-change/#_4-내가-생각하는-교육" class="router-link-active router-link-exact-active sidebar-item" aria-label="(4) 내가 생각하는 교육"><!--[--><!--]--> (4) 내가 생각하는 교육 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="요구사항의-변화로-알아가는-클린코드" tabindex="-1"><a class="header-anchor" href="#요구사항의-변화로-알아가는-클린코드" aria-hidden="true">#</a> 요구사항의 변화로 알아가는 클린코드</h1><p>요즘 머릿속에 있는 지식들을 어떻게 매끄럽게 연결할 수 있을까 고민하다가 오랜만에 글을 작성한다. 다만 한 번에 너무 많은 내용을 다루는 것 같아서 걱정이다. <s>글을 쓰는 나 자신에 대한 걱정이랄까… 완성할 수 있겠지?</s></p><p>나는 클린코드를 주제로 다룰 때 제일 중요한 게 요구사항이라고 생각한다. 요구사항을 떼어놓고 클린코드를 이야기할 수 있을까?</p><p>클린코드의 존재 이유는 유지보수이고, 이를 위해 무수히 많은 “읽기 좋은” 것에 대한 고민을 한다. 반대로, 유지보수를 할 일이 없다면 변경을 고려해서 코드를 작성할 필요가 없다. 가령 프로토타입을 만든다거나, PoC 를 위해 코드를 작성한다거나, 빠르게 만들어 배포하고 버릴 페이지 같은 것들을 만들때는 “읽기 좋은”이 아닌 “빠른 구현”에 더 초점을 낮추는 게 좋다.</p><p>어쨌든 클린코드는 유지보수와 한 몸이다. 그렇다면 클린코드를 공부하고 적용할 때 혹은 나의 코드가 좋은 코드인지 판단할 때 유지보수 상황에 대해 시뮬레이션을 해보면 좋다. 더 나아가서, 직접 유지보수 상황을 만들어서 코드를 통해 확인해보면 더 좋다. 그래서 클린코드를 다양한 요구사항의 변화를 토대로 학습하는 과정을 다뤄볼 것이다.</p><p>프론트엔드 영역에서 경험할 수 있는 복잡한 요구사항은 쇼핑몰이다. CMS 와 연결하기도 좋고, 유지보수를 하는 상황도 무척 많이 발생한다. 쇼핑몰의 일부 기능을 정의하고 구현하는 방식으로 진행해보자.</p><h2 id="초기-요구사항" tabindex="-1"><a class="header-anchor" href="#초기-요구사항" aria-hidden="true">#</a> 초기 요구사항</h2><p>학습을 위한 과정이기 때문에 최대한 간단하게 정의해보자.</p><ol><li>메인 페이지 <ul><li>상품 목록을 조회할 수 있다.</li><li>장바구니를 확인하고 관리할 수 있다.</li></ul></li><li>상품 목록 <ul><li>이름, 가격, 상품 이미지 등이 보여진다.</li><li>장바구니에 담을 수 있다.</li></ul></li><li>장바구니 <ul><li>수량 변경 (+/- 버튼)</li><li>개별 상품 삭제</li><li>장바구니 비우기</li><li>개별 상품 소계</li><li>전체 총합계</li></ul></li></ol><h2 id="_1단계-vanilla-javascript-로-구현하기" tabindex="-1"><a class="header-anchor" href="#_1단계-vanilla-javascript-로-구현하기" aria-hidden="true">#</a> 1단계: Vanilla Javascript 로 구현하기</h2><p>일단 이 글의 목적은 처음부터 좋은 코드를 작성하는 게 아닌 좋은 코드를 판단하기 위한 기준을 만들어가는 것이다. 그래서 일단 대충 작성한 코드가 필요하고, 코드의 문제를 정의하고 개선하는 과정으로 전개해보자.</p><h3 id="_1-프로젝트-세팅-생략해도-무방" tabindex="-1"><a class="header-anchor" href="#_1-프로젝트-세팅-생략해도-무방" aria-hidden="true">#</a> (1) 프로젝트 세팅 (생략해도 무방)</h3><ul><li><p>vite + typescript 기반으로 간단하게 프로젝트를 세팅해보자.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># vanilla ts 기준으로 설치</span>
$ <span class="token function">pnpm</span> create vite simple-clean-code-project --template vue

<span class="token comment"># 패키지 설치</span>
$ <span class="token builtin class-name">cd</span> simple-clean-code-project
$ <span class="token function">pnpm</span> <span class="token function">install</span>

<span class="token comment"># eslint, prettier 설치</span>
<span class="token comment">## 글을 작성하는 시점에 eslint는 9버전이 최신버전이다.</span>
$ <span class="token function">pnpm</span> create @eslint/config@latest
$ <span class="token function">pnpm</span> <span class="token function">add</span> --save-dev --save-exact prettier
$ <span class="token function">pnpm</span> <span class="token function">add</span> -D eslint-config-prettier

<span class="token comment"># 커밋을 하기 전에 eslint, tsc, prettier 등을 실행하기 위해 husky 설치 </span>
$ <span class="token function">pnpm</span> <span class="token function">add</span> --save-dev husky
$ <span class="token function">npm</span> <span class="token builtin class-name">exec</span> husky init
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>eslint 설정</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">import</span> js <span class="token keyword">from</span> <span class="token string">&quot;@eslint/js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> globals <span class="token keyword">from</span> <span class="token string">&quot;globals&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> tseslint <span class="token keyword">from</span> <span class="token string">&quot;typescript-eslint&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;eslint/config&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// eslint config가 추가되어야한다.</span>
<span class="token keyword">import</span> eslintConfigPrettier <span class="token keyword">from</span> <span class="token string">&quot;eslint-config-prettier/flat&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    files<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;**/*.{js,mjs,cjs,ts,mts,cts}&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">{</span> js <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;js/recommended&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    files<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;**/*.{js,mjs,cjs,ts,mts,cts}&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    languageOptions<span class="token operator">:</span> <span class="token punctuation">{</span> globals<span class="token operator">:</span> globals<span class="token punctuation">.</span>browser <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  tseslint<span class="token punctuation">.</span>configs<span class="token punctuation">.</span>recommended<span class="token punctuation">,</span>

  <span class="token comment">// config 배열 맨 뒤에 추가해주면 된다.</span>
  eslintConfigPrettier<span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>package.json에 npm scripts를 추가하자.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string-property property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;tsc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tsc --noEmit&quot;</span><span class="token punctuation">,</span> <span class="token comment">// type 검사</span>
  <span class="token string-property property">&quot;lint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint ./src --fix&quot;</span><span class="token punctuation">,</span> <span class="token comment">// eslint 로 정적 검사</span>
  <span class="token string-property property">&quot;prettier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prettier ./src --write&quot;</span><span class="token punctuation">,</span> <span class="token comment">// prettier 로 포맷팅</span>
  <span class="token string-property property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tsc &amp;&amp; vite build&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;preview&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite preview&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;prepare&quot;</span><span class="token operator">:</span> <span class="token string">&quot;husky&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>.husky/pre-commit 에 commit 시점에 실행할 명령어 추가해보자.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">pnpm</span> tsc
<span class="token function">pnpm</span> lint
<span class="token function">pnpm</span> prettier
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>초기 폴더 구조</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">.</span>
├── .gitignore
├── .husky
│   └── pre-commit
├── .prettierignore
├── .prettierrc
├── eslint.config.js
├── index.html
├── package.json
├── pnpm-lock.yaml
├── public
│   └── vite.svg
├── src
│   ├── main.ts
│   └── vite-env.d.ts
└── tsconfig.json
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_2-일단-구현하기" tabindex="-1"><a class="header-anchor" href="#_2-일단-구현하기" aria-hidden="true">#</a> (2) 일단 구현하기</h3><h4 id="_1-index-html" tabindex="-1"><a class="header-anchor" href="#_1-index-html" aria-hidden="true">#</a> 1) index.html</h4><p>처음에 UI 가 html 에 만들어져있다고 가정해보자. css는 cdn tailwind 를 통해 구성되었다.</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ko<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>쇼핑몰<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.tailwindcss.com<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-gray-100<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container mx-auto py-20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-3xl font-bold mb-8 text-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>쇼핑몰<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 상품 목록 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product-list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-4 rounded-lg shadow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://picsum.photos/id/1/200.webp<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>맥북 프로 14인치<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-full h-48 object-cover mb-4 rounded<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-lg font-bold mb-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>맥북 프로 14인치<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-gray-600 mb-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>2,990,000원<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-full bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 add-to-cart-btn<span class="token punctuation">&quot;</span></span>
                  <span class="token attr-name">data-product-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            장바구니 담기
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- ... 대략 10개의 상품이 존재 ... --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-4 rounded-lg shadow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://picsum.photos/id/10/200.webp<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>스피커<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-full h-48 object-cover mb-4 rounded<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-lg font-bold mb-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>스피커<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-gray-600 mb-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>250,000원<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-full bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 add-to-cart-btn<span class="token punctuation">&quot;</span></span>
                  <span class="token attr-name">data-product-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            장바구니 담기
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 장바구니 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-6 rounded-lg shadow w-[400px]<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-2xl font-bold mb-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>장바구니<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cart-items<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 장바구니 아이템들이 여기에 동적으로 추가됨 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mt-4 pt-4 border-t<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex justify-between items-center mb-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-lg font-bold<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>총 합계:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>total-price<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-xl font-bold text-blue-600<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>0원<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clear-cart<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-full bg-red-500 text-white py-2 px-4 rounded hover:bg-red-600<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          장바구니 비우기
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/src/main.ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-main-ts" tabindex="-1"><a class="header-anchor" href="#_2-main-ts" aria-hidden="true">#</a> 2) main.ts</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 장바구니의 가격을 업데이트 하는 함수</span>
<span class="token keyword">function</span> <span class="token function">updateTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> cartItems <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;cart-items&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> cartItemElements <span class="token operator">=</span> cartItems<span class="token operator">?.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>cartItemElements<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> element <span class="token keyword">of</span> cartItemElements<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> subtotalText <span class="token operator">=</span> element<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.subtotal&#39;</span><span class="token punctuation">)</span><span class="token operator">?.</span>textContent<span class="token punctuation">;</span>
      <span class="token keyword">const</span> subtotal <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>subtotalText<span class="token operator">?.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\D</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      total <span class="token operator">+=</span> subtotal<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> totalPriceEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;total-price&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>totalPriceEl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    totalPriceEl<span class="token punctuation">.</span>textContent <span class="token operator">=</span> total<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;원&#39;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> addToCartBtns <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&#39;.add-to-cart-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> element <span class="token keyword">of</span> addToCartBtns<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> target <span class="token operator">=</span> e<span class="token punctuation">.</span>target <span class="token keyword">as</span> HTMLButtonElement<span class="token punctuation">;</span>
      <span class="token keyword">const</span> productId <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;data-product-id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> productEl <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">&#39;.bg-white&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> productName <span class="token operator">=</span> productEl<span class="token operator">?.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;h3&#39;</span><span class="token punctuation">)</span><span class="token operator">?.</span>textContent<span class="token punctuation">;</span>
      <span class="token keyword">const</span> productPriceText <span class="token operator">=</span> productEl<span class="token operator">?.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;p&#39;</span><span class="token punctuation">)</span><span class="token operator">?.</span>textContent<span class="token punctuation">;</span>
      <span class="token keyword">const</span> productPrice <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>
        productPriceText<span class="token operator">?.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\D</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">&#39;0&#39;</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> productImg <span class="token operator">=</span> productEl<span class="token operator">?.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;img&#39;</span><span class="token punctuation">)</span><span class="token operator">?.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;src&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 장바구니에서 같은 상품 찾기</span>
      <span class="token keyword">const</span> cartItems <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;cart-items&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> existingItem <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> cartItemElements <span class="token operator">=</span> cartItems<span class="token operator">?.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cartItemElements<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> element <span class="token keyword">of</span> cartItemElements<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> itemEl <span class="token operator">=</span> element<span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>itemEl<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;data-product-id&#39;</span><span class="token punctuation">)</span> <span class="token operator">===</span> productId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            existingItem <span class="token operator">=</span> itemEl<span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>existingItem<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 기존 아이템 수량 증가</span>
        <span class="token keyword">const</span> quantityEl <span class="token operator">=</span> existingItem<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>
          <span class="token string">&#39;.quantity&#39;</span>
        <span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLSpanElement<span class="token punctuation">;</span>
        <span class="token keyword">let</span> currentQuantity <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>quantityEl<span class="token punctuation">.</span>textContent <span class="token operator">??</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        currentQuantity<span class="token operator">++</span><span class="token punctuation">;</span>
        quantityEl<span class="token punctuation">.</span>textContent <span class="token operator">=</span> currentQuantity<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 소계 업데이트</span>
        <span class="token keyword">const</span> subtotalEl <span class="token operator">=</span> existingItem<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>
          <span class="token string">&#39;.subtotal&#39;</span>
        <span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLSpanElement<span class="token punctuation">;</span>
        <span class="token keyword">const</span> newSubtotal <span class="token operator">=</span> currentQuantity <span class="token operator">*</span> productPrice<span class="token punctuation">;</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;newSubtotal&#39;</span><span class="token punctuation">,</span> newSubtotal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        subtotalEl<span class="token punctuation">.</span>textContent <span class="token operator">=</span> newSubtotal<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;원&#39;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 새 아이템 추가</span>
        <span class="token keyword">const</span> cartItemHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      &lt;div class=&quot;cart-item flex items-center gap-3 p-3 border-t&quot; data-product-id=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>productId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;
        &lt;img src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>productImg<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; alt=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>productName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; class=&quot;w-16 h-16 object-cover rounded&quot;&gt;
        &lt;div class=&quot;flex-1&quot;&gt;
          &lt;h4 class=&quot;font-bold text-sm&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>productName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/h4&gt;
          &lt;p class=&quot;text-gray-600 text-sm&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>productPrice<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">원&lt;/p&gt;
          &lt;div class=&quot;flex items-center gap-2 mt-2&quot;&gt;
            &lt;button class=&quot;decrease-btn bg-gray-300 text-gray-700 w-6 h-6 rounded text-sm&quot;&gt;-&lt;/button&gt;
            &lt;span class=&quot;quantity&quot;&gt;1&lt;/span&gt;
            &lt;button class=&quot;increase-btn bg-gray-300 text-gray-700 w-6 h-6 rounded text-sm&quot;&gt;+&lt;/button&gt;
            &lt;button class=&quot;remove-btn bg-red-500 text-white px-2 py-1 rounded text-xs ml-2&quot;&gt;삭제&lt;/button&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class=&quot;text-right&quot;&gt;
          &lt;span class=&quot;subtotal font-bold&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>productPrice<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">원&lt;/span&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        cartItems<span class="token operator">?.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">&#39;beforeend&#39;</span><span class="token punctuation">,</span> cartItemHTML<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token function">updateTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 장바구니 비우기 버튼</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;clear-cart&#39;</span><span class="token punctuation">)</span><span class="token operator">?.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> cartItems <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;cart-items&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cartItems<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      cartItems<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">updateTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 장바구니 아이템 이벤트 위임</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;cart-items&#39;</span><span class="token punctuation">)</span><span class="token operator">?.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> target <span class="token operator">=</span> e<span class="token punctuation">.</span>target <span class="token keyword">as</span> HTMLElement<span class="token punctuation">;</span>
    <span class="token keyword">const</span> cartItem <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 수량 증가 버튼 클릭시</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&#39;increase-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> quantityEl <span class="token operator">=</span> cartItem<span class="token operator">?.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>
        <span class="token string">&#39;.quantity&#39;</span>
      <span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLSpanElement<span class="token punctuation">;</span>
      <span class="token keyword">let</span> currentQuantity <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>quantityEl<span class="token punctuation">.</span>textContent <span class="token operator">??</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      currentQuantity<span class="token operator">++</span><span class="token punctuation">;</span>
      quantityEl<span class="token punctuation">.</span>textContent <span class="token operator">=</span> currentQuantity<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 가격 정보 가져오기</span>
      <span class="token keyword">const</span> priceText <span class="token operator">=</span> cartItem<span class="token operator">?.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;p&#39;</span><span class="token punctuation">)</span><span class="token operator">?.</span>textContent<span class="token punctuation">;</span>
      <span class="token keyword">const</span> price <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>priceText<span class="token operator">?.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\D</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 소계 업데이트</span>
      <span class="token keyword">const</span> subtotalEl <span class="token operator">=</span> cartItem<span class="token operator">?.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>
        <span class="token string">&#39;.subtotal&#39;</span>
      <span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLSpanElement<span class="token punctuation">;</span>
      <span class="token keyword">const</span> newSubtotal <span class="token operator">=</span> currentQuantity <span class="token operator">*</span> price<span class="token punctuation">;</span>
      subtotalEl<span class="token punctuation">.</span>textContent <span class="token operator">=</span> newSubtotal<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;원&#39;</span><span class="token punctuation">;</span>

      <span class="token function">updateTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 수량 감소 버튼 클릭시</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&#39;decrease-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> quantityEl <span class="token operator">=</span> cartItem<span class="token operator">?.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>
        <span class="token string">&#39;.quantity&#39;</span>
      <span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLSpanElement<span class="token punctuation">;</span>
      <span class="token keyword">let</span> currentQuantity <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>quantityEl<span class="token punctuation">.</span>textContent <span class="token operator">??</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>currentQuantity <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        currentQuantity<span class="token operator">--</span><span class="token punctuation">;</span>
        quantityEl<span class="token punctuation">.</span>textContent <span class="token operator">=</span> currentQuantity<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 가격 정보 가져오기</span>
        <span class="token keyword">const</span> priceText <span class="token operator">=</span> cartItem<span class="token operator">?.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;p&#39;</span><span class="token punctuation">)</span><span class="token operator">?.</span>textContent<span class="token punctuation">;</span>
        <span class="token keyword">const</span> price <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>priceText<span class="token operator">?.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\D</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 소계 업데이트</span>
        <span class="token keyword">const</span> subtotalEl <span class="token operator">=</span> cartItem<span class="token operator">?.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>
          <span class="token string">&#39;.subtotal&#39;</span>
        <span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLSpanElement<span class="token punctuation">;</span>
        <span class="token keyword">const</span> newSubtotal <span class="token operator">=</span> currentQuantity <span class="token operator">*</span> price<span class="token punctuation">;</span>
        subtotalEl<span class="token punctuation">.</span>textContent <span class="token operator">=</span> newSubtotal<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;원&#39;</span><span class="token punctuation">;</span>

        <span class="token function">updateTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 삭제 버튼 클릭시</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&#39;remove-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      cartItem<span class="token operator">?.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">updateTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-1단계-데모" tabindex="-1"><a class="header-anchor" href="#_3-1단계-데모" aria-hidden="true">#</a> (3) 1단계 데모</h3><ul><li>링크: <a href="https://junilhwang.github.io/simple-clean-code-project/step1.html" target="_blank" rel="noopener noreferrer">https://junilhwang.github.io/simple-clean-code-project/step1.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>전체코드: <a href="https://github.com/JunilHwang/simple-clean-code-project/tree/main/src/step1" target="_blank" rel="noopener noreferrer">https://github.com/JunilHwang/simple-clean-code-project/tree/main/src/step1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><div class="iframe-container"><iframe src="https://junilhwang.github.io/simple-clean-code-project/step1.html"></iframe></div><h3 id="_4-새로운-요구사항을-토대로-문제-분석하기" tabindex="-1"><a class="header-anchor" href="#_4-새로운-요구사항을-토대로-문제-분석하기" aria-hidden="true">#</a> (4) 새로운 요구사항을 토대로 문제 분석하기</h3><p>현재 요구사항은 굉장히 단순하다. 여기에 아래의 요구사항이 추가된다고 가정해보자.</p><div class="custom-container tip"><p class="custom-container-title">📝 새로운 요구사항</p><ol><li>상품목록 UI 변화 <ul><li>상품 검색 가능</li><li>상품 이름과 가격으로 정렬 가능</li></ul></li><li>상품에 새로운 속성 추가 <ul><li>재고가 추가되고, 남은 재고만큼만 장바구니에 추가 가능</li><li>재고가 0일 때 품절 상태가 되고 이를 UI에 반영</li></ul></li><li>UI 기능 추가 <ul><li>상품에서 다중 선택 후 장바구니 추가 가능</li></ul></li></ol></div><p>각각의 요구사항을 반영한다고 했을 때 어떤 어려움이 있는지 분석해보자.</p><h4 id="_1-상품목록-ui-변화" tabindex="-1"><a class="header-anchor" href="#_1-상품목록-ui-변화" aria-hidden="true">#</a> 1) 상품목록 UI 변화</h4><ul><li><p><strong>상품 검색 기능</strong></p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ❌ 현재 문제: 상품 데이터가 HTML에 분산되어 있음</span>
<span class="token keyword">const</span> productName <span class="token operator">=</span> productEl<span class="token operator">?.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;h3&#39;</span><span class="token punctuation">)</span><span class="token operator">?.</span>textContent<span class="token punctuation">;</span>
<span class="token keyword">const</span> productPrice <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>productPriceText<span class="token operator">?.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\D</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>데이터 접근의 어려움: 검색을 위해 매번 DOM을 순회하며 텍스트를 파싱해야 함</li><li>성능 문제: 검색할 때마다 모든 DOM 요소를 탐색해야 함</li><li>검색 로직의 복잡성: 가격은 문자열에서 숫자를 추출해야 하고, 이름은 DOM에서 가져와야 함</li></ul></li><li><p><strong>상품 정렬 기능</strong></p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- ❌ 현재: 상품들이 정적 HTML로 고정 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product-list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-4 rounded-lg shadow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-4 rounded-lg shadow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>DOM 재정렬의 복잡성: 정렬 시 DOM 요소들을 직접 제거했다가 다시 삽입해야 함</li><li>정렬 기준 데이터 추출: 매번 DOM에서 이름/가격을 파싱해서 정렬 로직을 수행해야 함</li><li>렌더링 상태 관리: 정렬 후 기존 이벤트 리스너들이 제대로 동작하는지 보장하기 어려움</li></ul></li></ul><h4 id="_2-상품에-새로운-속성-추가" tabindex="-1"><a class="header-anchor" href="#_2-상품에-새로운-속성-추가" aria-hidden="true">#</a> 2) 상품에 새로운 속성 추가</h4><ul><li><p><strong>재고 관리</strong></p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ❌ 현재: 재고 정보를 저장할 구조가 없음</span>
element<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 재고 체크 로직이 불가능</span>
  <span class="token comment">// 상품별 재고 데이터가 어디에도 없음</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>재고 데이터 저장소 부재: 상품별 재고 정보를 관리할 중앙화된 데이터 구조가 없음</li><li>재고 차감 로직의 어려움: 장바구니 추가 시 재고를 체크하고 차감하는 로직을 구현할 방법이 없음</li><li>실시간 재고 동기화: 여러 곳에서 같은 상품을 참조할 때 재고 상태 동기화가 어려움</li></ul></li><li><p><strong>품절 상태 UI 반영</strong></p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- ❌ 현재: 버튼 상태를 동적으로 관리할 구조가 없음 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-full bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 add-to-cart-btn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  장바구니 담기
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>동적 UI 업데이트의 어려움: 재고 변화에 따라 버튼 상태(활성/비활성)와 텍스트를 업데이트하는 구조가 없음</li><li>UI 상태와 데이터 동기화: 재고 데이터 변경 시 관련된 모든 UI 요소들을 찾아서 업데이트해야 하는 복잡성</li><li>조건부 렌더링: 품절 시 다른 스타일이나 메시지를 보여주려면 DOM 조작 코드가 복잡해짐</li></ul></li></ul><h4 id="_3-ui-기능-추가" tabindex="-1"><a class="header-anchor" href="#_3-ui-기능-추가" aria-hidden="true">#</a> 3) UI 기능 추가</h4><ul><li><p><strong>상품 다중 선택 기능</strong></p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ❌ 현재: 개별 상품 선택 상태를 관리할 구조가 없음</span>
<span class="token keyword">const</span> addToCartBtns <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&#39;.add-to-cart-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> element <span class="token keyword">of</span> addToCartBtns<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  element<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 단일 상품만 처리 가능</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>선택 상태 추적의 어려움: 체크박스 UI를 추가하더라도 어떤 상품들이 선택되었는지 추적할 중앙화된 방법이 없음</li><li>일괄 처리 로직의 복잡성: 선택된 여러 상품을 한 번에 장바구니에 추가할 때 재고 체크와 UI 업데이트를 동기화하기 어려움</li><li>UI 상태 관리: 전체선택/해제 기능 구현 시 모든 체크박스 상태를 개별적으로 관리해야 함</li></ul></li><li><p><strong>장바구니 다중 선택 삭제</strong></p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ❌ 현재: 장바구니 아이템들이 개별 DOM 요소로만 관리됨</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;cart-items&#39;</span><span class="token punctuation">)</span><span class="token operator">?.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&#39;remove-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cartItem<span class="token operator">?.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 개별 삭제만 가능</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>다중 선택 상태 관리: 장바구니 아이템들의 선택 상태를 추적하고 관리할 구조가 없음</li><li>일괄 삭제 로직: 선택된 여러 아이템을 찾아서 동시에 삭제하고 총합계를 다시 계산하는 로직이 복잡함</li><li>전체선택 동기화: 전체선택 체크박스와 개별 아이템 체크박스들 간의 상태 동기화가 어려움</li></ul></li></ul><h4 id="문제-정리하기" tabindex="-1"><a class="header-anchor" href="#문제-정리하기" aria-hidden="true">#</a> 문제 정리하기</h4><p>앞에서 분석한 문제들을 종합해서 정리해보면 다음과 같다.</p><p><img src="/TIL/assets/diagram1.b18ed2b0.png" alt="diagram1.png 400"></p><ol><li><strong>데이터와 UI의 강결합</strong>: 모든 데이터가 DOM에 직접 저장되어 있어 데이터 조작이 어렵다.</li><li><strong>상태 관리 부재</strong>: 상품 목록, 장바구니, 선택 상태 등을 추적할 중앙화된 구조가 없다.</li><li><strong>이벤트 처리의 한계</strong>: 현재의 이벤트 위임 구조로는 복잡한 상호작용을 처리하기 어려움</li><li><strong>렌더링 로직 부재</strong>: 데이터 변경 시 UI를 일관되게 업데이트할 체계적인 방법이 없음</li></ol><h3 id="_4-어떻게-개선할-수-있을까" tabindex="-1"><a class="header-anchor" href="#_4-어떻게-개선할-수-있을까" aria-hidden="true">#</a> (4) 어떻게 개선할 수 있을까?</h3><p>나는 앞에서 언급한 1~4의 문제들이 <strong>명령형 프로그래밍으로 코드로 작성되어 문제가 발생했다</strong>고 생각한다.</p><div class="custom-container tip"><p class="custom-container-title">❗ 명령형 vs 선언형</p><p><strong>명령형 프로그래밍</strong></p><ul><li>&quot;어떻게(How)&quot; 해야 하는지에 집중</li><li>단계별로 명령을 나열</li><li>상태 변경을 직접 관리</li><li>DOM을 직접 조작</li></ul><p><strong>선언형 프로그래밍</strong></p><ul><li>&quot;무엇을(What)&quot; 원하는지에 집중</li><li>원하는 결과를 선언</li><li>상태에 따른 자동 렌더링</li><li>데이터 중심의 UI</li></ul></div><p>지금 작성된 코드는 &quot;무엇을 보여줄지&quot;가 아니라 &quot;어떻게 업데이트할지&quot;에 초점이 맞춰져있다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// &quot;어떻게(How)&quot; 해야 하는지 단계별로 기술</span>
<span class="token keyword">const</span> quantityEl <span class="token operator">=</span> existingItem<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.quantity&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLSpanElement<span class="token punctuation">;</span>
<span class="token keyword">let</span> currentQuantity <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>quantityEl<span class="token punctuation">.</span>textContent <span class="token operator">??</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 1단계: 수량 증가</span>
currentQuantity<span class="token operator">++</span><span class="token punctuation">;</span>

<span class="token comment">// 2단계: DOM 업데이트</span>
quantityEl<span class="token punctuation">.</span>textContent <span class="token operator">=</span> currentQuantity<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> subtotalEl <span class="token operator">=</span> existingItem<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.subtotal&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLSpanElement<span class="token punctuation">;</span>

<span class="token comment">// 3단계: 소계 계산</span>
<span class="token keyword">const</span> newSubtotal <span class="token operator">=</span> currentQuantity <span class="token operator">*</span> productPrice<span class="token punctuation">;</span>

<span class="token comment">// 4단계: 소계 업데이트</span>
subtotalEl<span class="token punctuation">.</span>textContent <span class="token operator">=</span> newSubtotal<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;원&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 5단계: 총계 업데이트</span>
<span class="token function">updateTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                   
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>앞에서 정의한 새로운 요구사항을 추가한다고 가정해보면 이런 모습일 것이다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 검색/정렬 기능 &gt;  이런 복잡한 단계가 필요</span>
<span class="token keyword">function</span> <span class="token function">sortProducts</span><span class="token punctuation">(</span>sortBy<span class="token operator">:</span> <span class="token string">&#39;name&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;price&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1. 모든 DOM 요소에서 데이터 추출</span>
  <span class="token comment">// 2. 추출한 데이터로 정렬 로직 수행  </span>
  <span class="token comment">// 3. DOM 요소들을 제거</span>
  <span class="token comment">// 4. 정렬된 순서로 DOM 요소들을 다시 생성</span>
  <span class="token comment">// 5. 이벤트 리스너 다시 연결</span>
<span class="token punctuation">}</span>

<span class="token comment">// 재고관리 &gt; 재고 변경 시 모든 UI를 수동으로 찾아서 업데이트</span>
<span class="token keyword">function</span> <span class="token function">updateStock</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> newStock<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1. 상품 목록에서 해당 상품 버튼 찾기</span>
  <span class="token comment">// 2. 버튼 상태 변경 (활성/비활성)</span>
  <span class="token comment">// 3. 장바구니에서 해당 상품 찾기</span>
  <span class="token comment">// 4. 수량 조절 버튼 상태 변경</span>
  <span class="token comment">// 5. 품절 메시지 표시/숨김</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>그렇다면 선언형 프로그래밍은 어떤 모습일까? 아마 이 글을 읽는 대부분의 사람들은 React 혹은 Vue를 사용한 경험이 있을 것이다. (아마도!?)</p><p><strong>Vue나 React의 경우 라이브러리 혹은 프레임워크 계층에서 코드를 자연스럽게 “선언형” 기반으로 작성하도록 유도하고 있다.</strong></p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 선언형은 &quot;무엇을(What)&quot; 보여줄지만 정의한다.</span>
<span class="token keyword">function</span> <span class="token function">ProductList</span><span class="token punctuation">(</span><span class="token punctuation">{</span> products<span class="token punctuation">,</span> onAddToCart <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 필터링 된 값을 토대로</span>
  <span class="token keyword">const</span> filteredProducts <span class="token operator">=</span> products
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>p <span class="token operator">=&gt;</span> p<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>searchQuery<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> sortBy <span class="token operator">===</span> <span class="token string">&#39;name&#39;</span> <span class="token operator">?</span> a<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">localeCompare</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token operator">:</span> a<span class="token punctuation">.</span>price <span class="token operator">-</span> b<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
  <span class="token comment">// 상품 목록을 보여준다.   </span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>filteredProducts<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>product <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
		    <span class="token operator">&lt;</span>ProductCard 
		      <span class="token punctuation">{</span><span class="token operator">...</span>product<span class="token punctuation">}</span> 
		      disabled<span class="token operator">=</span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>stock <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token comment">/*사실 컴포넌트 내부에서 계산해줘도 됨*/</span><span class="token punctuation">}</span>
		      <span class="token comment">// 이벤트가 발생하면 상태가 변경되어 컴포넌트 렌더링시에 ui에 반영된다.</span>
		      onAddToCart<span class="token operator">=</span><span class="token punctuation">{</span>onAddToCart<span class="token punctuation">}</span>
		    <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>위의 코드는 UI를 명령을 토대로 만들어 가는 것이 아닌, <strong>UI의 모습을 선언</strong>하고 데이터가 변경되면 자연스럽게 UI에 반영되는 구조다.</p><ol><li>상태를 정의하고, 상태를 변경하는 함수가 있어야 한다.</li><li>상태를 반영한 모습의 UI를 선언한다.</li><li>UI에서 발생하는 이벤트를 통해 함수를 실행한다.</li><li>함수가 실행되면 데이터가 변경되고, 데이터가 변경되면 UI에 반영된다.</li><li>결과적으로 UI와 상태를 깔끔하게 분리할 수 있다.</li></ol><div class="custom-container tip"><p class="custom-container-title">🤔 프론트엔드 개발자가 접할 수 있는 선언형 프로그래밍으로 작성하도록 유도하는 코드들은 어떤게 있을까?</p><ol><li><p>CSS</p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token comment">/* ✅ 선언형: &quot;무엇을&quot; 보여줄지 선언 */</span>
<span class="token selector">.product-card</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.product-card.sold-out</span> <span class="token punctuation">{</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> 0.5<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #f5f5f5<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.product-card.sold-out button</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #ccc<span class="token punctuation">;</span>
  <span class="token property">cursor</span><span class="token punctuation">:</span> not-allowed<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ❌ 명령형이라면 이렇게 했을 것</span>
<span class="token keyword">function</span> <span class="token function">updateProductCardStyle</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> isSoldOut<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&#39;flex&#39;</span><span class="token punctuation">;</span>
  element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>justifyContent <span class="token operator">=</span> <span class="token string">&#39;space-between&#39;</span><span class="token punctuation">;</span>
  element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token string">&#39;white&#39;</span><span class="token punctuation">;</span>
  element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>borderRadius <span class="token operator">=</span> <span class="token string">&#39;8px&#39;</span><span class="token punctuation">;</span>
  element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>padding <span class="token operator">=</span> <span class="token string">&#39;16px&#39;</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>isSoldOut<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>opacity <span class="token operator">=</span> <span class="token string">&#39;0.5&#39;</span><span class="token punctuation">;</span>
    element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token string">&#39;#f5f5f5&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> button <span class="token operator">=</span> element<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    button<span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token string">&#39;#ccc&#39;</span><span class="token punctuation">;</span>
    button<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cursor <span class="token operator">=</span> <span class="token string">&#39;not-allowed&#39;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Array 메서드 (함수형 프로그래밍)</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ✅ 선언형: &quot;무엇을&quot; 원하는지 선언</span>
<span class="token keyword">const</span> productData <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;맥북&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">2990000</span><span class="token punctuation">,</span> stock<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;아이폰&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">1550000</span><span class="token punctuation">,</span> stock<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;갤럭시&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">1200000</span><span class="token punctuation">,</span> stock<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> availableProducts <span class="token operator">=</span> productData
  <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>product <span class="token operator">=&gt;</span> product<span class="token punctuation">.</span>stock <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>product <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token operator">...</span>product<span class="token punctuation">,</span>
    displayPrice<span class="token operator">:</span> product<span class="token punctuation">.</span>price<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;원&#39;</span><span class="token punctuation">,</span>
    status<span class="token operator">:</span> product<span class="token punctuation">.</span>stock <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">&#39;available&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;sold-out&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span>price <span class="token operator">-</span> b<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ❌ 명령형이라면 이렇게 했을 것</span>
<span class="token keyword">function</span> <span class="token function">getAvailableProducts</span><span class="token punctuation">(</span>productData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">// 1단계: 재고가 있는 상품만 필터링</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> productData<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>productData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stock <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 2단계: 데이터 변환</span>
      <span class="token keyword">const</span> product <span class="token operator">=</span> <span class="token punctuation">{</span>
        id<span class="token operator">:</span> productData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span>
        name<span class="token operator">:</span> productData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>
        price<span class="token operator">:</span> productData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>price<span class="token punctuation">,</span>
        stock<span class="token operator">:</span> productData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stock<span class="token punctuation">,</span>
        displayPrice<span class="token operator">:</span> productData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>price<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;원&#39;</span><span class="token punctuation">,</span>
        status<span class="token operator">:</span> productData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stock <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">&#39;available&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;sold-out&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 3단계: 가격순 정렬</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> result<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> result<span class="token punctuation">.</span>length <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>price <span class="token operator">&gt;</span> result<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>price<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> temp <span class="token operator">=</span> result<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        result<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        result<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>HTML (선언적 구조)</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- ✅ 선언형: 구조와 의미를 선언 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search-form<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>상품 검색...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search-input<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sort-select<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>이름순<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>price<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>가격순<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product-grid<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 상품들이 표시될 곳 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ❌ 명령형이라면 이렇게 했을 것</span>
<span class="token keyword">function</span> <span class="token function">createSearchForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> form <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;form&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  form<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">&#39;search-form&#39;</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;input&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  input<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">&#39;search&#39;</span><span class="token punctuation">;</span>
  input<span class="token punctuation">.</span>placeholder <span class="token operator">=</span> <span class="token string">&#39;상품 검색...&#39;</span><span class="token punctuation">;</span>
  input<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">&#39;search-input&#39;</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> select <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;select&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  select<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">&#39;sort-select&#39;</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> option1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;option&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  option1<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">;</span>
  option1<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">&#39;이름순&#39;</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> option2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;option&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  option2<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">&#39;price&#39;</span><span class="token punctuation">;</span>
  option2<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">&#39;가격순&#39;</span><span class="token punctuation">;</span>

  select<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>option1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  select<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>option2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  form<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
  form<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>select<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> form<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>📝 SQL (데이터 조회)</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- ✅ 선언형: &quot;무엇을&quot; 원하는지 선언</span>
<span class="token keyword">SELECT</span>
  name<span class="token punctuation">,</span>
  price<span class="token punctuation">,</span>
  <span class="token keyword">CASE</span>
    <span class="token keyword">WHEN</span> stock <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token string">&#39;available&#39;</span>
    <span class="token keyword">ELSE</span> <span class="token string">&#39;sold-out&#39;</span>
  <span class="token keyword">END</span> <span class="token keyword">as</span> <span class="token keyword">status</span>
<span class="token keyword">FROM</span> products
<span class="token keyword">WHERE</span> stock <span class="token operator">&gt;</span> <span class="token number">0</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price <span class="token keyword">ASC</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ❌ 명령형이라면 이렇게 했을 것</span>
<span class="token keyword">function</span> <span class="token function">getAvailableProductsData</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">// 1. 모든 상품을 순회</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> product <span class="token keyword">of</span> products<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2. 재고가 있는지 확인</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>product<span class="token punctuation">.</span>stock <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 3. 상태 결정</span>
      <span class="token keyword">let</span> status<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>product<span class="token punctuation">.</span>stock <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        status <span class="token operator">=</span> <span class="token string">&#39;available&#39;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        status <span class="token operator">=</span> <span class="token string">&#39;sold-out&#39;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// 4. 결과에 추가</span>
      result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token operator">:</span> product<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
        price<span class="token operator">:</span> product<span class="token punctuation">.</span>price<span class="token punctuation">,</span>
        status<span class="token operator">:</span> status
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 5. 가격순으로 정렬</span>
  result<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span>price <span class="token operator">-</span> b<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol></div><p>그리고 프론트엔드에서 어플리케이션을 선언형 방식으로 만들어 가는 대표적인 방법은 <strong>MVC 패턴 혹은 MVVM 패턴</strong>을 적용하는 것이다.</p><ul><li>MVC(Model + View + Controller) <ul><li>개념 <ul><li><strong>Model</strong>: 어플리케이션의 핵심이 되는 데이터와 데이터를 조작하는 함수</li><li><strong>View</strong>: HTML</li><li><strong>Controller</strong>: HTML과 Model을 연결해주는 것. 가령, 이벤트 같은게 될 수 있음</li></ul></li><li>Controller를 무엇이라고 정의할 수 있을지는 생각하기 나름이기 때문에 헷갈리는 경우가 무척 많다. 그래서 나는 Backend와 비교해보고자 한다. <ul><li>backend의 MVC<div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// backend에서 사용하는 express.js의 router이다.</span>
<span class="token comment">// 사용자의 요청이 오면 이를 핸들링(controller)하고</span>
<span class="token comment">// 다양한 비즈니스 로직을 수행(model) 후 응답(view) 한다.</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> homeService<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>frontend의 mvc<div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 어플리케이션에서 사용되는 model이 정의되어있고</span>
<span class="token keyword">const</span> counter <span class="token operator">=</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> counterService <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">getIncrementValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    counter<span class="token punctuation">.</span><span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> counter<span class="token punctuation">.</span>value
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 사용자 요청(이벤트 발생)을 통해</span>
<span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;#main button.increase&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// model의 값을 가져온 다음</span>
  <span class="token keyword">const</span> newValue <span class="token operator">=</span> counterService<span class="token punctuation">.</span><span class="token function">getIncrementValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// view(html)에 model을 반영한다.</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;#count&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul></li><li>MVVM(Model + View + ViewModel): MVC의 Controller 대신 ViewModel 이 유사한 역할을 수행한다. <ul><li>개념 <ul><li><strong>Model</strong>: 어플리케이션의 상태와 이를 변경하는 함수의 묶음. 가령, 리액트로 따지면 state와 setState 가 될 것이다.</li><li><strong>View</strong>: MVC와 똑같이 HTML 이다.</li><li><strong>ViewModel</strong>: View의 형상을 하고 있는 데이터 객체이다. R</li></ul></li><li>React나 Vue에서는 ViewModel 가상돔이다. jsx를 이용하여 html과 유사한 문법으로 사용한다.<div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 보통 이렇게 jsx 문법으로 정의해서 사용한다.</span>
<span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>increment<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">증가</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
  
<span class="token comment">// 실제로는 이렇게 표현된다.</span>
<span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
  <span class="token keyword">return</span> <span class="token function">createElement</span><span class="token punctuation">(</span>
    <span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span>
    <span class="token keyword">null</span><span class="token punctuation">,</span> 
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;span&#39;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> onClick<span class="token operator">:</span> increment <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;증가&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
  
<span class="token comment">// createElement를 통해 만들어진 객체는 이런 모습일 것이다.</span>
<span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  children<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;span&#39;</span><span class="token punctuation">,</span> props<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> children<span class="token operator">:</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> props<span class="token operator">:</span> <span class="token punctuation">{</span> onClick<span class="token operator">:</span> increment <span class="token punctuation">}</span><span class="token punctuation">,</span> children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;증가&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>즉, ViewModel은 View(HTML)의 형태를 유사하게 본따서 만든 데이터(Model)이다. 그리고 ViewModel을 View로 변환하는 과정이 필요하다.</li></ul></li></ul><p>명령형 프로그래밍에 대한 이야기를 하다가 삼천포를 다녀왔다. 다시 본론으로 돌아오자면, 현재 구현된 내용에서 <strong>관심사(UI, Data, Function)를 분리하고 이를 연결하는 과정이 필요</strong>하다.</p><p>리팩토링 과정을 계획해보자.</p><p><img src="/TIL/assets/diagram2.cd2e3bd2.png" alt="diagram2.png"></p><ol><li>어플리케이션에서 사용되는 데이터(상태)를 정의하기</li><li>상태를 변경하는 함수를 정의하기</li><li>상태를 기반으로 UI를 표현하기 (선언형 UI)</li><li>상태를 변경하는 함수와 UI의 이벤트를 연결하기</li></ol><p>사실, 이렇게 리팩토링 이전에 제일 먼저 해야 하는 것은 <strong>테스트 작성</strong> 이다. 지금은 테스트를 할 수 있는 함수가 마땅치 않기 때문에 playwright + codegen 을 통해 간단하게 e2e 테스트를 추가하여 진행할 수 있다.</p><h2 id="_2단계-현재-코드-리팩토링" tabindex="-1"><a class="header-anchor" href="#_2단계-현재-코드-리팩토링" aria-hidden="true">#</a> 2단계: 현재 코드 리팩토링</h2><p>앞에서 이야기한 순서대로 진행해보도록 하자.</p><h3 id="_1-테스트-작성" tabindex="-1"><a class="header-anchor" href="#_1-테스트-작성" aria-hidden="true">#</a> (1) 테스트 작성</h3><p><a href="https://playwright.dev/docs/intro" target="_blank" rel="noopener noreferrer">https://playwright.dev/docs/intro<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>playwright을 이용하면 간단하게 e2e 테스트를 작성할 수 있다.</p><ul><li><p>playwright 설치하기</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># playwright 설치</span>
$ <span class="token function">pnpm</span> create playwright

<span class="token comment"># 설치하면 이런 파일과 폴더가 추가됨</span>
<span class="token builtin class-name">.</span>
├── playwright.config.ts
├── tests
│   └── example.spec.ts
└── tests-examples
    └── demo-todo-app.spec.ts

<span class="token comment"># tests-examples 제거</span>
$ <span class="token function">rm</span> -r tests-examples
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>npm scripts 수정하기</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// e2e 테스트 관련 스크립트를 추가	</span>
  <span class="token property">&quot;test:e2e&quot;</span><span class="token operator">:</span> <span class="token string">&quot;playwright test&quot;</span><span class="token punctuation">,</span> <span class="token comment">// headless browser로 실행</span>
  <span class="token property">&quot;test:e2e:ui&quot;</span><span class="token operator">:</span> <span class="token string">&quot;playwright test --ui&quot;</span> <span class="token comment">// browser를 실제로 보면서 실행</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>codegen 으로 test 만들기</p><p>참고링크: <a href="https://playwright.dev/docs/codegen-intro" target="_blank" rel="noopener noreferrer">https://playwright.dev/docs/codegen-intro<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 먼저 개발 서버를 실행해야 한다.</span>
$ <span class="token function">pnpm</span> run dev

<span class="token comment"># playwright codegen 실행</span>
$ <span class="token function">pnpm</span> <span class="token builtin class-name">exec</span> playwright codegen localhost:5173
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/TIL/assets/codegen.d92292f8.gif" alt="codegen.gif"></p></li><li><p>codegen으로 만들어진 결과물</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> test<span class="token punctuation">,</span> expect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@playwright/test&#39;</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;쇼핑몰 장바구니 테스트&#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> page <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">goto</span><span class="token punctuation">(</span><span class="token string">&#39;http://localhost:5173/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchAriaSnapshot</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    - img /맥북 프로 \\d+인치/
    - heading /맥북 프로 \\d+인치/ [level=3]
    - paragraph: /\\d+,\\d+,\\d+원/
    - button &quot;장바구니 담기&quot;
    - img /아이폰 \\d+ Pro/
    - heading /아이폰 \\d+ Pro/ [level=3]
    - paragraph: /\\d+,\\d+,\\d+원/
    - button &quot;장바구니 담기&quot;
    - img &quot;갤럭시 S24&quot;
    - heading &quot;갤럭시 S24&quot; [level=3]
    - paragraph: /\\d+,\\d+,\\d+원/
    - button &quot;장바구니 담기&quot;
    - img &quot;에어팟 프로&quot;
    - heading &quot;에어팟 프로&quot; [level=3]
    - paragraph: /\\d+,\\d+원/
    - button &quot;장바구니 담기&quot;
    - img &quot;맥북 에어&quot;
    - heading &quot;맥북 에어&quot; [level=3]
    - paragraph: /\\d+,\\d+,\\d+원/
    - button &quot;장바구니 담기&quot;
    - img &quot;아이패드 프로&quot;
    - heading &quot;아이패드 프로&quot; [level=3]
    - paragraph: /\\d+,\\d+,\\d+원/
    - button &quot;장바구니 담기&quot;
    - img &quot;삼성 모니터&quot;
    - heading &quot;삼성 모니터&quot; [level=3]
    - paragraph: /\\d+,\\d+원/
    - button &quot;장바구니 담기&quot;
    - img &quot;무선 키보드&quot;
    - heading &quot;무선 키보드&quot; [level=3]
    - paragraph: /\\d+,\\d+원/
    - button &quot;장바구니 담기&quot;
    - img &quot;무선 마우스&quot;
    - heading &quot;무선 마우스&quot; [level=3]
    - paragraph: /\\d+,\\d+원/
    - button &quot;장바구니 담기&quot;
    - img &quot;스피커&quot;
    - heading &quot;스피커&quot; [level=3]
    - paragraph: /\\d+,\\d+원/
    - button &quot;장바구니 담기&quot;
    - heading &quot;장바구니&quot; [level=2]
    - text: &quot;총 합계: 0원&quot;
    - button &quot;장바구니 비우기&quot;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#product-list div&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> hasText<span class="token operator">:</span> <span class="token string">&#39;맥북 프로 14인치 2,990,000원 장바구니 담기&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#product-list div&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> hasText<span class="token operator">:</span> <span class="token string">&#39;아이폰 15 Pro 1,550,000원 장바구니 담기&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#product-list div&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> hasText<span class="token operator">:</span> <span class="token string">&#39;갤럭시 S24 1,200,000원 장바구니 담기&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#product-list div&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> hasText<span class="token operator">:</span> <span class="token string">&#39;에어팟 프로 350,000원 장바구니 담기&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;+&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;+&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;+&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;+&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nth</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;+&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nth</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchAriaSnapshot</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    - heading &quot;장바구니&quot; [level=2]
    - img /맥북 프로 \\d+인치/
    - heading /맥북 프로 \\d+인치/ [level=4]
    - paragraph: /\\d+,\\d+,\\d+원/
    - button &quot;-&quot;
    - text: &quot;2&quot;
    - button &quot;+&quot;
    - button &quot;삭제&quot;
    - text: /\\d+,\\d+,\\d+원/
    - img /아이폰 \\d+ Pro/
    - heading /아이폰 \\d+ Pro/ [level=4]
    - paragraph: /\\d+,\\d+,\\d+원/
    - button &quot;-&quot;
    - text: &quot;3&quot;
    - button &quot;+&quot;
    - button &quot;삭제&quot;
    - text: /\\d+,\\d+,\\d+원/
    - img &quot;갤럭시 S24&quot;
    - heading &quot;갤럭시 S24&quot; [level=4]
    - paragraph: /\\d+,\\d+,\\d+원/
    - button &quot;-&quot;
    - text: &quot;3&quot;
    - button &quot;+&quot;
    - button &quot;삭제&quot;
    - text: /\\d+,\\d+,\\d+원/
    - img &quot;에어팟 프로&quot;
    - heading &quot;에어팟 프로&quot; [level=4]
    - paragraph: /\\d+,\\d+원/
    - button &quot;-&quot;
    - text: &quot;1&quot;
    - button &quot;+&quot;
    - button &quot;삭제&quot;
    - text: &quot;/\\\\d+,\\\\d+원 총 합계: \\\\d+,\\\\d+,\\\\d+원/&quot;
    - button &quot;장바구니 비우기&quot;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;-&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nth</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;삭제&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchAriaSnapshot</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    - heading &quot;장바구니&quot; [level=2]
    - img /맥북 프로 \\d+인치/
    - heading /맥북 프로 \\d+인치/ [level=4]
    - paragraph: /\\d+,\\d+,\\d+원/
    - button &quot;-&quot;
    - text: &quot;2&quot;
    - button &quot;+&quot;
    - button &quot;삭제&quot;
    - text: /\\d+,\\d+,\\d+원/
    - img &quot;갤럭시 S24&quot;
    - heading &quot;갤럭시 S24&quot; [level=4]
    - paragraph: /\\d+,\\d+,\\d+원/
    - button &quot;-&quot;
    - text: &quot;2&quot;
    - button &quot;+&quot;
    - button &quot;삭제&quot;
    - text: /\\d+,\\d+,\\d+원/
    - img &quot;에어팟 프로&quot;
    - heading &quot;에어팟 프로&quot; [level=4]
    - paragraph: /\\d+,\\d+원/
    - button &quot;-&quot;
    - text: &quot;1&quot;
    - button &quot;+&quot;
    - button &quot;삭제&quot;
    - text: &quot;/\\\\d+,\\\\d+원 총 합계: \\\\d+,\\\\d+,\\\\d+원/&quot;
    - button &quot;장바구니 비우기&quot;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;장바구니 비우기&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchAriaSnapshot</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    - heading &quot;장바구니&quot; [level=2]
    - text: &quot;총 합계: 0원&quot;
    - button &quot;장바구니 비우기&quot;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>playwright.config.ts 수정</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig<span class="token punctuation">,</span> devices <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@playwright/test&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  testDir<span class="token operator">:</span> <span class="token string">&#39;./tests&#39;</span><span class="token punctuation">,</span>
  fullyParallel<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  forbidOnly<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">CI</span><span class="token punctuation">,</span>
  retries<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">CI</span> <span class="token operator">?</span> <span class="token number">2</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  workers<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">CI</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
  reporter<span class="token operator">:</span> <span class="token string">&#39;html&#39;</span><span class="token punctuation">,</span>
  use<span class="token operator">:</span> <span class="token punctuation">{</span>
    trace<span class="token operator">:</span> <span class="token string">&#39;on-first-retry&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
  <span class="token comment">// 처음에는 chromium, webkit, firefox 등의 브라우저에 대해 동시에 테스트 하도록 설정 됨</span>
  <span class="token comment">// 지금 테스트를 정교하게 할 필요는 없어서 일단 chromium 만 남기고 제거</span>
  projects<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&#39;chromium&#39;</span><span class="token punctuation">,</span>
      use<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span>devices<span class="token punctuation">[</span><span class="token string">&#39;Desktop Chrome&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  
  <span class="token comment">// 테스트를 실행하기 전에 미리 개발서버를 실행하기 위해 필요함</span>
  webServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    command<span class="token operator">:</span> <span class="token string">&#39;pnpm run dev&#39;</span><span class="token punctuation">,</span>
    url<span class="token operator">:</span> <span class="token string">&#39;http://localhost:5173&#39;</span><span class="token punctuation">,</span>
    reuseExistingServer<span class="token operator">:</span> <span class="token operator">!</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">CI</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>테스트를 실행해서 확인해보기</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">pnpm</span> run test:e2e:ui
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/TIL/assets/e2e-test.bec8adc0.gif" alt="e2e-test.gif"></p><ul><li>테스트가 통과되는걸 확인했다.</li><li>각각의 단계에 대해 playwright이 스냅샷을 찍어준다.</li><li>마우스로 각 단계를 클릭하거나 키보드 방향키로 움직이면서 스냅샷을 확인해볼 수 있다.</li></ul></li></ul><p>설치부터 테스트 작성 및 실행까지 빠르면 5분 이내로 끝낼 수 있다.</p><h3 id="_2-상태와-상태를-변경하는-함수-정의하기" tabindex="-1"><a class="header-anchor" href="#_2-상태와-상태를-변경하는-함수-정의하기" aria-hidden="true">#</a> (2) 상태와 상태를 변경하는 함수 정의하기</h3><p>기존 main은 step1/main.ts 로 이름을 변경하고, step2/main.ts 를 새로 추가하여 진행하자.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>./src
├── ./step1/main.ts  <span class="token comment"># 기존 코드는 step1 폴더로 분리해서 유지하자.</span>
└── ./step2/main.ts  <span class="token comment"># 리팩토링을 위한 코드는 step2 폴더에 새로 만들자.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>그리고 기존의 index.html을 step1.html으로 변경하고, step2.html을 새로 만들자.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>./
├── ./step1.html
└── ./step2.html
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>step2.html</code>은 다음과 같이 작성한다.</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ko<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>쇼핑몰<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.tailwindcss.com<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-gray-100<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/src/step2/main.ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-타입-및-상태-정의" tabindex="-1"><a class="header-anchor" href="#_1-타입-및-상태-정의" aria-hidden="true">#</a> 1) 타입 및 상태 정의</h4><p>현재 어플리케이션에 필요한 상태는 상품목록(products)와 장바구니(carts) 등이 있다. 먼저 이에 대한 타입과 상태를 추가하자.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">interface</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  price<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  image<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Cart</span> <span class="token punctuation">{</span>
  productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 초기 상품 데이터</span>
<span class="token keyword">const</span> <span class="token constant">INITIAL_PRODUCTS</span><span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;맥북 프로 14인치&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">2_990_000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;https://picsum.photos/id/1/200.webp&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;아이폰 15 Pro&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">1_550_000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;https://picsum.photos/id/2/200.webp&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;3&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;갤럭시 S24&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">1_200_000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;https://picsum.photos/id/3/200.webp&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;4&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;에어팟 프로&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">350_000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;https://picsum.photos/id/4/200.webp&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;5&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;맥북 에어&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">1_590_000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;https://picsum.photos/id/5/200.webp&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;6&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;아이패드 프로&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">1_490_000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;https://picsum.photos/id/6/200.webp&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;7&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;삼성 모니터&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">450_000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;https://picsum.photos/id/7/200.webp&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;8&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;무선 키보드&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">120_000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;https://picsum.photos/id/8/200.webp&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;9&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;무선 마우스&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">80_000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;https://picsum.photos/id/9/200.webp&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;스피커&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">250_000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;https://picsum.photos/id/10/200.webp&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> carts<span class="token operator">:</span> Cart<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-상태를-변경하는-함수-정의" tabindex="-1"><a class="header-anchor" href="#_2-상태를-변경하는-함수-정의" aria-hidden="true">#</a> 2) 상태를 변경하는 함수 정의</h4><p>현재 요구사항은 장바구니에 대한 변화가 주된 내용이다.</p><ul><li>장바구니에 추가하기</li><li>장바구니에서 삭제하기</li><li>장바구니의 수량 변경하기</li><li>장바구니 비우기</li></ul><p>이렇게 네 가지를 함수로 구현하면 된다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> carts <span class="token operator">=</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">as</span> CartItem<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  
  <span class="token comment">// 장바구니에 추가하기</span>
  <span class="token function">add</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> cartItems <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token keyword">const</span> existingItem <span class="token operator">=</span> cartItems<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>productId <span class="token operator">===</span> productId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> existingItem
      <span class="token operator">?</span> cartItems<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
          item<span class="token punctuation">.</span>productId <span class="token operator">===</span> productId
            <span class="token operator">?</span> <span class="token punctuation">{</span> <span class="token operator">...</span>item<span class="token punctuation">,</span> quantity<span class="token operator">:</span> item<span class="token punctuation">.</span>quantity <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span>
            <span class="token operator">:</span> item
        <span class="token punctuation">)</span>
      <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>cartItems<span class="token punctuation">,</span> <span class="token punctuation">{</span> productId<span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
  <span class="token comment">// 장바구니의 수량 변경하기</span>
  <span class="token function">update</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> target <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>productId <span class="token operator">===</span> productId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      target<span class="token punctuation">.</span>quantity <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>quantity<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
  <span class="token comment">// 장바구니에서 삭제하기</span>
  <span class="token function">remove</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>productId <span class="token operator">!==</span> productId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
  <span class="token comment">// 장바구니 삭제하기</span>
  <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>여기서 잠시 고민을 할 필요가 있다. 지금은 carts가 배열로 표현 되는데, 주로 쓰이는 로직을 보면 productId를 기반으로 변경이 발생하는 것을 알 수 있다. 그렇다면 <strong>productId에 대한 Map 형태로 상태를 구성</strong>해주면 더 편리하게 함수를 구성할 수 있지 않을까?</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> carts <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ProductId에 대한 Map으로 정의한다.</span>
  value<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">as</span> Record<span class="token operator">&lt;</span>Product<span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> CartItem<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  
  <span class="token comment">// 배열 구조로 쓰임이 필요할 땐 `carts.items` 를 통해 호출할 수 있도록 getter를 만든다.</span>
  <span class="token keyword">get</span> <span class="token function">items</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
  <span class="token comment">// 값을 변경하는 메소드들이 무척 간략해졌다.</span>
  <span class="token function">add</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> quantity <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token operator">?.</span>quantity <span class="token operator">??</span> <span class="token number">0</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> productId<span class="token punctuation">,</span> quantity<span class="token operator">:</span> quantity <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">update</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>quantity<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">remove</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">delete</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>이 때 <code>this</code> 라는 키워드가 노출되는게 그닥 보기 좋진 않다. 이럴 때 취할 수 있는 방법이 하나 있다. 리액트의 커스텀훅을 만드는 것 처럼, <strong>함수로 내부 값을 추상화해서 관리</strong>하는 것이다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> createCarts <span class="token operator">=</span> <span class="token punctuation">(</span>initValue<span class="token operator">:</span> Record<span class="token operator">&lt;</span>Product<span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> CartItem<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> initValue<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token comment">// value를 값으로 반환하는 경우, 참조가 달라질 수 있다.</span>
    <span class="token comment">// 그래서 getter를 통해 정의하여 함수 내부의 value를 계속 참조하도록 해야 한다.</span>
    <span class="token comment">// getter로 반환할 경우, carts.value = 1234 처럼 밖에서 할당하는게 불가능해서 안전하다.</span>
    <span class="token comment">// 단, carts.value[1] = 1; 처럼 value 객체의 값은 수정이 가능해서 Object.freeze 로</span>
    <span class="token comment">// 객체내부의 변화를 방지할 수 있다.</span>
    <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">get</span> <span class="token function">items</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> CartItem<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
      <span class="token comment">// this.value를 사용하면 getter로 정의된 value를 사용하게 된다. 즉, 변경이 불가능한 value를 사용하게 된다.</span>
      <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">add</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> quantity <span class="token operator">=</span> value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token operator">?.</span>quantity <span class="token operator">??</span> <span class="token number">0</span>
      value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> productId<span class="token punctuation">,</span> quantity<span class="token operator">:</span> quantity <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">update</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> productId<span class="token punctuation">,</span> quantity<span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>quantity<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">remove</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">delete</span> value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>products와 carts를 합쳐서 store 라고 정의해보자. products에 몇 가지 함수도 추가해서 사용하면 좋을 것 같다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> <span class="token function-variable function">createProducts</span> <span class="token operator">=</span> <span class="token punctuation">(</span>initValue <span class="token operator">=</span> <span class="token constant">INITIAL_PRODUCTS</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// product도 valueMap 형태로 관리하면 편할 것 같다.</span>
  <span class="token keyword">const</span> value <span class="token operator">=</span> initValue<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token operator">...</span>acc<span class="token punctuation">,</span>
    <span class="token punctuation">[</span>product<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token operator">:</span> product
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> value <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">get</span> <span class="token function">items</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    <span class="token comment">// productId를 통해 가져오는 함수를 하나 만들었다.</span>
    <span class="token function-variable function">getProduct</span><span class="token operator">:</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> value<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// carts와 인터페이스를 동일하게 유지하기 위해 value를 통해 참조하도록 했다.</span>
  products<span class="token operator">:</span> <span class="token function">createProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  carts<span class="token operator">:</span> <span class="token function">createCarts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token comment">// products와 carts를 조합하여 사용하는 경우도 있을 것이다.</span>
  <span class="token comment">// 이럴 때는 store를 통해 참조하도록 만들면 좋다.</span>
  <span class="token keyword">get</span> <span class="token function">totalCartPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>carts<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> product <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>products<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>productId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> total <span class="token operator">+</span> <span class="token punctuation">(</span>product <span class="token operator">?</span> product<span class="token punctuation">.</span>price <span class="token operator">*</span> item<span class="token punctuation">.</span>quantity <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// products와 carts를 합친 데이터도 만들어서 관리할 수 있다.</span>
  <span class="token keyword">get</span> <span class="token function">cartsWithProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>carts<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> productId<span class="token punctuation">,</span> quantity <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> product <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>products<span class="token punctuation">.</span>value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>product<span class="token punctuation">,</span>
        quantity<span class="token punctuation">,</span>
        subtotal<span class="token operator">:</span> product<span class="token punctuation">.</span>price <span class="token operator">*</span> quantity<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>이렇게 코드를 작성하면 모든 비즈니스 로직이 store에 응집된다. 지금처럼 객체의 덩어리로 만들어서 관리할 수도 있고, 혹은 함수 뭉치의 조합으로 사용할 수도 있다. 개인적으로 지금과 같은 모습을 선호한다.</p><p><strong>중요한건 상태와 상태를 변화시키는 함수가 응집되어 있어야 관리하기가 수월하다는 점이다.</strong></p><p>이런걸 reducer 같은걸로 정의할 수도 있을 것이다.</p><h3 id="_3-상태를-기반으로-ui를-표현하기" tabindex="-1"><a class="header-anchor" href="#_3-상태를-기반으로-ui를-표현하기" aria-hidden="true">#</a> (3) 상태를 기반으로 UI를 표현하기</h3><h4 id="_1-템플릿" tabindex="-1"><a class="header-anchor" href="#_1-템플릿" aria-hidden="true">#</a> 1) 템플릿</h4><p>먼저 index.html에 있는 html 태그를 템플릿으로 만들어서 관리하는 방식을 상상하면 좋다.</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 상품 아이템 템플릿 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-4 rounded-lg shadow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://picsum.photos/id/1/200.webp<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>맥북 프로 14인치<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-full h-48 object-cover mb-4 rounded<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-lg font-bold mb-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>맥북 프로 14인치<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-gray-600 mb-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>2,990,000원<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-full bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 add-to-cart-btn<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">data-product-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    장바구니 담기
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 상품 목록 템플릿 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product-list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 상품 아이템들이 여기 들어가야함 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>이런 방식으로 html 템플릿을 가져다 사용할 수 있다. 한 번 전체 UI를 template literal로 정의해보자.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">function</span> <span class="token function">ProductItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> image<span class="token punctuation">,</span> name<span class="token punctuation">,</span> price<span class="token punctuation">,</span> id <span class="token punctuation">}</span><span class="token operator">:</span> Product<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div class=&quot;bg-white p-4 rounded-lg shadow&quot;&gt;
      &lt;img src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>image<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; alt=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; class=&quot;w-full h-48 object-cover mb-4 rounded&quot;&gt;
      &lt;h3 class=&quot;text-lg font-bold mb-2&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/h3&gt;
      &lt;p class=&quot;text-gray-600 mb-4&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>price<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">원&lt;/p&gt;
      &lt;button class=&quot;w-full bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 add-to-cart-btn&quot; data-product-id=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;
        장바구니 담기
      &lt;/button&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">CartItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token punctuation">,</span> quantity<span class="token punctuation">,</span> image<span class="token punctuation">,</span> name<span class="token punctuation">,</span> price <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token keyword">typeof</span> store<span class="token punctuation">.</span>cartsWithProduct<span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div class=&quot;cart-item flex items-center gap-3 p-3 border-t&quot; data-product-id=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;
      &lt;img src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>image<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; alt=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; class=&quot;w-16 h-16 object-cover rounded&quot;&gt;
      &lt;div class=&quot;flex-1&quot;&gt;
        &lt;h4 class=&quot;font-bold text-sm&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/h4&gt;
        &lt;p class=&quot;text-gray-600 text-sm&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>price<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">원&lt;/p&gt;
        &lt;div class=&quot;flex items-center gap-2 mt-2&quot;&gt;
          &lt;button class=&quot;decrease-btn bg-gray-300 text-gray-700 w-6 h-6 rounded text-sm&quot;&gt;-&lt;/button&gt;
          &lt;span class=&quot;quantity&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>quantity<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
          &lt;button class=&quot;increase-btn bg-gray-300 text-gray-700 w-6 h-6 rounded text-sm&quot;&gt;+&lt;/button&gt;
          &lt;button class=&quot;remove-btn bg-red-500 text-white px-2 py-1 rounded text-xs ml-2&quot;&gt;삭제&lt;/button&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div class=&quot;text-right&quot;&gt;
        &lt;span class=&quot;subtotal font-bold&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>price<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">원&lt;/span&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">CartSummary</span><span class="token punctuation">(</span><span class="token punctuation">{</span> totalPrice <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> totalPrice<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div class=&quot;mt-4 pt-4 border-t&quot;&gt;
      &lt;div class=&quot;flex justify-between items-center mb-2&quot;&gt;
        &lt;span class=&quot;text-lg font-bold&quot;&gt;총 합계:&lt;/span&gt;
        &lt;span id=&quot;total-price&quot; class=&quot;text-xl font-bold text-blue-600&quot;&gt;
	        </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>totalPrice<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">원
        &lt;/span&gt;
      &lt;/div&gt;
      &lt;button id=&quot;clear-cart&quot; class=&quot;w-full bg-red-500 text-white py-2 px-4 rounded hover:bg-red-600&quot;&gt;
        장바구니 비우기
      &lt;/button&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
	  &lt;div class=&quot;container mx-auto py-20&quot;&gt;
		  &lt;h1 class=&quot;text-3xl font-bold mb-8 text-center&quot;&gt;쇼핑몰&lt;/h1&gt;
		
		  &lt;div class=&quot;flex gap-8&quot;&gt;
		    &lt;div class=&quot;flex-1&quot;&gt;
		      &lt;div id=&quot;product-list&quot; class=&quot;grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4&quot;&gt;
		        </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>store<span class="token punctuation">.</span>products<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>ProductItem<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
		      &lt;/div&gt;
		    &lt;/div&gt;
		
		    &lt;!-- 장바구니 --&gt;
		    &lt;div class=&quot;bg-white p-6 rounded-lg shadow w-[400px]&quot;&gt;
		      &lt;h2 class=&quot;text-2xl font-bold mb-4&quot;&gt;장바구니&lt;/h2&gt;
		      &lt;div id=&quot;cart-items&quot;&gt;
		        </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>store<span class="token punctuation">.</span>cartsWithProduct<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>CartItem<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
		      &lt;/div&gt;
		      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">CartSummary</span><span class="token punctuation">(</span><span class="token punctuation">{</span> totalPrice<span class="token operator">:</span> store<span class="token punctuation">.</span>totalCartPrice <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
		    &lt;/div&gt;
		  &lt;/div&gt;
		&lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>마지막으로, App을 이용해 어플리케이션에 렌더링 하는 함수가 필요하다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> $root <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>$root<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    $root<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-함수와-ui를-이벤트로-연결하기" tabindex="-1"><a class="header-anchor" href="#_4-함수와-ui를-이벤트로-연결하기" aria-hidden="true">#</a> (4) 함수와 UI를 이벤트로 연결하기</h3><p>store(model)과 ui(view)를 선언했으니, 이제 store와 ui를 연결해주는 이벤트(controller)를 선언하고 관리해야 한다.</p><p>어떤 상호작용이 필요한지 고민해보자.</p><ol><li>상품목록에서 “장바구니 담기” 버튼을 클릭할 때</li><li>장바구니에서 +, - 버튼을 클릭할 때</li><li>장바구니에서 ‘삭제” 버튼을 클리할 때</li><li>장바구니에서 “장바구니 비우기” 버튼을 클릭할 때</li></ol><p>이를 토대로 이벤트를 선언해보자.</p><p>먼저 이벤트와 관련된 유틸 함수를 만들어야 한다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 이벤트를 추가해주는 유틸 함수를 하나 선언하자. 이게 일종의 controller 역할을 수행한다.</span>
<span class="token comment">// 이벤트를 직접 등록하는 것이 아닌 이벤트 위임 방식으로 등록하도록 만든다.</span>
<span class="token comment">// 직관적인 컨트롤러의 역할을 하기 위함이다.</span>
<span class="token keyword">function</span> <span class="token function">addEvent</span><span class="token punctuation">(</span>eventType<span class="token punctuation">,</span> selector<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> parent <span class="token operator">=</span> document<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  parent<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>eventType<span class="token punctuation">,</span> event <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 이벤트 위임 방식으로 등록할 경우, 중복 등록이 될 수 있기 때문에</span>
<span class="token comment">// setupEvents 함수를 이용하여 내부에서만 최초에 한 번 등록하는 장치를 만들어준다.</span>
<span class="token keyword">const</span> setupEvents <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> initialized <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function-variable function">setup</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>initialized<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      initialized <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>이제 렌더링 시점에 이벤트를 등록해보자.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> $root <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>$root<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    $root<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">setupEvents</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. 상품목록에서 “장바구니 담기” 버튼을 클릭할 때</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.add-to-cart-btn&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2. 장바구니에서 +, - 버튼을 클릭할 때</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.increase-btn, .decrease-btn&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3. 장바구니에서 ‘삭제” 버튼을 클리할 때</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.remove-btn&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 4. 장바구니에서 “장바구니 비우기” 버튼을 클릭할 때</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;#clear-cart&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>이벤트 함수 내부를 채워보자.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> $root <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>$root<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    $root<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">setupEvents</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. 상품목록에서 “장바구니 담기” 버튼을 클릭할 때</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.add-to-cart-btn&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target <span class="token keyword">as</span> HTMLElement<span class="token punctuation">;</span>
      <span class="token keyword">const</span> productId <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;data-product-id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>productId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>productId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2. 장바구니에서 +, - 버튼을 클릭할 때</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.increase-btn, .decrease-btn&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target <span class="token keyword">as</span> HTMLElement<span class="token punctuation">;</span>
      <span class="token keyword">const</span> cartItemEl <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> productId <span class="token operator">=</span> cartItemEl<span class="token operator">?.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;data-product-id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>productId <span class="token operator">||</span> <span class="token operator">!</span>cartItemEl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">const</span> quantity <span class="token operator">=</span> store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span>value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token operator">?.</span>quantity <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> nextQuantity <span class="token operator">=</span> quantity <span class="token operator">+</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&#39;increase-btn&#39;</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>productId<span class="token punctuation">,</span> nextQuantity<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3. 장바구니에서 ‘삭제” 버튼을 클리할 때</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.remove-btn&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target <span class="token keyword">as</span> HTMLElement<span class="token punctuation">;</span>
      <span class="token keyword">const</span> cartItemEl <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cartItemEl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> productId <span class="token operator">=</span> cartItemEl<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;data-product-id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>productId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>productId<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 4. 장바구니에서 “장바구니 비우기” 버튼을 클릭할 때</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;#clear-cart&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-파일-분할" tabindex="-1"><a class="header-anchor" href="#_5-파일-분할" aria-hidden="true">#</a> (5) 파일 분할</h3><p>일단은 역할별로 구분해서 파일을 분할해보자.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>./src/step2
├── apps.ts         <span class="token comment"># addEvent, setupEvents 등 어플리케이션 종속적인 로직</span>
├── components.ts   <span class="token comment"># ProductItem, CartItem, CartSummary 등 UI 선언 로직</span>
├── domains.ts      <span class="token comment"># carts, products 와 관련된 도메인 로직</span>
└── main.ts         <span class="token comment"># components, apps, domains 등을 엮어서 어플리케이션을 실행</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>domains.ts</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  price<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  image<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Cart</span> <span class="token punctuation">{</span>
  productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">CartWithProduct</span> <span class="token operator">=</span> Product
  <span class="token operator">&amp;</span> Pick<span class="token operator">&lt;</span>Cart<span class="token punctuation">,</span> <span class="token string">&#39;quantity&#39;</span><span class="token operator">&gt;</span>
  <span class="token operator">&amp;</span> <span class="token punctuation">{</span> subtotal<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 초기 상품 데이터</span>
<span class="token keyword">const</span> <span class="token constant">INITIAL_PRODUCTS</span><span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> createCarts <span class="token operator">=</span> <span class="token punctuation">(</span>initValue<span class="token operator">:</span> Record<span class="token operator">&lt;</span>Product<span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Cart<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">createProducts</span> <span class="token operator">=</span> <span class="token punctuation">(</span>initValue <span class="token operator">=</span> <span class="token constant">INITIAL_PRODUCTS</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 애플리케이션 상태</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> createStore <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  products <span class="token operator">=</span> <span class="token constant">INITIAL_PRODUCTS</span><span class="token punctuation">,</span>
  carts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  products<span class="token operator">?</span><span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  carts<span class="token operator">?</span><span class="token operator">:</span> Record<span class="token operator">&lt;</span>Product<span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Cart<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  products<span class="token operator">:</span> <span class="token function">createProducts</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">,</span>
  carts<span class="token operator">:</span> <span class="token function">createCarts</span><span class="token punctuation">(</span>carts<span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token keyword">get</span> <span class="token function">totalCartPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token keyword">get</span> <span class="token function">cartsWithProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> CartWithProduct<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>기존에는 store의 기본값을 고정시켰는데, 이걸 <strong>기본값을 바깥에서 주입받는 방식</strong>으로 변경했다.</p></li><li><p>components.ts</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">type</span> <span class="token class-name">CartWithProduct</span><span class="token punctuation">,</span> <span class="token keyword">type</span> <span class="token class-name">Product</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./domains&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">ProductItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token operator">:</span> Product<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">CartItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token operator">:</span> CartWithProduct<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">CartSummary</span><span class="token punctuation">(</span><span class="token punctuation">{</span> totalPrice <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> totalPrice<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span>

<span class="token comment">// App의 인자를 호출할 때 넘겨주는 방식으로 변경</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  products<span class="token punctuation">,</span>
  carts<span class="token punctuation">,</span>
  totalCartPrice<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  products<span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  carts<span class="token operator">:</span> CartWithProduct<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  totalCartPrice<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
	  &lt;div class=&quot;container mx-auto py-20&quot;&gt;
		  &lt;h1 class=&quot;text-3xl font-bold mb-8 text-center&quot;&gt;쇼핑몰&lt;/h1&gt;
		
		  &lt;div class=&quot;flex gap-8&quot;&gt;
		    &lt;div class=&quot;flex-1&quot;&gt;
		      &lt;div id=&quot;product-list&quot; class=&quot;grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4&quot;&gt;
		        </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>products<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>ProductItem<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
		      &lt;/div&gt;
		    &lt;/div&gt;
		
		    &lt;div class=&quot;bg-white p-6 rounded-lg shadow w-[400px]&quot;&gt;
		      &lt;h2 class=&quot;text-2xl fon t-bold mb-4&quot;&gt;장바구니&lt;/h2&gt;
		      &lt;div id=&quot;cart-items&quot;&gt;
		        </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>carts<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>CartItem<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
		      &lt;/div&gt;
		      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">CartSummary</span><span class="token punctuation">(</span><span class="token punctuation">{</span> totalPrice<span class="token operator">:</span> totalCartPrice <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
		    &lt;/div&gt;
		  &lt;/div&gt;
		&lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>기존에는 App 내부에서 store를 호출하는 방식으로 만들었는데, 바깥에서 인자를 넘겨주는 방식으로 변경했다.</p></li><li><p>apps.ts</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">addEvent</span><span class="token punctuation">(</span>
  eventType<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  selector<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> Event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
  parent <span class="token operator">=</span> document
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  parent<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>eventType<span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target <span class="token keyword">as</span> HTMLElement<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">callback</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> setupEvents <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> initialized <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function-variable function">setup</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>initialized<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      initialized <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>main.ts</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> addEvent<span class="token punctuation">,</span> setupEvents <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./apps&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> App <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./components&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./domains&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 스토어를 main에서 생성해주고</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> $root <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>$root<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// App 컴포넌트에 store의 인자를 정제해서 넘겨준다.</span>
    $root<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      products<span class="token operator">:</span> store<span class="token punctuation">.</span>products<span class="token punctuation">.</span>items<span class="token punctuation">,</span>
      carts<span class="token operator">:</span> store<span class="token punctuation">.</span>cartsWithProduct<span class="token punctuation">,</span>
      totalCartPrice<span class="token operator">:</span> store<span class="token punctuation">.</span>totalCartPrice<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">setupEvents</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. 상품목록에서 “장바구니 담기” 버튼을 클릭할 때</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.add-to-cart-btn&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2. 장바구니에서 +, - 버튼을 클릭할 때</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.increase-btn, .decrease-btn&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3. 장바구니에서 ‘삭제” 버튼을 클리할 때</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.remove-btn&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 4. 장바구니에서 “장바구니 비우기” 버튼을 클릭할 때</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;#clear-cart&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>components 가 직접적으로 store 의존하고 있었는데 이걸 간접적으로 의존하게 하여 더 유연한 상태로 만들었다.</p></li></ul><p>현재 구조에서 주목해야할 부분은 <strong>의존성의 흐름</strong>이다.</p><img src="https://www.plantuml.com/plantuml/svg/TL91RWCX3Bpp2ZwmNuXILJtqLYc77geUqE9aKS56Nc-gLTM_1zAW0DcUWF4muv6zdyMmBC6h-SjXD6o2zWv1rWWwab_pOwj6B1Cf3qVHGfhTQH9j7SCeZb2fV35uyg0j1UDmrZzAwplwncINKHhiENNo0BmxcRR88uCHE0Wng5IuKVJmCJbh0JztHIuVFToATaXDhbr-wrGZXKW8AFy4UnK83rasmSCIWk6rmPzYh4BbRts2crIvzkMxQFMgITcX2MHYxACOQr_EAM83pY1BlC9pRh5mQksQqdZaHUWy6D02jmvbfd-rHhaCeYpLOEaRXrqr3bLDfbHpDdKDM93yMwbzCaYhVm40" alt="uml diagram"><p>이런 방향으로 함수를 호출하고 있다.</p><p>의존성이 단방향으로 흘러야 요구사항에 민첩하게 대응할 수 있다.</p><p>마지막으로 기존에 작성된 e2e 테스트를 조금 다듬어보자.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> expect<span class="token punctuation">,</span> <span class="token keyword">type</span> <span class="token class-name">Page</span><span class="token punctuation">,</span> test <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@playwright/test&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 기존에 작성된 테스트 코드를 함수로 분리했다.</span>
<span class="token comment">// 그리고 테스트를 수행하는 페이지를 다르게 할 수 있도록 지정했다.</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">testFirstAssignmentAtPage</span><span class="token punctuation">(</span>page<span class="token operator">:</span> Page<span class="token punctuation">,</span> path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">goto</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://localhost:5173/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchAriaSnapshot</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    /* ... 길어서 생략. 기존 코드 참고. ... */
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page
    <span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#product-list div&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> hasText<span class="token operator">:</span> <span class="token string">&#39;맥북 프로 14인치 2,990,000원 장바구니 담기&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page
    <span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#product-list div&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> hasText<span class="token operator">:</span> <span class="token string">&#39;아이폰 15 Pro 1,550,000원 장바구니 담기&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page
    <span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#product-list div&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> hasText<span class="token operator">:</span> <span class="token string">&#39;갤럭시 S24 1,200,000원 장바구니 담기&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page
    <span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#product-list div&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> hasText<span class="token operator">:</span> <span class="token string">&#39;에어팟 프로 350,000원 장바구니 담기&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;+&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;+&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;+&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;+&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nth</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;+&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nth</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchAriaSnapshot</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    /* ... 길어서 생략. 기존 코드 참고. ... */
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;-&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nth</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;삭제&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchAriaSnapshot</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    /* ... 길어서 생략. 기존 코드 참고. ... */
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">getByRole</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;장바구니 비우기&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchAriaSnapshot</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    /* ... 길어서 생략. 기존 코드 참고. ... */
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// step1, step2 에 대해 동시에 테스트할 수 있어야 한다.</span>
test<span class="token punctuation">.</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;첫 번째 요구사항에 대한 테스트 &gt; &#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;step1 &gt; &#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> page <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">testFirstAssignmentAtPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token string">&#39;step1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;step2 &gt; &#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> page <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">testFirstAssignmentAtPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token string">&#39;step2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>테스트 코드를 실행한 다음에 정상적으로 동작하는지 확인해보자.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">pnpm</span> run test:e2e
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/TIL/assets/0.7b90edcd.png" alt="image.png"></p><p>이렇게 학습을 위해 리팩토링을 할 때에는 기존 코드를 보존하고 테스트를 통해 내가 작성한 코드에 문제가 없는지 계속 검증을 해보면 좋다.</p><h3 id="_6-간단한-단위-테스트-작성" tabindex="-1"><a class="header-anchor" href="#_6-간단한-단위-테스트-작성" aria-hidden="true">#</a> (6) 간단한 단위 테스트 작성</h3><p>앞서 파일을 분할했으니, 이제 간단하게 단위 테스트를 작성해보자. <a href="https://vitest.dev/guide/" target="_blank" rel="noopener noreferrer">vitest<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>는 설정도 쉬워서 금방 진행할 수 있다.</p><h4 id="_1-vitest-환경설정" tabindex="-1"><a class="header-anchor" href="#_1-vitest-환경설정" aria-hidden="true">#</a> 1) vitest 환경설정</h4><ul><li><p>vitest와 jsdom을 먼저 설치해야 한다.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">pnpm</span> <span class="token function">add</span> -D vitest @vitest/coverage-v8 jsdom
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>이어서 vitest.config.ts 를 추가하고 jsdom에 대한 설정을 추가해야 한다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vitest/config&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    globals<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    environment<span class="token operator">:</span> <span class="token string">&#39;jsdom&#39;</span><span class="token punctuation">,</span>
    
    <span class="token comment">// 초반에 작성한 playwright으로 작성한 e2e 테스트를 제외시켜야한다.</span>
    exclude<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;./tests&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;./node_modules&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;./dist&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>마지막으로 npm script 를 추가해줘야 한다.</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;tsc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tsc --noEmit&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;lint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint ./src --fix&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;prettier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prettier ./src --write&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tsc &amp;&amp; vite build&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;preview&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite preview&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;prepare&quot;</span><span class="token operator">:</span> <span class="token string">&quot;husky&quot;</span><span class="token punctuation">,</span>
  
  <span class="token comment">// 기본 테스트와 테스트 커버리지를 측정하는 스크립트를 추가한다.</span>
  <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vitest&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;test:coverage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vitest --coverage&quot;</span><span class="token punctuation">,</span>
  
  <span class="token property">&quot;test:e2e&quot;</span><span class="token operator">:</span> <span class="token string">&quot;playwright test&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;test:e2e:ui&quot;</span><span class="token operator">:</span> <span class="token string">&quot;playwright test --ui&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;test:e2e:codegen&quot;</span><span class="token operator">:</span> <span class="token string">&quot;playwright codegen localhost:5173&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="_2-테스트-스펙을-먼저-작성하기" tabindex="-1"><a class="header-anchor" href="#_2-테스트-스펙을-먼저-작성하기" aria-hidden="true">#</a> 2) 테스트 스펙을 먼저 작성하기</h4><p>처음부터 테스트를 다 작성하기보단, 테스트 스펙만 우선 정의해놓으면 좋다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ./src/__tests__/domains.test.ts</span>
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;domains &gt; &#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;상품 목록을 조회할 수 있으며, 이름/가격/상품이미지 등을 확인할 수 있다.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;상품을 장바구니에 담을 수 있다.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;수량 변경이 가능하고, 최소값은 1이다.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;장바구니에서 개별 상품을 삭제할 수 있다.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;장바구니를 한 번에 비울 수 있다.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;개별 상품 소계를 확인할 수 있다.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;장바구니에 담긴 전체 상품 가격을 확인할 수 있다.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// ./src/__tests__/components.test.ts</span>
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;components &gt; &#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;ProductItem&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;상품 정보가 올바르게 렌더링된다&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;CartItem&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;장바구니 상품 정보가 올바르게 렌더링된다&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;CartSummary&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;총 합계가 올바르게 표시된다&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;App&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;전체 애플리케이션이 올바르게 렌더링된다&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;상품이나 장바구니가 비어있는 경우에도 렌더링된다&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ./src/__tests__/apps.test.ts</span>
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;apps &gt; &#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;addEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;선택자에 맞는 요소 클릭 시 콜백 함수가 호출된다&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;부모 요소를 지정하여 이벤트를 등록할 수 있다&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;선택자와 일치하지 않는 요소 클릭 시 콜백 함수가 호출되지 않는다&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;setup 함수는 처음 호출될 때만 실행된다.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-테스트-채우기" tabindex="-1"><a class="header-anchor" href="#_3-테스트-채우기" aria-hidden="true">#</a> 3) 테스트 채우기</h4><p>여태까지 작성된 내용을 기반으로 AI에게 테스트를 작성해달라고 하면 작성해준다. 연습할겸 직접 작성해도 좋지만, 일단 AI에게 위임해도 충분할 것 같다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// domain.test.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> afterEach<span class="token punctuation">,</span> describe<span class="token punctuation">,</span> expect<span class="token punctuation">,</span> test <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vitest&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> <span class="token keyword">type</span> <span class="token class-name">Product</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../domains&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">MOCK_PRODUCTS</span><span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;상품1&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;image1.jpg&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;상품2&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;image2.jpg&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;Domains &gt; &#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 사실 파일을 분리할 때 store 대신 createStore를 정의한 것은 이 구간 때문이다.</span>
  <span class="token comment">// 테스트 데이터를 사용하기 위함!</span>
  <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span> products<span class="token operator">:</span> <span class="token constant">MOCK_PRODUCTS</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;상품 목록을 조회할 수 있으며, 이름/가격/상품이미지 등을 확인할 수 있다.&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>products<span class="token punctuation">.</span>items<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;상품1&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;image1.jpg&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;상품2&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;image2.jpg&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>products<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string-property property">&#39;1&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;상품1&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;image1.jpg&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string-property property">&#39;2&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;상품2&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;image2.jpg&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;상품을 장바구니에 담을 수 있다.&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string-property property">&#39;1&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span> productId<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string-property property">&#39;1&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span> productId<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string-property property">&#39;2&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span> productId<span class="token operator">:</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;수량 변경이 가능하고, 최소값은 1이다.&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string-property property">&#39;1&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span> productId<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string-property property">&#39;1&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span> productId<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;장바구니에서 개별 상품을 삭제할 수 있다.&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string-property property">&#39;1&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span> productId<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span>items<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;장바구니를 한 번에 비울 수 있다.&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string-property property">&#39;1&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span> productId<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string-property property">&#39;2&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span> productId<span class="token operator">:</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span>items<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;개별 상품 소계를 확인할 수 있다.&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 30000</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 20000</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>cartsWithProduct<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        id<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span>
        image<span class="token operator">:</span> <span class="token string">&#39;image1.jpg&#39;</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">&#39;상품1&#39;</span><span class="token punctuation">,</span>
        price<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
        quantity<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        subtotal<span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        id<span class="token operator">:</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span>
        image<span class="token operator">:</span> <span class="token string">&#39;image2.jpg&#39;</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">&#39;상품2&#39;</span><span class="token punctuation">,</span>
        price<span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span>
        quantity<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        subtotal<span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;장바구니에 담긴 전체 상품 가격을 확인할 수 있따.&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 30000</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 20000</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>totalCartPrice<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 30000 + 20000</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// components.test.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> describe<span class="token punctuation">,</span> expect<span class="token punctuation">,</span> test <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vitest&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ProductItem<span class="token punctuation">,</span> CartItem<span class="token punctuation">,</span> CartSummary<span class="token punctuation">,</span> App <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../components&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">type</span> <span class="token class-name">CartWithProduct</span><span class="token punctuation">,</span> <span class="token keyword">type</span> <span class="token class-name">Product</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../domains&#39;</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;Components &gt; &#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 테스트용 상품 데이터</span>
  <span class="token keyword">const</span> mockProduct<span class="token operator">:</span> Product <span class="token operator">=</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&#39;테스트 상품&#39;</span><span class="token punctuation">,</span>
    price<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
    image<span class="token operator">:</span> <span class="token string">&#39;test-image.jpg&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// 테스트용 장바구니 상품 데이터</span>
  <span class="token keyword">const</span> mockCartItem<span class="token operator">:</span> CartWithProduct <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>mockProduct<span class="token punctuation">,</span>
    quantity<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    subtotal<span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;ProductItem&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;상품 정보가 올바르게 렌더링된다&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token function">ProductItem</span><span class="token punctuation">(</span>mockProduct<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 필수 정보 포함 확인</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span>mockProduct<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;10,000원&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 가격이 포맷팅되어 표시</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>mockProduct<span class="token punctuation">.</span>image<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">data-product-id=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>mockProduct<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;장바구니 담기&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;CartItem&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;장바구니 상품 정보가 올바르게 렌더링된다&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token function">CartItem</span><span class="token punctuation">(</span>mockCartItem<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 필수 정보 포함 확인</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span>mockCartItem<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;10,000원&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 가격이 포맷팅되어 표시</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>mockCartItem<span class="token punctuation">.</span>image<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">data-product-id=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>mockCartItem<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;span class=&quot;quantity&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>mockCartItem<span class="token punctuation">.</span>quantity<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;삭제&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;CartSummary&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;총 합계가 올바르게 표시된다&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> totalPrice <span class="token operator">=</span> <span class="token number">35000</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token function">CartSummary</span><span class="token punctuation">(</span><span class="token punctuation">{</span> totalPrice <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;총 합계:&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;35,000원&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 가격이 포맷팅되어 표시</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;장바구니 비우기&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;App&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;전체 애플리케이션이 올바르게 렌더링된다&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> products<span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>mockProduct<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> carts<span class="token operator">:</span> CartWithProduct<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>mockCartItem<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> totalCartPrice <span class="token operator">=</span> <span class="token number">20000</span><span class="token punctuation">;</span>

      <span class="token comment">// 마찬가지로, App이 store를 직접적으로 의존하지 않도록 하여 유연하게 사용할 수 있도록 만들었다.</span>
      <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span> products<span class="token punctuation">,</span> carts<span class="token punctuation">,</span> totalCartPrice <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 각 섹션이 존재하는지 확인</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;쇼핑몰&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;id=&quot;product-list&quot;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;id=&quot;cart-items&quot;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;20,000원&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 총 합계 가격</span>

      <span class="token comment">// 각 컴포넌트의 결과물이 포함되었는지 확인</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span>mockProduct<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">data-product-id=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>mockProduct<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;장바구니 비우기&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;상품이나 장바구니가 비어있는 경우에도 렌더링된다&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span> products<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> carts<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> totalCartPrice<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;쇼핑몰&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;id=&quot;product-list&quot;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;id=&quot;cart-items&quot;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;0원&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 총 합계 가격</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// apps.test.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> describe<span class="token punctuation">,</span> expect<span class="token punctuation">,</span> test<span class="token punctuation">,</span> vi<span class="token punctuation">,</span> beforeEach<span class="token punctuation">,</span> afterEach <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vitest&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> addEvent<span class="token punctuation">,</span> setupEvents <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../apps&#39;</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;apps &gt; &#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;addEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 테스트 전 DOM 요소 설정</span>
    <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// vite.config.ts 에 jsdom 설정을 해야 이런 코드를 사용할 수 있다.</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;div id=&quot;container&quot;&gt;
          &lt;button id=&quot;test-button&quot;&gt;테스트 버튼&lt;/button&gt;
          &lt;div class=&quot;item&quot;&gt;아이템 1&lt;/div&gt;
          &lt;div class=&quot;item&quot;&gt;아이템 2&lt;/div&gt;
        &lt;/div&gt;
      </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 테스트 후 DOM 요소 초기화</span>
    <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;선택자에 맞는 요소 클릭 시 콜백 함수가 호출된다&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> mockCallback <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;test-button&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;#test-button&#39;</span><span class="token punctuation">,</span> mockCallback<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 클릭 이벤트 시뮬레이션</span>
      button<span class="token operator">?.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">expect</span><span class="token punctuation">(</span>mockCallback<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledTimes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;부모 요소를 지정하여 이벤트를 등록할 수 있다&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;container&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLElement<span class="token punctuation">;</span>
      <span class="token keyword">const</span> mockCallback <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>container<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.item&#39;</span><span class="token punctuation">,</span> mockCallback<span class="token punctuation">,</span> container<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 첫 번째 아이템 클릭 시뮬레이션</span>
        <span class="token keyword">const</span> firstItem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        firstItem<span class="token operator">?.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Event</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> bubbles<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">expect</span><span class="token punctuation">(</span>mockCallback<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledTimes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;선택자와 일치하지 않는 요소 클릭 시 콜백 함수가 호출되지 않는다&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> mockCallback <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.non-existent&#39;</span><span class="token punctuation">,</span> mockCallback<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 버튼을 클릭해도 콜백이 호출되지 않음</span>
      <span class="token keyword">const</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;test-button&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      button<span class="token operator">?.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">expect</span><span class="token punctuation">(</span>mockCallback<span class="token punctuation">)</span><span class="token punctuation">.</span>not<span class="token punctuation">.</span><span class="token function">toHaveBeenCalled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;setup 함수는 처음 호출될 때만 실행된다.&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> setupFn <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 첫 번째 호출</span>
    <span class="token function">setupEvents</span><span class="token punctuation">(</span>setupFn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>setupFn<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledTimes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">setupEvents</span><span class="token punctuation">(</span>setupFn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setupEvents</span><span class="token punctuation">(</span>setupFn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>setupFn<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledTimes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 여전히 1회만 호출됨</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-테스트-커버리지를-측정해본다" tabindex="-1"><a class="header-anchor" href="#_4-테스트-커버리지를-측정해본다" aria-hidden="true">#</a> 4) 테스트 커버리지를 측정해본다.</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># step3 에 대해서만 측정하면 된다.</span>
$ <span class="token function">pnpm</span> run test:coverage --coverage.include<span class="token operator">=</span>src/step3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/TIL/assets/1.4439afae.png" alt="image.png"></p><ul><li><p>e2e가 있기 때문에 main에 대한 통합테스트는 진행하지 않아도 무방할 것 같다.</p></li><li><p>domains에 branch coverage가 조금 부족해서 확인해봤는데, carts에서 참조가 불가능한 product가 있을 때에 대한 엣지케이스가 없어서 그런 것으로 확인되었다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">get</span> <span class="token function">totalCartPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>carts<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> product <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>products<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>productId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// product가 없는 케이스에 대한 테스트가 없는 상태</span>
    <span class="token keyword">return</span> total <span class="token operator">+</span> <span class="token punctuation">(</span>product <span class="token operator">?</span> product<span class="token punctuation">.</span>price <span class="token operator">*</span> item<span class="token punctuation">.</span>quantity <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>이렇게 테스트 케이스를 하나 더 추가해보자.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;실제로 없는 제품을 장바구니에 추가할 경우, totalCartPrice는 0이 된다.&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;3&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>totalCartPrice<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 30000 + 20000</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/TIL/assets/2.f69e35f5.png" alt="image.png"></p><p>테스트 추가 후 다시 실행했더니 커버리지가 채워진 것을 확인할 수 있다.</p></li></ul><h3 id="_8-2단계-데모" tabindex="-1"><a class="header-anchor" href="#_8-2단계-데모" aria-hidden="true">#</a> (8) 2단계 데모</h3><ul><li>링크: <a href="https://junilhwang.github.io/simple-clean-code-project/step2.html" target="_blank" rel="noopener noreferrer">https://junilhwang.github.io/simple-clean-code-project/step2.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>전체코드: <a href="https://github.com/JunilHwang/simple-clean-code-project/tree/main/src/step2" target="_blank" rel="noopener noreferrer">https://github.com/JunilHwang/simple-clean-code-project/tree/main/src/step2<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><div class="iframe-container"><iframe src="https://junilhwang.github.io/simple-clean-code-project/step2.html"></iframe></div><h3 id="_9-summary" tabindex="-1"><a class="header-anchor" href="#_9-summary" aria-hidden="true">#</a> (9) Summary</h3><p>일단 다음 단계로 넘어가기 이전에, 여태까지 작업한 내용을 정리해보자.</p><ol><li>초기 요구사항에 대해 일단 구현을 했다.</li><li>새로운 요구사항을 추가하기 전에, 시뮬레이션을 해보면서 구현된 코드에 대한 문제점을 분석했다.</li><li>data와 ui가 강결합 되어있어 새로운 요구사항을 추가할 때 코드의 변화의 폭이 무척 컸으며 코드가 명령형 기반으로 되어있어서 읽고 해석하는게 어려웠다.</li><li>data와 ui를 분리하기 위해선 React나 Vue 처럼 선언형 기반의 코드로 전환을 해야 한다.</li><li>리팩토링을 진행하기 이전에 playwright codegen을 통해 간단하게 e2e 테스트를 작성했다.</li><li>domains, components, apps 등의 역할을 추출하였고, 단계별로 코드를 작성했다.</li><li>리팩토링 후 e2e 테스트가 통과 되었음을 확인하였다.</li><li>코드를 분할 후에 vitest 기반으로 단위 테스트를 작성했다.</li><li>단위 테스트에 대한 커버리지를 확인하면서 검증하지 못한 구간에 대해 테스트를 작성했다.</li></ol><p><strong>드디어 새로운 기능을 추가할 수 있는 상태가 되었다.</strong></p><h2 id="_3단계-추가-요구사항-구현하기" tabindex="-1"><a class="header-anchor" href="#_3단계-추가-요구사항-구현하기" aria-hidden="true">#</a> 3단계: 추가 요구사항 구현하기</h2><p>이제 추가 요구사항을 구현해보자.</p><div class="custom-container tip"><p class="custom-container-title">📌 앞에서 정의한 추가 요구사항</p><ol><li>상품목록 UI 변화 <ul><li>상품 검색 가능</li><li>상품 이름과 가격으로 정렬 가능</li></ul></li><li>상품에 새로운 속성 추가 <ul><li>재고가 추가되고, 남은 재고만큼만 장바구니에 추가 가능</li><li>재고가 0일 때 품절 상태가 되고 이를 UI에 반영</li></ul></li><li>UI 기능 추가 <ul><li>장바구니에 전체선택 / 부분선택 후 삭제 가능</li></ul></li></ol></div><p>앞선 과정을 통해 관심사 분리를 완료했으므로 <strong>사실 변경할 부분이 생각보다 많진 않다.</strong> 한 번 차근차근 작성해보자.</p><p>먼저 앞에서 했던 것 처럼 step2 폴더를 그대로 복사해서 step3로 만들어보자.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>./src
├── step1
│   └── main.ts
├── step2                          <span class="token comment"># step2는 그대로 보존</span>
│   ├── __tests__
│   │   ├── apps.test.ts
│   │   ├── components.test.ts
│   │   └── domains.test.ts
│   ├── apps.ts
│   ├── components.ts
│   ├── domains.ts
│   └── main.ts
└── step3                          <span class="token comment"># 새로운 코드를 step3에 복사해서 진행</span>
    ├── __tests__
    │   ├── apps.test.ts
    │   ├── components.test.ts
    │   ├── domains.test.ts
    │   └── dummy.ts
    ├── apps.ts
    ├── components.ts
    ├── domains.ts
    └── main.ts
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-도메인-레벨-변화" tabindex="-1"><a class="header-anchor" href="#_1-도메인-레벨-변화" aria-hidden="true">#</a> (1) 도메인 레벨 변화</h3><p>기존의 관심사 분리 덕분에 도메인 로직부터 체계적으로 확장할 수 있게 되었다.</p><h4 id="_1-타입-확장" tabindex="-1"><a class="header-anchor" href="#_1-타입-확장" aria-hidden="true">#</a> 1) 타입 확장</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// Product에 재고 정보 추가</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  price<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  image<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> <span class="token comment">// 🆕 재고 수량 추가</span>
<span class="token punctuation">}</span>

<span class="token comment">// Cart에 선택 상태 추가</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Cart</span> <span class="token punctuation">{</span>
  productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  selected<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span> <span class="token comment">// 🆕 선택 상태 추가</span>
<span class="token punctuation">}</span>

<span class="token comment">// CartWithProduct 타입도 업데이트했다.</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">CartWithProduct</span> <span class="token operator">=</span>
  Omit<span class="token operator">&lt;</span>Product<span class="token punctuation">,</span> <span class="token string">&#39;quantity&#39;</span><span class="token operator">&gt;</span> <span class="token comment">// product에도 quantity가 생겨서, 이를 제거해야 하고</span>
    <span class="token operator">&amp;</span> Pick<span class="token operator">&lt;</span>Cart<span class="token punctuation">,</span> <span class="token string">&#39;quantity&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;selected&#39;</span><span class="token operator">&gt;</span> <span class="token comment">// Cart의 selected를 추가해야 한다.</span>
    <span class="token operator">&amp;</span> <span class="token punctuation">{</span> subtotal<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-상품-관리-기능-확장" tabindex="-1"><a class="header-anchor" href="#_2-상품-관리-기능-확장" aria-hidden="true">#</a> 2) 상품 관리 기능 확장</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> <span class="token function-variable function">createProducts</span> <span class="token operator">=</span> <span class="token punctuation">(</span>initValue <span class="token operator">=</span> <span class="token constant">INITIAL_PRODUCTS</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 검색, 정렬 옵션 상태 관리</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
    searchKey<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    orderBy<span class="token operator">:</span> <span class="token string">&#39;asc&#39;</span> <span class="token keyword">as</span> <span class="token string">&#39;asc&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;desc&#39;</span><span class="token punctuation">,</span>
    sortBy<span class="token operator">:</span> <span class="token string">&#39;default&#39;</span> <span class="token keyword">as</span> <span class="token string">&#39;name&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;price&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;default&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">get</span> <span class="token function">items</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 🆕 필터링된 상품 목록 (검색 + 정렬 적용)</span>
    <span class="token keyword">get</span> <span class="token function">filteredItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> searchKey<span class="token punctuation">,</span> orderBy<span class="token punctuation">,</span> sortBy <span class="token punctuation">}</span> <span class="token operator">=</span> options<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>items
        <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> lowerKeyword <span class="token operator">=</span> searchKey<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> item<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>lowerKeyword<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>sortBy <span class="token operator">===</span> <span class="token string">&#39;default&#39;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

          <span class="token keyword">const</span> comparison <span class="token operator">=</span> sortBy <span class="token operator">===</span> <span class="token string">&#39;name&#39;</span>
            <span class="token operator">?</span> a<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">localeCompare</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
            <span class="token operator">:</span> a<span class="token punctuation">.</span>price <span class="token operator">-</span> b<span class="token punctuation">.</span>price<span class="token punctuation">;</span>

          <span class="token keyword">return</span> orderBy <span class="token operator">===</span> <span class="token string">&#39;asc&#39;</span> <span class="token operator">?</span> comparison <span class="token operator">:</span> <span class="token operator">-</span>comparison<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 🆕 품절 상태 확인</span>
    <span class="token function">isOutOfStock</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token operator">?.</span>quantity <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 🆕 검색 기능</span>
    <span class="token function">search</span><span class="token punctuation">(</span>searchKey<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      options<span class="token punctuation">.</span>searchKey <span class="token operator">=</span> searchKey<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>filteredItems<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 🆕 정렬 기능</span>
    <span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">{</span> sortBy <span class="token operator">=</span> <span class="token string">&#39;default&#39;</span><span class="token punctuation">,</span> orderBy <span class="token operator">=</span> <span class="token string">&#39;asc&#39;</span> <span class="token punctuation">}</span><span class="token operator">:</span> Partial<span class="token operator">&lt;</span><span class="token keyword">typeof</span> options<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token punctuation">{</span> sortBy<span class="token punctuation">,</span> orderBy <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>filteredItems<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-장바구니-관리-기능-확장" tabindex="-1"><a class="header-anchor" href="#_3-장바구니-관리-기능-확장" aria-hidden="true">#</a> 3) 장바구니 관리 기능 확장</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> createCarts <span class="token operator">=</span> <span class="token punctuation">(</span>initValue<span class="token operator">:</span> Record<span class="token operator">&lt;</span>Product<span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Cart<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>initValue <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">get</span> <span class="token function">items</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 🆕 선택된 아이템들만 필터링</span>
    <span class="token keyword">get</span> <span class="token function">selectedItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>selected<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">add</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> productId<span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> selected<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 🆕 선택 상태 토글</span>
    <span class="token function">toggleSelect</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">.</span>selected <span class="token operator">=</span> <span class="token operator">!</span>value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">.</span>selected<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 🆕 전체 선택/해제</span>
    <span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>selected <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">deselectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>selected <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 🆕 선택된 아이템들 삭제</span>
    <span class="token function">removeSelected</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>selectedItems<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>productId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 기존 메서드들...</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-스토어-레벨에-상품과-장바구니를-조합하여-사용하는-로직-추가" tabindex="-1"><a class="header-anchor" href="#_4-스토어-레벨에-상품과-장바구니를-조합하여-사용하는-로직-추가" aria-hidden="true">#</a> 4) 스토어 레벨에 상품과 장바구니를 조합하여 사용하는 로직 추가</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">const</span> createStore <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  products<span class="token operator">:</span> defaultProducts <span class="token operator">=</span> <span class="token constant">INITIAL_PRODUCTS</span><span class="token punctuation">,</span>
  carts<span class="token operator">:</span> defaultCarts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  products<span class="token operator">?</span><span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  carts<span class="token operator">?</span><span class="token operator">:</span> Record<span class="token operator">&lt;</span>Product<span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Cart<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// this 사용을 최대한 지양하기 위해 객체 밖에 carts와 products를 정의하여 사용할 수 있다.</span>
  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token function">createProducts</span><span class="token punctuation">(</span>defaultProducts<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> carts <span class="token operator">=</span> <span class="token function">createCarts</span><span class="token punctuation">(</span>defaultCarts<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    products<span class="token punctuation">,</span>
    carts<span class="token punctuation">,</span>
    
    <span class="token keyword">get</span> <span class="token function">totalCartPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">get</span> <span class="token function">cartsWithProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 🆕 재고 체크하며 장바구니 추가</span>
    <span class="token function">addToCart</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> cartQuantity <span class="token operator">=</span> carts<span class="token punctuation">.</span>value<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token operator">?.</span>quantity <span class="token operator">??</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> productQuantity <span class="token operator">=</span> products<span class="token punctuation">.</span>value<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity<span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>products<span class="token punctuation">.</span><span class="token function">isOutOfStock</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">||</span> cartQuantity <span class="token operator">&gt;=</span> productQuantity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// 재고 부족시 추가 불가</span>
      <span class="token punctuation">}</span>
      carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 🆕 재고 한도 내에서 수량 변경</span>
    <span class="token function">incrementCartQuantity</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> cartQuantity <span class="token operator">=</span> carts<span class="token punctuation">.</span>value<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity<span class="token punctuation">;</span>
      <span class="token keyword">const</span> productQuantity <span class="token operator">=</span> products<span class="token punctuation">.</span>value<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity<span class="token punctuation">;</span>
      carts<span class="token punctuation">.</span><span class="token function">updateQuantity</span><span class="token punctuation">(</span>
        id<span class="token punctuation">,</span>
        Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>cartQuantity <span class="token operator">+</span> quantity<span class="token punctuation">,</span> productQuantity<span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-컴포넌트-레벨-변화" tabindex="-1"><a class="header-anchor" href="#_2-컴포넌트-레벨-변화" aria-hidden="true">#</a> (2) 컴포넌트 레벨 변화</h3><p>사실 도메인에 대한 변경보다 UI에 대한 변경이 더 많을 수 있다. 이런 부분은 인공지능에게 위임하여 만들어도 좋다.</p><h4 id="_1-상품-검색-정렬-컨트롤-추가" tabindex="-1"><a class="header-anchor" href="#_1-상품-검색-정렬-컨트롤-추가" aria-hidden="true">#</a> 1) 상품 검색/정렬 컨트롤 추가</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 🆕 ProductControls 컴포넌트 추가</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">ProductControls</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div class=&quot;bg-white p-4 rounded-lg shadow mb-6&quot;&gt;
      &lt;div class=&quot;flex flex-wrap gap-4 items-center&quot;&gt;
        &lt;!-- 검색 --&gt;
        &lt;div class=&quot;flex-1 min-w-64&quot;&gt;
          &lt;input
            type=&quot;text&quot;
            id=&quot;search-input&quot;
            placeholder=&quot;상품명으로 검색...&quot;
            class=&quot;w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500&quot;
          &gt;
        &lt;/div&gt;

        &lt;!-- 정렬 --&gt;
        &lt;div class=&quot;flex gap-2&quot;&gt;
          &lt;select id=&quot;sort-select&quot; class=&quot;px-3 py-2 border border-gray-300 rounded-lg&quot;&gt;
            &lt;option value=&quot;default&quot;&gt;기본순&lt;/option&gt;
            &lt;option value=&quot;name&quot;&gt;이름순&lt;/option&gt;
            &lt;option value=&quot;price&quot;&gt;가격순&lt;/option&gt;
          &lt;/select&gt;

          &lt;select id=&quot;order-select&quot; class=&quot;px-3 py-2 border border-gray-300 rounded-lg&quot;&gt;
            &lt;option value=&quot;asc&quot;&gt;오름차순&lt;/option&gt;
            &lt;option value=&quot;desc&quot;&gt;내림차순&lt;/option&gt;
          &lt;/select&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-productitem-컴포넌트-재고-상태-반영" tabindex="-1"><a class="header-anchor" href="#_2-productitem-컴포넌트-재고-상태-반영" aria-hidden="true">#</a> 2) ProductItem 컴포넌트 재고 상태 반영</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">ProductItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> image<span class="token punctuation">,</span> name<span class="token punctuation">,</span> price<span class="token punctuation">,</span> id<span class="token punctuation">,</span> quantity <span class="token punctuation">}</span><span class="token operator">:</span> Product<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> disabled <span class="token operator">=</span> quantity <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 품절 상태 계산</span>

  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div class=&quot;bg-white p-4 rounded-lg shadow product-item&quot; data-product-id=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;
      &lt;div class=&quot;relative&quot;&gt;
        &lt;img src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>image<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; alt=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; class=&quot;w-full h-48 object-cover mb-4 rounded </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>disabled <span class="token operator">?</span> <span class="token string">&#39;opacity-50&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; /&gt;
        </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>disabled <span class="token operator">?</span> <span class="token string">&#39;&lt;div class=&quot;absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 rounded text-white font-bold&quot;&gt;품절&lt;/div&gt;&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      &lt;/div&gt;
      &lt;h3 class=&quot;text-lg font-bold mb-2&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/h3&gt;
      &lt;p class=&quot;text-gray-600 mb-2&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>price<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">원&lt;/p&gt;
      
      &lt;!-- 🆕 재고 표시 --&gt;
      &lt;p class=&quot;text-sm text-gray-500 mb-4&quot;&gt;재고: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>quantity<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">개&lt;/p&gt;
      
      &lt;!-- 🆕 상태별 버튼 텍스트 --&gt;
      &lt;button
	      class=&quot;w-full </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>disabled <span class="token operator">?</span> <span class="token string">&#39;bg-gray-400 cursor-not-allowed&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;bg-blue-500 hover:bg-blue-600&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> text-white py-2 px-4 rounded add-to-cart-btn&quot;
        data-product-id=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;
        </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>disabled <span class="token operator">?</span> <span class="token string">&#39;disabled&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      &gt;
        </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>disabled <span class="token operator">?</span> <span class="token string">&#39;품절&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;장바구니 담기&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      &lt;/button&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-cartitem-컴포넌트-선택-기능-추가" tabindex="-1"><a class="header-anchor" href="#_3-cartitem-컴포넌트-선택-기능-추가" aria-hidden="true">#</a> 3) CartItem 컴포넌트 선택 기능 추가</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">CartItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token punctuation">,</span> quantity<span class="token punctuation">,</span> image<span class="token punctuation">,</span> name<span class="token punctuation">,</span> price<span class="token punctuation">,</span> selected<span class="token punctuation">,</span> subtotal <span class="token punctuation">}</span><span class="token operator">:</span> CartWithProduct<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div class=&quot;cart-item flex items-center gap-3 p-3 border-t&quot; data-product-id=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;
    
      &lt;!-- 🆕 체크박스 --&gt;
      &lt;input type=&quot;checkbox&quot; class=&quot;cart-item-checkbox&quot; data-product-id=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>selected <span class="token operator">?</span> <span class="token string">&#39;checked&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&gt;
      &lt;img src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>image<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; alt=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; class=&quot;w-16 h-16 object-cover rounded&quot;&gt;
      &lt;div class=&quot;flex-1&quot;&gt;
        &lt;h4 class=&quot;font-bold text-sm&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/h4&gt;
        
        &lt;!-- 🆕 소계 계산 표시 --&gt;
        &lt;p class=&quot;text-gray-600 text-sm&quot;&gt;
          </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>price<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">원 * </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>quantity<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">개 = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>subtotal<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">원 
        &lt;/p&gt;
        
        &lt;div class=&quot;flex items-center gap-2 mt-2&quot;&gt;
          &lt;button class=&quot;decrease-btn bg-gray-300 text-gray-700 w-6 h-6 rounded text-sm&quot;&gt;-&lt;/button&gt;
          &lt;span class=&quot;quantity&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>quantity<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
          &lt;button class=&quot;increase-btn bg-gray-300 text-gray-700 w-6 h-6 rounded text-sm&quot;&gt;+&lt;/button&gt;
          &lt;button class=&quot;remove-btn bg-red-500 text-white px-2 py-1 rounded text-xs ml-2&quot;&gt;삭제&lt;/button&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-cartsummary-선택-삭제-기능-추가" tabindex="-1"><a class="header-anchor" href="#_4-cartsummary-선택-삭제-기능-추가" aria-hidden="true">#</a> 4) CartSummary 선택 삭제 기능 추가</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">CartSummary</span><span class="token punctuation">(</span><span class="token punctuation">{</span> totalPrice<span class="token punctuation">,</span> selection <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> totalPrice<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> selection<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div class=&quot;mt-4 pt-4 border-t&quot;&gt;
      &lt;div class=&quot;flex justify-between items-center mb-2&quot;&gt;
        &lt;span class=&quot;text-lg font-bold&quot;&gt;총 합계:&lt;/span&gt;
        &lt;span id=&quot;total-price&quot; class=&quot;text-xl font-bold text-blue-600&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>totalPrice<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">원&lt;/span&gt;
      &lt;/div&gt;
      &lt;div class=&quot;flex gap-2&quot;&gt;
        &lt;!-- 🆕 선택 삭제 버튼 (선택된 아이템이 있을 때만 활성화) --&gt;
        &lt;button id=&quot;remove-selected-cart&quot;
                class=&quot;flex-1 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>selection <span class="token operator">?</span> <span class="token string">&#39;bg-orange-500 hover:bg-orange-600&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;bg-gray-400 cursor-not-allowed&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> text-white py-2 px-4 rounded&quot;
                </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token operator">!</span>selection <span class="token operator">?</span> <span class="token string">&#39;disabled&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&gt;
          선택 삭제
        &lt;/button&gt;
        &lt;button id=&quot;clear-cart&quot; class=&quot;flex-1 bg-red-500 text-white py-2 px-4 rounded hover:bg-red-600&quot;&gt;
          전체 비우기
        &lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-이벤트-핸들링-추가" tabindex="-1"><a class="header-anchor" href="#_3-이벤트-핸들링-추가" aria-hidden="true">#</a> (3) 이벤트 핸들링 추가</h3><p>기존의 이벤트 시스템을 활용해서 새로운 기능들의 이벤트 핸들링을 추가합니다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 렌더링 로직...</span>

  <span class="token function">setupEvents</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 기존 이벤트들...</span>

    <span class="token comment">// 🆕 상품 검색</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;keydown&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;#search-input&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>key <span class="token operator">!==</span> <span class="token string">&#39;Enter&#39;</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target <span class="token keyword">as</span> HTMLInputElement<span class="token punctuation">;</span>
      store<span class="token punctuation">.</span>products<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 🆕 상품 정렬</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;change&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;#sort-select, #order-select&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> sortSelect <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;sort-select&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLSelectElement<span class="token punctuation">;</span>
      <span class="token keyword">const</span> orderSelect <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;order-select&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLSelectElement<span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>sortSelect <span class="token operator">&amp;&amp;</span> orderSelect<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        store<span class="token punctuation">.</span>products<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          sortBy<span class="token operator">:</span> sortSelect<span class="token punctuation">.</span>value <span class="token keyword">as</span> <span class="token string">&#39;name&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;price&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;default&#39;</span><span class="token punctuation">,</span>
          orderBy<span class="token operator">:</span> orderSelect<span class="token punctuation">.</span>value <span class="token keyword">as</span> <span class="token string">&#39;asc&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;desc&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 🆕 장바구니 아이템 개별 선택</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;change&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.cart-item-checkbox&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target <span class="token keyword">as</span> HTMLInputElement<span class="token punctuation">;</span>
      <span class="token keyword">const</span> productId <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;data-product-id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>productId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">toggleSelect</span><span class="token punctuation">(</span>productId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 🆕 장바구니 전체 선택/해제</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;#select-all-cart&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> selectedItems<span class="token punctuation">,</span> items <span class="token punctuation">}</span> <span class="token operator">=</span> store<span class="token punctuation">.</span>carts<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedItems<span class="token punctuation">.</span>length <span class="token operator">===</span> items<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">deselectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 🆕 선택한 장바구니 아이템 삭제</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;#remove-selected-cart&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span><span class="token function">removeSelected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>생각보다 추가된 내용이 많지 않다.</p><ol><li>데이터의 형태와, 데이터를 업데이트는 함수를 작성하고.</li><li>데이터를 표현하는 UI를 정의해주고</li><li>UI의 이벤트를 통해 변화의 흐름을 만들어주고</li></ol><p>대체로 이런 패턴이다.</p><h3 id="_4-테스트-업데이트" tabindex="-1"><a class="header-anchor" href="#_4-테스트-업데이트" aria-hidden="true">#</a> (4) 테스트 업데이트</h3><p>작성된 테스트는 아래의 링크로 대체하겠다.</p><ul><li>도메인 테스트 추가: <a href="https://github.com/JunilHwang/simple-clean-code-project/commit/d28f6daf11827eec0fc88c6f3b35d52f60f366fb" target="_blank" rel="noopener noreferrer">https://github.com/JunilHwang/simple-clean-code-project/commit/d28f6daf11827eec0fc88c6f3b35d52f60f366fb<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>컴포넌트 테스트 추가: <a href="https://github.com/JunilHwang/simple-clean-code-project/commit/3409663da56eb5a0d43b71c1ce30c65f52c1925d#diff-9277c4f54e3d7d2f80ca9b592aa3846ffd8b408f412bffb8738c757878091ce9" target="_blank" rel="noopener noreferrer">https://github.com/JunilHwang/simple-clean-code-project/commit/3409663da56eb5a0d43b71c1ce30c65f52c1925d#diff-9277c4f54e3d7d2f80ca9b592aa3846ffd8b408f412bffb8738c757878091ce9<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>e2e 테스트 추가 및 개선: <a href="https://github.com/JunilHwang/simple-clean-code-project/commit/e368611d0d147cfb1c6e44bde296746ec12006be" target="_blank" rel="noopener noreferrer">https://github.com/JunilHwang/simple-clean-code-project/commit/e368611d0d147cfb1c6e44bde296746ec12006be<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>그리고 테스트 케이스 추가가 아닌 <strong>테스트 코드 개선에 대한 변경</strong>도 있다. 기존에는 하나의 테스트 파일에서 더미 데이터를 정의해서 사용하였으나, 아예 별도의 파일로 분리해서 사용하였다. 이럴 경우의 장점은 다음과 같다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// AS-IS</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;상품 목록을 조회할 수 있으며, 이름/가격/상품이미지 등을 확인할 수 있다.&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>products<span class="token punctuation">.</span>items<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;상품1&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;image1.jpg&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;상품2&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;image2.jpg&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>products<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string-property property">&#39;1&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;상품1&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;image1.jpg&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;2&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;상품2&#39;</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">&#39;image2.jpg&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// TO-BE</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;상품 목록을 조회할 수 있으며, 이름/가격/상품이미지 등을 확인할 수 있다.&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>products<span class="token punctuation">.</span>items<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">MOCK_PRODUCT_1</span><span class="token punctuation">,</span> <span class="token constant">MOCK_PRODUCT_2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>products<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token constant">MOCK_PRODUCT_1</span><span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">MOCK_PRODUCT_1</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">MOCK_PRODUCT_2</span><span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">MOCK_PRODUCT_2</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>중앙화된 테스트 데이터 관리 <ul><li>여러 테스트 파일에서 동일한 데이터를 재사용</li><li>데이터 변경시 한 곳만 수정하면 됨</li></ul></li><li>타입 안전성<div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">MOCK_PRODUCT_1</span><span class="token operator">:</span> Product <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>TypeScript 타입을 활용해서 컴파일 타임에 오류 검출</li></ul></li><li>가독성 향상 <ul><li>테스트 코드에서 데이터 설정 부분이 깔끔해짐</li><li>테스트의 의도에 집중할 수 있음</li></ul></li></ol><p>중요한 부분은 이런 테스트 데이터를 통해 반복을 줄이는 것이 목적이 아니라 <strong>테스트 자체에 더 집중할 수 있게 하는 것이다.</strong></p><div class="custom-container tip"><p class="custom-container-title">📌 테스트 데이터에 대한 용어</p><ol><li>Test Fixtures</li><li>Mock Data or Stub Data</li><li>Dummy Data</li></ol><p>참고링크</p><ul><li><a href="https://zorba91.tistory.com/304" target="_blank" rel="noopener noreferrer">https://zorba91.tistory.com/304<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://stackoverflow.com/questions/2665812/what-is-mocking" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/2665812/what-is-mocking<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/junit-team/junit4/wiki/Test-fixtures" target="_blank" rel="noopener noreferrer">https://github.com/junit-team/junit4/wiki/Test-fixtures<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://ko.wikipedia.org/wiki/%EB%AA%A8%EC%9D%98_%EA%B0%9D%EC%B2%B4d" target="_blank" rel="noopener noreferrer">https://ko.wikipedia.org/wiki/모의_객체d<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><h3 id="_5-3단계-데모" tabindex="-1"><a class="header-anchor" href="#_5-3단계-데모" aria-hidden="true">#</a> (5) 3단계 데모</h3><ul><li>링크: <a href="https://junilhwang.github.io/simple-clean-code-project/step3.html" target="_blank" rel="noopener noreferrer">https://junilhwang.github.io/simple-clean-code-project/step3.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>전체코드: - 전체코드: <a href="https://github.com/JunilHwang/simple-clean-code-project/tree/main/src/step3" target="_blank" rel="noopener noreferrer">https://github.com/JunilHwang/simple-clean-code-project/tree/main/src/step3<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><div class="iframe-container"><iframe src="https://junilhwang.github.io/simple-clean-code-project/step3.html"></iframe></div><h3 id="_6-summary" tabindex="-1"><a class="header-anchor" href="#_6-summary" aria-hidden="true">#</a> (6) Summary</h3><p><img src="/TIL/assets/refactoring_process_diagram.9f5a2a22.svg" alt="refactoring_process_diagram.svg"></p><p>2단계에서 수행한 관심사 분리 리팩토링 덕분에 쉽게 코드를 추가할 수 있었다.</p><ol><li><strong>새로운 요구사항을 체계적으로 추가</strong></li><li><strong>기존 기능에 영향을 주지 않고</strong> 안전하게 확장</li><li><strong>각 레이어별로 명확한 책임</strong>을 가지고 개발</li><li><strong>테스트를 통한 안정성 보장</strong>이 가능한 상태</li></ol><p>좋은 코드 구조는 새로운 요구사항이 왔을 때 그 진가를 발휘한다고 생각한다. 요구사항 변화에 유연하게 대응할 수 있는 코드가 바로 클린코드라고 할 수 있지 않을까?</p><p>이걸 설명하기 위해 여기까지 달려왔다.. 어휴 힘들다.</p><h2 id="_4단계-react로-전환-기술-요구사항의-변화" tabindex="-1"><a class="header-anchor" href="#_4단계-react로-전환-기술-요구사항의-변화" aria-hidden="true">#</a> 4단계: React로 전환 (기술 요구사항의 변화)</h2><p>앞선 단계에서 관심사 분리를 통해 구축한 코드가 얼마나 잘 설계되었는지 확인해보기 위한 다른 방법 중 하나가 <strong>React로 다시 표현해보는 것</strong>이다. 좋은 아키텍처라면 기술 스택이 바뀌어도 <strong>핵심 비즈니스 로직은 그대로 유지되면서 최소한의 수정만으로 전환</strong>이 가능해야 한다.</p><p>가령, <strong>&quot;Vue로 만들어진걸 React로 다시 만들자!&quot; 같은 상황</strong>을 겪은 사람이 종종 있을 것이다. 혹은 내가 작성한 코드를 라이브러리로 배포 되어 여러 플랫폼에서 쓰이는 상황도 가정해볼 수 있다. 이 또한 요구사항의 변화, 더 정확히는 <strong>기술적 요구사항의 변화</strong>라고 할 수 있다.</p><h3 id="_1-react-세팅하기" tabindex="-1"><a class="header-anchor" href="#_1-react-세팅하기" aria-hidden="true">#</a> (1) React 세팅하기</h3><p>세팅의 경우 지금 중요한 부분은 아니라서, 중요한 부분을 제외하곤 생략하겠다. 궁금하다면 <a href="https://github.com/junilhwang/simple-clean-code-project/commit/19e4fd2862ca4156dd1bb68b2360931541588744" target="_blank" rel="noopener noreferrer">이 커밋 링크<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>를 참고하면 된다.</p><p>중요한 부분은 폴더구조인데, 앞선 과정처럼 step3 는 유지하고 <strong>step4를 새로 만들자.</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>├── src
│  ├── step1
│  ├── step2
│  ├── step3
│  ├── step4
│  │  ├── domains							<span class="token comment"># 📁 비즈니스 로직 (거의 그대로 유지)</span>
│  │  │  ├── types.ts
│  │  │  ├── constants.ts
│  │  │  ├── cartService.ts
│  │  │  ├── productUtils.ts
│  │  │  └── cartUtils.ts
│  │  ├── hooks	              <span class="token comment"># 📁 React와 도메인 로직 연결</span>
│  │  │  ├── useProducts.ts
│  │  │  └── useCarts.ts
│  │  ├── main.tsx            <span class="token comment"># React 진입점</span>
│  │  ├── components.tsx      <span class="token comment"># JSX로 변환</span>
│  │  └── App.tsx             <span class="token comment"># 컴포넌트 조합</span>
│  ├── vite-env.d.ts
│  └── setupTests.ts
├── step1.html
├── step2.html
├── step3.html
└── step4.html                <span class="token comment"># react 어플리케이션을 실행할 html 생성</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>apps는 사라질 것이다. <strong>렌더링에 대한 부분을 React에게 위임</strong>했기 때문에 크게 신경쓰지 않아도 된다.</li><li>domains의 내용을 hooks와 분할했다. <strong>기존에 store가 하던 역할을 hooks이 대체</strong>할 것이다.</li><li>components의 내용은 크게 다르지 않을 것이다.</li></ul><img src="https://www.plantuml.com/plantuml/svg/PPDFYzD06CRlyobUkgSY5RKt3ykwzQ3YFwmBWlKGah4DJMR2PA8iuc4rNPRT5KMKhT2gnL8HUWWbmeeBVXUFpUGxE3D9t8IG799tVi_pvdbdikLpW_70TH2tkOD1V0pJL_Dqz4QinY2-XkcdyLNeSiemh4-Z91h3t_ttS8FI8Lo0BcRFR5Ek_5oAMOIGFxI9Pp331SSccEzw62ZZ0rfQy0npQFHnb-_APWoRt21z1vU0hDSB1B0jqJwZ0R4wrA4CDfvUKfTQeSp2BA-ssstq4g7S61gNcv3y2iNY83aw48TpI6OJyNsl0OOFrwbhsCJNxlzxGqC64xCO_2obpg9n_IbLr9J3sk6su_U8nwWLcCMRMiZ7eRMwNDK6Fkv8IiBowNwczZMinkd3ncsxF-3RJg1wobjRG2lmMfiveQhPVB9gHa0b_fKcxDm4yJjEtowJy3WzFDKjEjJrAC64rzAdeqdwuJXP_85aiKp3AFaIzqXD_n2xdcDmh7og-blTH_dHw947s31vlRb4bAwMi6oQHohGQgXs4yGqJbPpwGZY95gl8aYY7-9eglslULujbjhfYshO9U7qR1s7kLuBxpdM7SbLbUBrdfY4bHJYv9q89pqoKES-Er0Wlfs9poDjSnS_LpQrVBbz7gsWTBHiGyy3eoBuEOXGSLvRZmUsPM7oPBEqZwYqfIL0pGAXBKmi-LF_0m00" alt="uml diagram"><h3 id="_2-각-레이어별-전환-분석" tabindex="-1"><a class="header-anchor" href="#_2-각-레이어별-전환-분석" aria-hidden="true">#</a> (2) 각 레이어별 전환 분석</h3><h4 id="_1-비즈니스-로직" tabindex="-1"><a class="header-anchor" href="#_1-비즈니스-로직" aria-hidden="true">#</a> 1) 비즈니스 로직</h4><p>기존에는 이렇게 <strong>값과 함수를 묶어서 store로 사용</strong>했었다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 기존: domains.ts</span>
<span class="token keyword">const</span> createCarts <span class="token operator">=</span> <span class="token punctuation">(</span>initValue<span class="token operator">:</span> Record<span class="token operator">&lt;</span>Product<span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Cart<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>initValue <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">get</span> <span class="token function">items</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">get</span> <span class="token function">selectedItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>selected<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">add</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> productId<span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> selected<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">updateQuantity</span><span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      value<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>quantity<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">createProducts</span> <span class="token operator">=</span> <span class="token punctuation">(</span>initValue <span class="token operator">=</span> <span class="token constant">INITIAL_PRODUCTS</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* 생략 */</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> createStore <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  products<span class="token operator">:</span> defaultProducts <span class="token operator">=</span> <span class="token constant">INITIAL_PRODUCTS</span><span class="token punctuation">,</span>
  carts<span class="token operator">:</span> defaultCarts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  products<span class="token operator">?</span><span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  carts<span class="token operator">?</span><span class="token operator">:</span> Record<span class="token operator">&lt;</span>Product<span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Cart<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token function">createProducts</span><span class="token punctuation">(</span>defaultProducts<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> carts <span class="token operator">=</span> <span class="token function">createCarts</span><span class="token punctuation">(</span>defaultCarts<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    products<span class="token punctuation">,</span>
    carts<span class="token punctuation">,</span>
    <span class="token keyword">get</span> <span class="token function">totalCartPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">get</span> <span class="token function">cartsWithProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">addToCart</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">incrementCartQuantity</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 생략 */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>다만 리액트에서는 값을 불변성으로 다루기 때문에, <strong>이걸 그대로 사용하기가 쉽지 않다.</strong> 이 로직에서 함수의 사이드 이펙트를 제거하는 방향으로 개선하고, <strong>함수가 값을 반환하도록</strong> 만들어야 한다.</p><p>그 다음 핵심 로직을 cartUtils, productUtils, cartService 로 분리하고, useCarts, useProducts 등의 훅을 만든 후 도메인 로직을 가져다 사용하는 방식으로 만들수 있다. 즉, 기존의 <code>createCarts</code> 과 유사한 모습으로 <code>useCarts</code> 라는 훅을 정의한다고 생각하면 된다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// domains/types.ts</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  price<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  image<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Cart</span> <span class="token punctuation">{</span>
  productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  selected<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">Carts</span> <span class="token operator">=</span> Record<span class="token operator">&lt;</span>Product<span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Cart<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">Products</span> <span class="token operator">=</span> Record<span class="token operator">&lt;</span>Product<span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Product<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">CartWithProduct</span> <span class="token operator">=</span> Omit<span class="token operator">&lt;</span>Product<span class="token punctuation">,</span> <span class="token string">&#39;quantity&#39;</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span>
  Pick<span class="token operator">&lt;</span>Cart<span class="token punctuation">,</span> <span class="token string">&#39;quantity&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;selected&#39;</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span> subtotal<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// domains/cartUtils.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> cartUtils <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">add</span><span class="token punctuation">(</span>carts<span class="token operator">:</span> Carts<span class="token punctuation">,</span> productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> newCart <span class="token operator">=</span> carts<span class="token punctuation">[</span>productId<span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token punctuation">{</span>
      productId<span class="token punctuation">,</span>
      quantity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      selected<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>carts<span class="token punctuation">,</span>
      <span class="token punctuation">[</span>newCart<span class="token punctuation">.</span>productId<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span>newCart<span class="token punctuation">,</span> quantity<span class="token operator">:</span> newCart<span class="token punctuation">.</span>quantity <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">updateQuantity</span><span class="token operator">:</span> <span class="token punctuation">(</span>carts<span class="token operator">:</span> Carts<span class="token punctuation">,</span> productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token operator">...</span>carts<span class="token punctuation">,</span>
    <span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>carts<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">,</span>
      quantity<span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>quantity<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">remove</span><span class="token operator">:</span> <span class="token punctuation">(</span>carts<span class="token operator">:</span> Carts<span class="token punctuation">,</span> productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> newCarts <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>carts <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> newCarts<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> newCarts<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">removeSelected</span><span class="token operator">:</span> <span class="token punctuation">(</span>carts<span class="token operator">:</span> Carts<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span>
      Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>carts<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">,</span> cart<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>cart<span class="token punctuation">.</span>selected<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">toggleSelect</span><span class="token punctuation">(</span>carts<span class="token operator">:</span> Carts<span class="token punctuation">,</span> productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token operator">:</span> cart <span class="token punctuation">}</span> <span class="token operator">=</span> carts<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>carts<span class="token punctuation">,</span>
      <span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span>cart<span class="token punctuation">,</span> selected<span class="token operator">:</span> <span class="token operator">!</span>cart<span class="token punctuation">.</span>selected <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">updateAllSelected</span><span class="token operator">:</span> <span class="token punctuation">(</span>carts<span class="token operator">:</span> Carts<span class="token punctuation">,</span> selected<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span>
      Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>carts<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>id<span class="token punctuation">,</span> cart<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>id<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token operator">...</span>cart<span class="token punctuation">,</span> selected <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">selectAll</span><span class="token operator">:</span> <span class="token punctuation">(</span>carts<span class="token operator">:</span> Carts<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> cartUtils<span class="token punctuation">.</span><span class="token function">updateAllSelected</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">deselectAll</span><span class="token operator">:</span> <span class="token punctuation">(</span>carts<span class="token operator">:</span> Carts<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> cartUtils<span class="token punctuation">.</span><span class="token function">updateAllSelected</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// domains/productUtils.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> productUtils <span class="token operator">=</span> <span class="token punctuation">{</span>
  getFilteredItems<span class="token operator">:</span> <span class="token punctuation">(</span>
    products<span class="token operator">:</span> Products<span class="token punctuation">,</span>
    <span class="token punctuation">{</span> searchKey <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> orderBy<span class="token punctuation">,</span> sortBy <span class="token operator">=</span> <span class="token string">&#39;default&#39;</span> <span class="token punctuation">}</span><span class="token operator">:</span> Partial<span class="token operator">&lt;</span>ProductOptions<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> values <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> searchedItems <span class="token operator">=</span>
      searchKey<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&#39;&#39;</span>
        <span class="token operator">?</span> values
        <span class="token operator">:</span> values<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            item<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>searchKey<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>sortBy <span class="token operator">===</span> <span class="token string">&#39;default&#39;</span> <span class="token operator">&amp;&amp;</span> orderBy <span class="token operator">===</span> <span class="token string">&#39;asc&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> searchedItems<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> searchedItems<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> comparison <span class="token operator">=</span>
        sortBy <span class="token operator">===</span> <span class="token string">&#39;name&#39;</span> <span class="token operator">?</span> a<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">localeCompare</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token operator">:</span> a<span class="token punctuation">.</span>price <span class="token operator">-</span> b<span class="token punctuation">.</span>price<span class="token punctuation">;</span>

      <span class="token keyword">return</span> orderBy <span class="token operator">===</span> <span class="token string">&#39;asc&#39;</span> <span class="token operator">?</span> comparison <span class="token operator">:</span> <span class="token operator">-</span>comparison<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">isOutOfStock</span><span class="token operator">:</span> <span class="token punctuation">(</span>product<span class="token operator">:</span> Product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> product<span class="token punctuation">.</span>quantity <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// domains/cartService.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> cartService <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">getTotalCartPrice</span><span class="token operator">:</span> <span class="token punctuation">(</span>carts<span class="token operator">:</span> Carts<span class="token punctuation">,</span> products<span class="token operator">:</span> Products<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>carts<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> product <span class="token operator">=</span> products<span class="token punctuation">[</span>item<span class="token punctuation">.</span>productId<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> total <span class="token operator">+</span> <span class="token punctuation">(</span>product <span class="token operator">?</span> product<span class="token punctuation">.</span>price <span class="token operator">*</span> item<span class="token punctuation">.</span>quantity <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  getCartsWithProduct<span class="token operator">:</span> <span class="token punctuation">(</span>carts<span class="token operator">:</span> Carts<span class="token punctuation">,</span> products<span class="token operator">:</span> Products<span class="token punctuation">)</span><span class="token operator">:</span> CartWithProduct<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=&gt;</span>
    Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>carts<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> productId<span class="token punctuation">,</span> quantity<span class="token punctuation">,</span> selected <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> product <span class="token operator">=</span> products<span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>product<span class="token punctuation">,</span>
        quantity<span class="token punctuation">,</span>
        selected<span class="token punctuation">,</span>
        subtotal<span class="token operator">:</span> product<span class="token punctuation">.</span>price <span class="token operator">*</span> quantity<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">addToCart</span><span class="token operator">:</span> <span class="token punctuation">(</span>carts<span class="token operator">:</span> Carts<span class="token punctuation">,</span> products<span class="token operator">:</span> Products<span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> cartQuantity <span class="token operator">=</span> carts<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token operator">?.</span>quantity <span class="token operator">??</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> productQuantity <span class="token operator">=</span> products<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
      productUtils<span class="token punctuation">.</span><span class="token function">isOutOfStock</span><span class="token punctuation">(</span>products<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span>
      cartQuantity <span class="token operator">&gt;=</span> productQuantity
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> carts<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> cartUtils<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">incrementCartQuantity</span><span class="token operator">:</span> <span class="token punctuation">(</span>
    carts<span class="token operator">:</span> Carts<span class="token punctuation">,</span>
    products<span class="token operator">:</span> Products<span class="token punctuation">,</span>
    id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    quantity<span class="token operator">:</span> <span class="token builtin">number</span>
  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> cartQuantity <span class="token operator">=</span> carts<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity<span class="token punctuation">;</span>
    <span class="token keyword">const</span> productQuantity <span class="token operator">=</span> products<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity<span class="token punctuation">;</span>
    <span class="token keyword">return</span> cartUtils<span class="token punctuation">.</span><span class="token function">updateQuantity</span><span class="token punctuation">(</span>
      carts<span class="token punctuation">,</span>
      id<span class="token punctuation">,</span>
      Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>cartQuantity <span class="token operator">+</span> quantity<span class="token punctuation">,</span> productQuantity<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// hooks/useCarts.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useCarts</span> <span class="token operator">=</span> <span class="token punctuation">(</span>products<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>carts<span class="token punctuation">,</span> setCarts<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>Carts<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 기존에 getter로 정의된 것들은 hook에서 파생상태로 관리하면 된다.</span>
  <span class="token comment">// 어차피 렌더링을 할 때 이 값들이 재계산 되어 쓰여진다.</span>
  <span class="token keyword">const</span> values <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>carts<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// cartUtils 뿐만 아니라 cartService 의 로직도 가져다 사용할 수 있다.</span>
  <span class="token keyword">const</span> totalPrice <span class="token operator">=</span> cartService<span class="token punctuation">.</span><span class="token function">getTotalCartPrice</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> products<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> itemsWithProduct <span class="token operator">=</span> cartService<span class="token punctuation">.</span><span class="token function">getCartsWithProduct</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> products<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> selectedItems <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>selected<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> selectedSize <span class="token operator">=</span> selectedItems<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">const</span> allSelected <span class="token operator">=</span> selectedSize <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> selectedSize <span class="token operator">===</span> itemsWithProduct<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> ProductId<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">setCarts</span><span class="token punctuation">(</span>cartService<span class="token punctuation">.</span><span class="token function">addToCart</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> products<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">incrementQuantity</span> <span class="token operator">=</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> ProductId<span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">setCarts</span><span class="token punctuation">(</span>cartService<span class="token punctuation">.</span><span class="token function">incrementCartQuantity</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> products<span class="token punctuation">,</span> id<span class="token punctuation">,</span> quantity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">remove</span> <span class="token operator">=</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> ProductId<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">setCarts</span><span class="token punctuation">(</span>cartUtils<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">removeSelected</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">setCarts</span><span class="token punctuation">(</span>cartUtils<span class="token punctuation">.</span><span class="token function">removeSelected</span><span class="token punctuation">(</span>carts<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">toggleSelect</span> <span class="token operator">=</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> ProductId<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">setCarts</span><span class="token punctuation">(</span>cartUtils<span class="token punctuation">.</span><span class="token function">toggleSelect</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">toggleAllSelected</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">setCarts</span><span class="token punctuation">(</span>cartUtils<span class="token punctuation">.</span><span class="token function">updateAllSelected</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> <span class="token operator">!</span>allSelected<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">clear</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCarts</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    items<span class="token operator">:</span> carts<span class="token punctuation">,</span>
    itemsWithProduct<span class="token punctuation">,</span>
    selectedItems<span class="token punctuation">,</span>
    totalPrice<span class="token punctuation">,</span>
    allSelected<span class="token punctuation">,</span>
    add<span class="token punctuation">,</span>
    incrementQuantity<span class="token punctuation">,</span>
    remove<span class="token punctuation">,</span>
    removeSelected<span class="token punctuation">,</span>
    toggleSelect<span class="token punctuation">,</span>
    toggleAllSelected<span class="token punctuation">,</span>
    clear<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// hooks/useProducts.ts</span>
<span class="token keyword">const</span> toMap <span class="token operator">=</span> <span class="token punctuation">(</span>arr<span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> Products <span class="token operator">=&gt;</span>
arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>acc<span class="token punctuation">,</span> <span class="token punctuation">[</span>product<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token operator">:</span> product <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useProducts</span> <span class="token operator">=</span> <span class="token punctuation">(</span>initValue <span class="token operator">=</span> <span class="token constant">INITIAL_PRODUCTS</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>products<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">toMap</span><span class="token punctuation">(</span>initValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>options<span class="token punctuation">,</span> setOptions<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">INITIAL_PRODUCT_OPTIONS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> filteredItems <span class="token operator">=</span> productUtils<span class="token punctuation">.</span><span class="token function">getFilteredItems</span><span class="token punctuation">(</span>products<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">changeOptions</span> <span class="token operator">=</span> <span class="token punctuation">(</span>newValue<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>ProductOptions<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">setOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>options<span class="token punctuation">,</span> <span class="token operator">...</span>newValue <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> items<span class="token operator">:</span> products<span class="token punctuation">,</span> filteredItems<span class="token punctuation">,</span> changeOptions <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>변환 과정에 대해 정리를 해보자면 다음과 같다.</p><img src="https://www.plantuml.com/plantuml/svg/JP2z3e8m4CVtFiK5H-CBE1YYYuE32N5pQSe56afBsgi9ZyFkmA29pqHu24j1mzJh_wFvNLD7t9Al5ID92lTmDgQ2BTn8AXVE3Er32cJCLL8ttF8QbDH8RODWB9LcPJHSLBp0Z5g5O54GruKArVy8oV3fn-u5Zen56DxFiUiJu0woILW7HQ2A37VTM9DxyRjDnW8Lcr5UDxt3KyY4Q9YkSzV5wBIQWyr55YKTbGzayvQxms81YnoJC3_BKjHv-9ml" alt="uml diagram"><ul><li>store의 역할을 hook이 대체한다.</li><li>store의 로직을 utils와 service로 분리한다.</li><li>hooks에서 utils와 service를 가져다 사용한다.</li></ul><p>사실 이걸 3단계에서 미리 했어도 좋았을 것 같다. 하지만 <strong>이렇게 경험을 해봐야 다음에 더 신중하게 작성</strong>할 수 있다.</p><h4 id="_2-ui-컴포넌트-구조는-동일-문법만-변화" tabindex="-1"><a class="header-anchor" href="#_2-ui-컴포넌트-구조는-동일-문법만-변화" aria-hidden="true">#</a> 2) UI 컴포넌트: 구조는 동일, 문법만 변화</h4><ul><li><p>기존 컴포넌트는 다음과 같이 template literal 로 만들어졌다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 기존: components.ts</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">ProductItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> image<span class="token punctuation">,</span> name<span class="token punctuation">,</span> price<span class="token punctuation">,</span> id<span class="token punctuation">,</span> quantity <span class="token punctuation">}</span><span class="token operator">:</span> Product<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> disabled <span class="token operator">=</span> quantity <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div class=&quot;bg-white p-4 rounded-lg shadow&quot; data-product-id=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;
      &lt;img src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>image<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; alt=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; class=&quot;w-full h-48 object-cover mb-4 rounded </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>disabled <span class="token operator">?</span> <span class="token string">&#39;opacity-50&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;
      &lt;h3 class=&quot;text-lg font-bold mb-2&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/h3&gt;
      &lt;p class=&quot;text-gray-600 mb-2&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>price<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">원&lt;/p&gt;
      &lt;button class=&quot;w-full </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>disabled <span class="token operator">?</span> <span class="token string">&#39;bg-gray-400&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;bg-blue-500&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> text-white py-2 px-4 rounded add-to-cart-btn&quot;
              data-product-id=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>disabled <span class="token operator">?</span> <span class="token string">&#39;disabled&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&gt;
        </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>disabled <span class="token operator">?</span> <span class="token string">&#39;품절&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;장바구니 담기&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      &lt;/button&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>이제 jsx 문법을 이용하여 표현할 수 있다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">ProductItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token punctuation">,</span>
  image<span class="token punctuation">,</span>
  name<span class="token punctuation">,</span>
  price<span class="token punctuation">,</span>
  quantity<span class="token punctuation">,</span>

	<span class="token comment">// onCartAddClick 함수가 생겼다.</span>
	<span class="token comment">// 기존에는 main.ts 에서 모든 이벤트를 등록해서 관리했었다.</span>
	<span class="token comment">// 기존의 컴포넌트에서 함수를 받아온다고 해도, 컴포넌트가 렌더링된 결과물이 아닌 단순 문자열이기 때문에 이벤트를 등록할 수 없었다.</span>
  onCartAddClick<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> Product <span class="token operator">&amp;</span> <span class="token punctuation">{</span> onCartAddClick<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> disabled <span class="token operator">=</span> quantity <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-4 rounded-lg shadow product-item<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">data-product-id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>relative<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span>
          <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>image<span class="token punctuation">}</span></span>
          <span class="token attr-name">alt</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span>
          <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">w-full h-48 object-cover mb-4 rounded </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>disabled <span class="token operator">?</span> <span class="token string">&#39;opacity-50&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span>
        <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>disabled <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 rounded text-white font-bold<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            품절
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-lg font-bold mb-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-gray-600 mb-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>price<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">원</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-sm text-gray-500 mb-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">재고: </span><span class="token punctuation">{</span>quantity<span class="token punctuation">}</span><span class="token plain-text">개</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed text-white py-2 px-4 rounded add-to-cart-btn</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span>
        <span class="token attr-name">data-product-id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span></span>
        <span class="token attr-name">disabled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>disabled<span class="token punctuation">}</span></span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> onCartAddClick<span class="token operator">?.</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>disabled <span class="token operator">?</span> <span class="token string">&#39;품절&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;장바구니 담기&#39;</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">CartItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token punctuation">,</span>
  quantity<span class="token punctuation">,</span>
  image<span class="token punctuation">,</span>
  name<span class="token punctuation">,</span>
  price<span class="token punctuation">,</span>
  selected<span class="token punctuation">,</span>
  subtotal<span class="token punctuation">,</span>
  onIncrementClick<span class="token punctuation">,</span>
  onDecrementClick<span class="token punctuation">,</span>
  onRemoveClick<span class="token punctuation">,</span>
  onSelect<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> CartWithProduct <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
  onIncrementClick<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  onDecrementClick<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  onRemoveClick<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  onSelect<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cart-item flex items-center gap-3 p-3 border-t<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">data-product-id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cart-item-checkbox<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">data-product-id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span></span>
        <span class="token attr-name">checked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>selected<span class="token punctuation">}</span></span>
        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> onSelect<span class="token operator">?.</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
        <span class="token attr-name">readOnly</span>
      <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>image<span class="token punctuation">}</span></span> <span class="token attr-name">alt</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-16 h-16 object-cover rounded<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>font-bold text-sm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-gray-600 text-sm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span>price<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">원 * </span><span class="token punctuation">{</span>quantity<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">개 =</span><span class="token punctuation">{</span><span class="token string">&#39; &#39;</span><span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token punctuation">{</span>subtotal<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">원
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex items-center gap-2 mt-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>decrease-btn bg-gray-300 text-gray-700 w-6 h-6 rounded text-sm<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> onDecrementClick<span class="token operator">?.</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token plain-text">
            -
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>quantity<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>quantity<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>increase-btn bg-gray-300 text-gray-700 w-6 h-6 rounded text-sm<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> onIncrementClick<span class="token operator">?.</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token plain-text">
            +
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>remove-btn bg-red-500 text-white px-2 py-1 rounded text-xs ml-2<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> onRemoveClick<span class="token operator">?.</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token plain-text">
            삭제
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">CartSummary</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  totalPrice<span class="token punctuation">,</span>
  selection<span class="token punctuation">,</span>
  onRemoveSelectedClick<span class="token punctuation">,</span>
  onClearCartClick<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  totalPrice<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  selection<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  onRemoveSelectedClick<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  onClearCartClick<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mt-4 pt-4 border-t<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex justify-between items-center mb-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-lg font-bold<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">총 합계:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>total-price<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-xl font-bold text-blue-600<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span>totalPrice<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">원
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>remove-selected-cart<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">flex-1 bg-orange-500 hover:bg-orange-600 disabled:bg-gray-400 disabled:cursor-not-allowed text-white py-2 px-4 rounded</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span>
          <span class="token attr-name">disabled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token operator">!</span>selection<span class="token punctuation">}</span></span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onRemoveSelectedClick<span class="token punctuation">}</span></span>
        <span class="token punctuation">&gt;</span></span><span class="token plain-text">
          선택 삭제
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clear-cart<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-1 bg-red-500 text-white py-2 px-4 rounded hover:bg-red-600<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onClearCartClick<span class="token punctuation">}</span></span>
        <span class="token punctuation">&gt;</span></span><span class="token plain-text">
          전체 비우기
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">ProductControls</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  onInputEnterKeyDown<span class="token punctuation">,</span>
  onOrderChange<span class="token punctuation">,</span>
  onSortChange<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  onInputEnterKeyDown<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  onOrderChange<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> ProductOptions<span class="token punctuation">[</span><span class="token string">&#39;orderBy&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  onSortChange<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> ProductOptions<span class="token punctuation">[</span><span class="token string">&#39;sortBy&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> handleInputEnterKeyDown<span class="token operator">:</span> KeyboardEventHandler<span class="token operator">&lt;</span>HTMLInputElement<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
    e
  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>key <span class="token operator">===</span> <span class="token string">&#39;Enter&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      onInputEnterKeyDown<span class="token operator">?.</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> handleOrderChange<span class="token operator">:</span> ChangeEventHandler<span class="token operator">&lt;</span>HTMLSelectElement<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> value <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token keyword">as</span> <span class="token string">&#39;asc&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;desc&#39;</span><span class="token punctuation">;</span>
    onOrderChange<span class="token operator">?.</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> handleSortChange<span class="token operator">:</span> ChangeEventHandler<span class="token operator">&lt;</span>HTMLSelectElement<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> value <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token keyword">as</span> <span class="token string">&#39;price&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;name&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;default&#39;</span><span class="token punctuation">;</span>
    onSortChange<span class="token operator">?.</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-4 rounded-lg shadow mb-6<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex flex-wrap gap-4 items-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token comment">/* 검색 */</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-1 min-w-64<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
            <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search-input<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>상품명으로 검색...<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">onKeyDown</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleInputEnterKeyDown<span class="token punctuation">}</span></span>
          <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

        </span><span class="token punctuation">{</span><span class="token comment">/* 정렬 */</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span>
            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sort-select<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSortChange<span class="token punctuation">}</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>default<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">기본순</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">이름순</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>price<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">가격순</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span>
            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>order-select<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleOrderChange<span class="token punctuation">}</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>asc<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">오름차순</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>desc<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">내림차순</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>대부분의 코드는 거의 동일하다. 제일 큰 변화는 컴포넌트에서 이벤트 함수를 받오는 부분이다. 리액트 컴포넌트의 반환 값은 ReactNode 인데 node에 이벤트 함수를 할당해놓으면 나중에 렌더링할 때 리액트 내부에서 DOM에 이벤트를 등록해준다.</p><h4 id="_3-이벤트-연결하기-구조-개선" tabindex="-1"><a class="header-anchor" href="#_3-이벤트-연결하기-구조-개선" aria-hidden="true">#</a> 3) 이벤트 연결하기 (구조 개선)</h4><p>AS-IS: 기존에는 main.ts 에서 모든 이벤트를 연결해줬다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 기존: main.ts - 복잡한 DOM 탐색 필요</span>
<span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.increase-btn, .decrease-btn&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target <span class="token keyword">as</span> HTMLElement<span class="token punctuation">;</span>
  <span class="token keyword">const</span> cartItemEl <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> productId <span class="token operator">=</span> cartItemEl<span class="token operator">?.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;data-product-id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>productId <span class="token operator">||</span> <span class="token operator">!</span>cartItemEl<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> quantity <span class="token operator">=</span> target<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&#39;increase-btn&#39;</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  store<span class="token punctuation">.</span><span class="token function">incrementCartQuantity</span><span class="token punctuation">(</span>productId<span class="token punctuation">,</span> quantity<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>TO-BE: 상위 컴포넌트에서 hook을 통해 정의된 핵심 로직을 가져오고, 이걸 컴포넌트에 내려주는 방식으로 만들었다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ./App.tsx</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token function">useProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> carts <span class="token operator">=</span> <span class="token function">useCarts</span><span class="token punctuation">(</span>products<span class="token punctuation">.</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> selection <span class="token operator">=</span> carts<span class="token punctuation">.</span>selectedItems<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container mx-auto py-20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-3xl font-bold mb-8 text-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">쇼핑몰</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductControls</span></span>
            <span class="token attr-name">onInputEnterKeyDown</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>searchKey<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
              products<span class="token punctuation">.</span><span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> searchKey <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span></span>
            <span class="token attr-name">onOrderChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>orderBy<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> products<span class="token punctuation">.</span><span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> orderBy <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
            <span class="token attr-name">onSortChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>sortBy<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> products<span class="token punctuation">.</span><span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> sortBy <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
          <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product-list<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4<span class="token punctuation">&quot;</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token punctuation">{</span>products<span class="token punctuation">.</span>filteredItems<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductItem</span></span>
                <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>
                <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>product<span class="token punctuation">}</span></span>
                <span class="token attr-name">onCartAddClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>add<span class="token punctuation">}</span></span>
              <span class="token punctuation">/&gt;</span></span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

        </span><span class="token punctuation">{</span><span class="token comment">/* 장바구니 */</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-6 rounded-lg shadow w-[400px]<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-2xl font-bold mb-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">장바구니</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cart-items<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>itemsWithProduct<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-2 mb-2 ml-3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
                  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span>
                  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>select-all-cart<span class="token punctuation">&quot;</span></span>
                  <span class="token attr-name">checked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>allSelected<span class="token punctuation">}</span></span>
                  <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>toggleAllSelected<span class="token punctuation">}</span></span>
                  <span class="token attr-name">readOnly</span>
                <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
            </span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>itemsWithProduct<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>cartItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartItem</span></span>
                <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>cartItem<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>
                <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>cartItem<span class="token punctuation">}</span></span>
                <span class="token attr-name">onIncrementClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> carts<span class="token punctuation">.</span><span class="token function">incrementQuantity</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
                <span class="token attr-name">onDecrementClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> carts<span class="token punctuation">.</span><span class="token function">incrementQuantity</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
                <span class="token attr-name">onRemoveClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>remove<span class="token punctuation">}</span></span>
                <span class="token attr-name">onSelect</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>toggleSelect<span class="token punctuation">}</span></span>
              <span class="token punctuation">/&gt;</span></span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartSummary</span></span>
            <span class="token attr-name">totalPrice</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>totalPrice<span class="token punctuation">}</span></span>
            <span class="token attr-name">selection</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>selection<span class="token punctuation">}</span></span>
            <span class="token attr-name">onRemoveSelectedClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>removeSelected<span class="token punctuation">}</span></span>
            <span class="token attr-name">onClearCartClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>clear<span class="token punctuation">}</span></span>
          <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>이벤트를 다루는 로직은 사실 대부분 유사하다. 다만 &quot;<strong>이벤트 연결&quot;에 대한 부분을 각각의 컴포넌트에게 위임</strong>했다.</p><h3 id="_3-전환-과정에서-드러난-기존-설계의-장점" tabindex="-1"><a class="header-anchor" href="#_3-전환-과정에서-드러난-기존-설계의-장점" aria-hidden="true">#</a> (3) 전환 과정에서 드러난 기존 설계의 장점</h3><h4 id="_1-관심사-분리의-효과" tabindex="-1"><a class="header-anchor" href="#_1-관심사-분리의-효과" aria-hidden="true">#</a> 1) 관심사 분리의 효과</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 기존에 UI와 비즈니스 로직을 완전히 분리하여 관리하는 방식이었다.</span>
<span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 비즈니스 로직</span>
	<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
	
	<span class="token comment">// UI에 반영</span>
	$root<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	  products<span class="token operator">:</span> store<span class="token punctuation">.</span>products<span class="token punctuation">.</span>filteredItems<span class="token punctuation">,</span>
	  carts<span class="token operator">:</span> <span class="token punctuation">{</span>
	    items<span class="token operator">:</span> store<span class="token punctuation">.</span>cartsWithProduct<span class="token punctuation">,</span>
	    selectedIds<span class="token operator">:</span> store<span class="token punctuation">.</span>carts<span class="token punctuation">.</span>selectedItems<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>productId<span class="token punctuation">)</span><span class="token punctuation">,</span>
	  <span class="token punctuation">}</span><span class="token punctuation">,</span>
	  totalCartPrice<span class="token operator">:</span> store<span class="token punctuation">.</span>totalCartPrice<span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">// 이벤트 연결</span>
	<span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token comment">/* 이벤트 연결 */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 상호작용</span>
<span class="token punctuation">}</span>

<span class="token comment">// ✅ React 전환 시 기존의 코드를 거의 그대로 재사용할 수 있었다.</span>
<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 비즈니스 로직</span>
  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token function">useProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> carts <span class="token operator">=</span> <span class="token function">useCarts</span><span class="token punctuation">(</span>products<span class="token punctuation">.</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> selection <span class="token operator">=</span> carts<span class="token punctuation">.</span>selectedItems<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token comment">// UI에 반영. UI 구조는 거의 그대로 사용</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container mx-auto py-20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-3xl font-bold mb-8 text-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">쇼핑몰</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span><span class="token comment">/* 이벤트는 props으로 자연스럽게 연결 */</span><span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductControls</span></span>
            <span class="token attr-name">onInputEnterKeyDown</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>searchKey<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
              products<span class="token punctuation">.</span><span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> searchKey <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span></span>
            <span class="token attr-name">onOrderChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>orderBy<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> products<span class="token punctuation">.</span><span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> orderBy <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
            <span class="token attr-name">onSortChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>sortBy<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> products<span class="token punctuation">.</span><span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> sortBy <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
          <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product-list<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4<span class="token punctuation">&quot;</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token punctuation">{</span>products<span class="token punctuation">.</span>filteredItems<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductItem</span></span>
                <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>
                <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>product<span class="token punctuation">}</span></span>
                <span class="token attr-name">onCartAddClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>add<span class="token punctuation">}</span></span>
              <span class="token punctuation">/&gt;</span></span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

        </span><span class="token punctuation">{</span><span class="token comment">/* 장바구니 */</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-6 rounded-lg shadow w-[400px]<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-2xl font-bold mb-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">장바구니</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cart-items<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>itemsWithProduct<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-2 mb-2 ml-3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
                  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span>
                  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>select-all-cart<span class="token punctuation">&quot;</span></span>
                  <span class="token attr-name">checked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>allSelected<span class="token punctuation">}</span></span>
                  <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>toggleAllSelected<span class="token punctuation">}</span></span>
                  <span class="token attr-name">readOnly</span>
                <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
            </span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>itemsWithProduct<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>cartItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartItem</span></span>
                <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>cartItem<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>
                <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>cartItem<span class="token punctuation">}</span></span>
                <span class="token attr-name">onIncrementClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> carts<span class="token punctuation">.</span><span class="token function">incrementQuantity</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
                <span class="token attr-name">onDecrementClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> carts<span class="token punctuation">.</span><span class="token function">incrementQuantity</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
                <span class="token attr-name">onRemoveClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>remove<span class="token punctuation">}</span></span>
                <span class="token attr-name">onSelect</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>toggleSelect<span class="token punctuation">}</span></span>
              <span class="token punctuation">/&gt;</span></span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartSummary</span></span>
            <span class="token attr-name">totalPrice</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>totalPrice<span class="token punctuation">}</span></span>
            <span class="token attr-name">selection</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>selection<span class="token punctuation">}</span></span>
            <span class="token attr-name">onRemoveSelectedClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>removeSelected<span class="token punctuation">}</span></span>
            <span class="token attr-name">onClearCartClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>clear<span class="token punctuation">}</span></span>
          <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-순수-함수-설계의-효과" tabindex="-1"><a class="header-anchor" href="#_2-순수-함수-설계의-효과" aria-hidden="true">#</a> 2) 순수 함수 설계의 효과</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 🎯 기존에 이미 순수 함수로 설계됨</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> cartUtils <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">add</span><span class="token operator">:</span> <span class="token punctuation">(</span>carts<span class="token punctuation">,</span> productId<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* side effect 없음 */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">remove</span><span class="token operator">:</span> <span class="token punctuation">(</span>carts<span class="token punctuation">,</span> productId<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* side effect 없음 */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ✅ React의 immutable 업데이트와 완벽하게 호환</span>
<span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCarts</span><span class="token punctuation">(</span>value <span class="token operator">=&gt;</span> cartUtils<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-타입-정의의-효과" tabindex="-1"><a class="header-anchor" href="#_3-타입-정의의-효과" aria-hidden="true">#</a> 3) 타입 정의의 효과</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 🎯 기존에 이미 명확한 인터페이스 정의</span>
<span class="token keyword">interface</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Cart</span> <span class="token punctuation">{</span> productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token comment">// ✅ React 컴포넌트 props와 완벽하게 호환</span>
<span class="token keyword">function</span> <span class="token function">ProductItem</span><span class="token punctuation">(</span>props<span class="token operator">:</span> Product <span class="token operator">&amp;</span> <span class="token punctuation">{</span> <span class="token function-variable function">onCartAddClick</span><span class="token operator">:</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 타입 변경 없이 그대로 사용 가능</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-테스트-코드-작성" tabindex="-1"><a class="header-anchor" href="#_4-테스트-코드-작성" aria-hidden="true">#</a> (4) 테스트 코드 작성</h3><p>테스트에 대한 부분도 빼먹으면 아쉽다.</p><h4 id="_1-e2e-테스트-작성" tabindex="-1"><a class="header-anchor" href="#_1-e2e-테스트-작성" aria-hidden="true">#</a> 1) e2e 테스트 작성</h4><p>사실 단위 테스트는 지금 작성하지 않아도 좋다. 다만 step3 에서 추가한 기능에 대해 e2e테스트를 작성하고, 이를 그대로 step4에서도 활용하여 “내 코드에 문제가 없구나” 를 판단할 수 있다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code>test<span class="token punctuation">.</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;두 번째 요구사항에 대한 테스트 &gt; &#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">testSecondAssignmentAtPage</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>page<span class="token operator">:</span> Page<span class="token punctuation">,</span> path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">goto</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://localhost:5173/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 기본 화면 요소 확인</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;h1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveText</span><span class="token punctuation">(</span><span class="token string">&#39;쇼핑몰&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;h2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveText</span><span class="token punctuation">(</span><span class="token string">&#39;장바구니&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 상품 컨트롤 요소 확인</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#search-input&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#sort-select&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#order-select&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 초기 상태에서 총 합계가 0원인지 확인</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#total-price&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveText</span><span class="token punctuation">(</span><span class="token string">&#39;0원&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 1. 상품 검색 기능 테스트</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token string">&#39;#search-input&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;맥북&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">press</span><span class="token punctuation">(</span><span class="token string">&#39;#search-input&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Enter&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 맥북 관련 상품만 보여야 함</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.product-item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveCount</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 맥북 프로, 맥북 에어</span>

    <span class="token comment">// 검색 초기화</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token string">&#39;#search-input&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">press</span><span class="token punctuation">(</span><span class="token string">&#39;#search-input&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Enter&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2. 상품 정렬 기능 테스트</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">selectOption</span><span class="token punctuation">(</span><span class="token string">&#39;#sort-select&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;price&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">selectOption</span><span class="token punctuation">(</span><span class="token string">&#39;#order-select&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;asc&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 가격 오름차순으로 정렬되는지 확인은 상품 순서로 판단</span>

    <span class="token comment">// 3. 장바구니에 상품 추가</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;.product-item[data-product-id=&quot;1&quot;] .add-to-cart-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;.product-item[data-product-id=&quot;2&quot;] .add-to-cart-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;.product-item[data-product-id=&quot;4&quot;] .add-to-cart-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 장바구니에 아이템이 추가되었는지 확인</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveCount</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#select-all-cart&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 전체 선택 체크박스가 나타남</span>

    <span class="token comment">// 4. 장바구니 수량 변경 테스트</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item[data-product-id=&quot;1&quot;] .increase-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item[data-product-id=&quot;1&quot;] .increase-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 첫 번째 상품의 수량이 3이 되었는지 확인</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>
      page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item[data-product-id=&quot;1&quot;] .quantity&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveText</span><span class="token punctuation">(</span><span class="token string">&#39;3&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 수량 감소 테스트</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item[data-product-id=&quot;1&quot;] .decrease-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>
      page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item[data-product-id=&quot;1&quot;] .quantity&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveText</span><span class="token punctuation">(</span><span class="token string">&#39;2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 5. 장바구니 개별 선택 테스트</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item[data-product-id=&quot;1&quot;] .cart-item-checkbox&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item[data-product-id=&quot;2&quot;] .cart-item-checkbox&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 선택 삭제 버튼이 활성화되었는지 확인</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#remove-selected-cart&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>not<span class="token punctuation">.</span><span class="token function">toHaveAttribute</span><span class="token punctuation">(</span>
      <span class="token string">&#39;disabled&#39;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 6. 전체 선택 기능 테스트</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;#select-all-cart&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 모든 아이템이 선택되었는지 확인</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item-checkbox:checked&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveCount</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 전체 선택 해제</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;#select-all-cart&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item-checkbox:checked&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 7. 선택한 아이템 삭제 테스트</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item[data-product-id=&quot;1&quot;] .cart-item-checkbox&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item[data-product-id=&quot;2&quot;] .cart-item-checkbox&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;#remove-selected-cart&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 선택한 아이템들이 삭제되고 1개만 남았는지 확인</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveCount</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item[data-product-id=&quot;4&quot;]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 8. 개별 상품 삭제 테스트</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item[data-product-id=&quot;4&quot;] .remove-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#total-price&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveText</span><span class="token punctuation">(</span><span class="token string">&#39;0원&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 9. 재고 관리 테스트 - 재고가 있는 상품에 최대 재고까지 추가</span>
    <span class="token keyword">const</span> productWithStock <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.product-item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> stockText <span class="token operator">=</span> <span class="token keyword">await</span> productWithStock<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;p&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">textContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> stockMatch <span class="token operator">=</span> stockText<span class="token operator">?.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">재고: (\d+)개</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> stockCount <span class="token operator">=</span> stockMatch <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>stockMatch<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>stockCount <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 첫 번째 상품을 장바구니에 추가</span>
      <span class="token keyword">await</span> productWithStock<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.add-to-cart-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 재고만큼 수량 증가 시도</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> stockCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item .increase-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// 재고 이상으로 추가 시도해도 재고 수량을 넘지 않는지 확인</span>
      <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item .increase-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item .increase-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item .quantity&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveText</span><span class="token punctuation">(</span>
        stockCount<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 10. 전체 비우기 테스트</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;#clear-cart&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.cart-item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;#total-price&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveText</span><span class="token punctuation">(</span><span class="token string">&#39;0원&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 품절 테스트 (재고가 0인 상품)</span>
    <span class="token keyword">const</span> soldOutProduct <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.product-item[data-product-id=&quot;3&quot;]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 품절 상품의 버튼이 비활성화되어 있는지 확인</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>soldOutProduct<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.add-to-cart-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveAttribute</span><span class="token punctuation">(</span>
      <span class="token string">&#39;disabled&#39;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>soldOutProduct<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;.add-to-cart-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveText</span><span class="token punctuation">(</span><span class="token string">&#39;품절&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>soldOutProduct<span class="token punctuation">.</span><span class="token function">locator</span><span class="token punctuation">(</span><span class="token string">&#39;img&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveClass</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">opacity-50</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;step3 &gt; &#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> page <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">testSecondAssignmentAtPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token string">&#39;step3&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;step4 &gt; &#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> page <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">testSecondAssignmentAtPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token string">&#39;step4&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>실제로 이렇게 e2e를 작성하면서 react로 작성한 코드 중 잘못된 부분을 찾아낼 수 있었다. <s>근데 좀 귀찮다</s></p><p>테스트는 step2에서 다뤘던 것 처럼 codegen 을 이용하는게 제일 좋다고 생각한다. 나는 그 마저도 귀찮아서 일단 AI에게 위임했다.</p><p><img src="/TIL/assets/3.af79b9a3.png" alt="3.png"></p><p>e2e 가 통과 되도록 테스트를 만들었으면, 이제 단위테스트를 만들어보자.</p><h4 id="_2-단위테스트-작성" tabindex="-1"><a class="header-anchor" href="#_2-단위테스트-작성" aria-hidden="true">#</a> 2) 단위테스트 작성</h4><p>단위 테스트는 <a href="https://github.com/junilhwang/simple-clean-code-project/commit/797fc4228b1eb0879328af98c9bf392a11bc4baa" target="_blank" rel="noopener noreferrer">이 커밋<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>을 참고해주면 될 것 같다.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>./src/step4
├── domains
│   ├── __tests__                   <span class="token comment"># 순수 함수에 대한 단위 테스트 작성</span>
│   │   ├── cartUtils.test.ts
│   │   ├── cartService.test.ts
│   │   └── productUtils.test.ts
│   ├── types.ts
│   ├── constants.ts
│   ├── cartService.ts
│   ├── productUtils.ts
│   └── cartUtils.ts
├── hooks
│   ├── __tests__                   <span class="token comment"># 훅에 대한 단위 테스트 작성</span>
│   │   ├── useProducts.test.ts
│   │   └── useCarts.test.ts
│   ├── useProducts.ts
│   └── useCarts.ts
├── main.tsx
├── components.tsx
├── dummies.ts
└── App.tsx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>컴포넌트에 대한 테스트는 e2e에게 위임했고, 나는 custom hook과 utils 에 대한 테스트만 진행했다.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">pnpm</span> run test:coverage --coverage.include<span class="token operator">=</span>src/step4
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/TIL/assets/4.e349470a.png" alt="4.png"></p><h3 id="_5-4단계-데모" tabindex="-1"><a class="header-anchor" href="#_5-4단계-데모" aria-hidden="true">#</a> (5) 4단계 데모</h3><ul><li>링크: <a href="https://junilhwang.github.io/simple-clean-code-project/step4.html" target="_blank" rel="noopener noreferrer">https://junilhwang.github.io/simple-clean-code-project/step4.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>전체코드: <a href="https://github.com/JunilHwang/simple-clean-code-project/tree/main/src/step4" target="_blank" rel="noopener noreferrer">https://github.com/JunilHwang/simple-clean-code-project/tree/main/src/step4<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><div class="iframe-container"><iframe src="https://junilhwang.github.io/simple-clean-code-project/step4.html"></iframe></div><h3 id="_6-summary-좋은-설계의-검증" tabindex="-1"><a class="header-anchor" href="#_6-summary-좋은-설계의-검증" aria-hidden="true">#</a> (6) Summary: 좋은 설계의 검증</h3><p>React로의 전환 과정을 통해 확인할 수 있었던 것들은 다음과 같다.</p><ol><li><strong>관심사 분리의 중요성</strong>: UI와 로직이 분리되어 있어 기술 스택 변경이 쉬웠다.</li><li><strong>순수 함수 설계의 가치</strong>: 사이드 이펙트가 없는 함수들이 React의 불변성 원칙과 자연스럽게 호환되었다.</li><li><strong>명확한 인터페이스 정의의 효과</strong>: 타입 정의가 명확해서 컴포넌트 props로 매끄럽게 전환되었다.</li><li><strong>테스트 가능한 구조의 장점</strong>: 독립적인 함수들로 구성되어 있어 React 환경에서도 동일한 테스트가 가능했다.</li></ol><h2 id="_5단계-react-상태관리와-성능최적화" tabindex="-1"><a class="header-anchor" href="#_5단계-react-상태관리와-성능최적화" aria-hidden="true">#</a> 5단계: React 상태관리와 성능최적화</h2><p>4단계에서 React로 전환한 코드가 잘 동작하지만, 성능과 구조적 측면에서 고민해볼 부분이 있다. 현재 코드의 문제점을 분석하고, 상태관리 라이브러리를 도입해서 해결해보자.</p><h3 id="_1-현재-코드의-문제점-분석" tabindex="-1"><a class="header-anchor" href="#_1-현재-코드의-문제점-분석" aria-hidden="true">#</a> (1) 현재 코드의 문제점 분석</h3><h4 id="_1-react-component-렌더링-분석" tabindex="-1"><a class="header-anchor" href="#_1-react-component-렌더링-분석" aria-hidden="true">#</a> 1) React component 렌더링 분석</h4><p>먼저 <a href="https://chromewebstore.google.com/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi?hl=ko" target="_blank" rel="noopener noreferrer">React Developer Tools<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 확장 프로그램을 설치해야 한다.</p><p>설치가 완료 되었으면 개발자 도구를 열어서 <code>Profile &gt; General &gt; Highlight updates when components render</code> 를 활성화 해야한다.</p><p><img src="/TIL/assets/5.ca47f307.png" alt="image.png"></p><p>어플리케이션에서 인터랙션을 발생시켜 컴포넌트가 어떻게 렌더링 되는지 확인해볼 수 있다.</p><p><img src="/TIL/assets/step5-as-is.4d80936b.gif" alt="step5-성능문제.gif"></p><p>잘 보면 인터랙션이 발생할 때 마다 모든 컴포넌트가 리렌더링 되는 것을 확인할 수 있다.</p><h4 id="_2-모든-상태가-app에-집중됨" tabindex="-1"><a class="header-anchor" href="#_2-모든-상태가-app에-집중됨" aria-hidden="true">#</a> 2) 모든 상태가 App에 집중됨</h4><p>4단계에서 작성한 App 컴포넌트를 다시 살펴보자.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// step4의 App.tsx</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 🚨 모든 상태가 App 컴포넌트에 집중됨</span>
  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token function">useProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> carts <span class="token operator">=</span> <span class="token function">useCarts</span><span class="token punctuation">(</span>products<span class="token punctuation">.</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> selection <span class="token operator">=</span> carts<span class="token punctuation">.</span>selectedItems<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container mx-auto py-20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-3xl font-bold mb-8 text-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">쇼핑몰</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductControls</span></span>
            <span class="token attr-name">onInputEnterKeyDown</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>searchKey<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
              products<span class="token punctuation">.</span><span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> searchKey <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span></span>
            <span class="token attr-name">onOrderChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>orderBy<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> products<span class="token punctuation">.</span><span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> orderBy <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
            <span class="token attr-name">onSortChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>sortBy<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> products<span class="token punctuation">.</span><span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> sortBy <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
          <span class="token punctuation">/&gt;</span></span><span class="token plain-text">

          </span><span class="token punctuation">{</span><span class="token comment">/* 상품 목록 렌더링 */</span><span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product-list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token punctuation">{</span>products<span class="token punctuation">.</span>filteredItems<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductItem</span></span>
                <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>
                <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>product<span class="token punctuation">}</span></span>
                <span class="token attr-name">onCartAddClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>add<span class="token punctuation">}</span></span>
              <span class="token punctuation">/&gt;</span></span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-6 rounded-lg shadow w-[400px]<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-2xl font-bold mb-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">장바구니</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

          </span><span class="token punctuation">{</span><span class="token comment">/* 장바구니 아이템 렌더링 */</span><span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cart-items<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>itemsWithProduct<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>cartItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartItem</span></span>
                <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>cartItem<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>
                <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>cartItem<span class="token punctuation">}</span></span>
                <span class="token attr-name">onIncrementClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> carts<span class="token punctuation">.</span><span class="token function">incrementQuantity</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
                <span class="token attr-name">onDecrementClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> carts<span class="token punctuation">.</span><span class="token function">incrementQuantity</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
                <span class="token attr-name">onRemoveClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>remove<span class="token punctuation">}</span></span>
                <span class="token attr-name">onSelect</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>toggleSelect<span class="token punctuation">}</span></span>
              <span class="token punctuation">/&gt;</span></span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartSummary</span></span>
            <span class="token attr-name">totalPrice</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>totalPrice<span class="token punctuation">}</span></span>
            <span class="token attr-name">selection</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>selection<span class="token punctuation">}</span></span>
            <span class="token attr-name">onRemoveSelectedClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>removeSelected<span class="token punctuation">}</span></span>
            <span class="token attr-name">onClearCartClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>clear<span class="token punctuation">}</span></span>
          <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 장바구니에 상품 하나를 추가하는 경우, 모든 컴포넌트에 렌더링이 전파됨</span>
<span class="token keyword">const</span> <span class="token function-variable function">addToCart</span> <span class="token operator">=</span> <span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>productId<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 이 함수가 실행되면...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 📈 렌더링 과정:</span>
<span class="token comment">// 1. App 컴포넌트 리렌더링</span>
<span class="token comment">// 2. ProductControls 리렌더링 (상품과 무관함에도)</span>
<span class="token comment">// 3. 모든 ProductItem 컴포넌트 리렌더링 (변경되지 않았음에도)</span>
<span class="token comment">// 4. 모든 CartItem 컴포넌트 리렌더링</span>
<span class="token comment">// 5. CartSummary 리렌더링</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://www.plantuml.com/plantuml/svg/fLLVIzjG57-_d-BClMomZQ4Kn8TX6bhOmq0eU_CbQo-ksDvqIJhOMyKEYd-mrLQBIxGERPtqeTegFhWlqyVSM-P7sBb9QcithL3oa73Fx_p-dEIGUTFI32kRJf5drcUQff19QKb6pEKaosY6bePFMdnvoT2pBA7gATs0vr55NaC8atx9KXQd7wXfQajKIIMN6CGfiwX124AiP3oPqPW5KxU7fMFuQ59Z2ZJJUnYjRvs1aibuPRoZM3GIYeH6KULDM33qH3PkgJgp33rbUXqBgco8paJUZZRirFiDxosQ1iM7Aq-4Xtru-8bmDJ0p_H3-npQeU39aHKKhaTbeA3Bx6DRteOOVmcwtF6micqvhnZSV74CJCv5GD4I8d3UyVYS7EmUtXxldVwwtG1oSy5RPlMpozOBOAu9ONUbj5q1SbTrMZZ3Teg1_nJwlgRjVaptyx9Jlr3pegeqm47jDzxe5eb4InoLUF5raSVHXlj4IYHUPO3A9buJ8LpemKCv3pD9GWBTpxiNlKJ7CSmAYbXSN7U3r9gzjyCqoRwo0MBV5GUcERK4Do8P1GsIotdKsWcHk-mPui-DsShtAAGRcM_b5Te-UjsonwWpebV_G0mmBABw07uCNgwA18wciYKfLE1jFqWYFYH2UM46T7ZUbwKarLELn2Ldlsj_n_HsBcisFREXLycA_tAlOzrlk2CUCHPruB6fiZ48iiDnnUfLVRZiVQ0dx1lqlieS231Zaqhr27eAVyn5-UTSONTIASwIR-_dl8g4jRmczHV8WajjjjuLJxKixdM0hF6HrfRTxufDT5ORi31BZj0lLVd095FbplYPN2rT05d2XsvVYu0ZFGTGTkVUK9K1c86GU7_7ly1S0" alt="uml diagram"><p>현재 구조에서는 상태가 변경될 때마다 불필요한 렌더링이 발생한다.</p><ul><li><code>products</code>, <code>carts</code>, <code>selection</code> 등 모든 상태가 App 컴포넌트에 선언되었다.</li><li>즉, <strong>상태가 변경될 때마다 App 전체가 리렌더링의 시작점</strong>이 되고 있다. cart를 변경해도 product에 영향이 가고, product를 변경해도 cart에 영향이 간다.</li><li>어떤 함수를 실행하든, 전체적인 렌더링이 발생한다.</li></ul><h4 id="_3-react-memo를-사용한-해결-시도와-한계" tabindex="-1"><a class="header-anchor" href="#_3-react-memo를-사용한-해결-시도와-한계" aria-hidden="true">#</a> 3) React.memo를 사용한 해결 시도와 한계</h4><p>성능 문제를 해결하기 위해 <code>React.memo</code>를 사용할 수도 있다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// memo를 적용한 ProductItem</span>
<span class="token keyword">const</span> ProductItem <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">ProductItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token punctuation">,</span>
  name<span class="token punctuation">,</span>
  price<span class="token punctuation">,</span>
  image<span class="token punctuation">,</span>
  quantity<span class="token punctuation">,</span>
  onCartAddClick<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> Product <span class="token operator">&amp;</span> <span class="token punctuation">{</span> <span class="token function-variable function">onCartAddClick</span><span class="token operator">:</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ProductItem </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 렌더링</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-4 rounded-lg shadow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">onCartAddClick</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        장바구니 담기
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>하지만 여전히 문제가 발생한다</strong></p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// App에서 렌더링할 때마다 새로운 함수가 생성됨</span>
<span class="token punctuation">{</span>products<span class="token punctuation">.</span>filteredItems<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductItem</span></span>
    <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>
    <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>product<span class="token punctuation">}</span></span>
    <span class="token attr-name">onCartAddClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>add<span class="token punctuation">}</span></span> <span class="token comment">// 🚨 이 함수가 매번 새로 생성됨</span>
  <span class="token punctuation">/&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>carts.add</code>가 매번 새로운 참조로 생성되기 때문에 <code>memo</code>가 제대로 동작하지 않는다. 이 문제를 해결하려면 <code>useMemo</code>와 <code>useCallback</code>을 사용해야 한다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token function">useProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> carts <span class="token operator">=</span> <span class="token function">useCarts</span><span class="token punctuation">(</span>products<span class="token punctuation">.</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 🔧 함수들을 메모화해야 함</span>
  <span class="token keyword">const</span> handleAddToCart <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    carts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>carts<span class="token punctuation">.</span>add<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> handleIncrementQuantity <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    carts<span class="token punctuation">.</span><span class="token function">incrementQuantity</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> quantity<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>carts<span class="token punctuation">.</span>incrementQuantity<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> handleRemoveFromCart <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    carts<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>carts<span class="token punctuation">.</span>remove<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 🔧 계산된 값들도 메모화해야 함</span>
  <span class="token keyword">const</span> selection <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    carts<span class="token punctuation">.</span>selectedItems<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>carts<span class="token punctuation">.</span>selectedItems<span class="token punctuation">.</span>length<span class="token punctuation">]</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> productControls <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductControls</span></span>
      <span class="token attr-name">onInputEnterKeyDown</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>searchKey<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        products<span class="token punctuation">.</span><span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> searchKey <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>products<span class="token punctuation">.</span>changeOptions<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
      <span class="token attr-name">onOrderChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>orderBy<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        products<span class="token punctuation">.</span><span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> orderBy <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>products<span class="token punctuation">.</span>changeOptions<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
      <span class="token attr-name">onSortChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sortBy<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        products<span class="token punctuation">.</span><span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> sortBy <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>products<span class="token punctuation">.</span>changeOptions<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">/&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>products<span class="token punctuation">.</span>changeOptions<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 🔧 상품 목록도 메모화</span>
  <span class="token keyword">const</span> productList <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product-list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>products<span class="token punctuation">.</span>filteredItems<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductItem</span></span>
          <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>
          <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>product<span class="token punctuation">}</span></span>
          <span class="token attr-name">onCartAddClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleAddToCart<span class="token punctuation">}</span></span>
        <span class="token punctuation">/&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>products<span class="token punctuation">.</span>filteredItems<span class="token punctuation">,</span> handleAddToCart<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container mx-auto py-20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-3xl font-bold mb-8 text-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">쇼핑몰</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span>productControls<span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token punctuation">{</span>productList<span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://www.plantuml.com/plantuml/svg/pLRFRnf75BxFN_7iN02bgBQL2n9HB6ea7o9PwR7qiDdTECWmIzd5XqQHS4ei6ji2sPj043XGOKCYAcqmTh6K_3C-xWng_eI-cLtYnOxhImyLXvrzyxqVttlVFl70j9IyLSXco9prLC_gaCieQKhCZJJDANab2uyLTMCzRnIebZ0oHXxk99V5Bu0mzLyAEbNrXxffAklwSYQzJY6ZFx48GO2LLjCvXLem_-LTvGCivtBpe9ZYYQ6IA_TMxbr57Hp3MjxG2ggrQkdP50rbzQm1lBt56-_3qdbjLVWcbrQ-l-fhxy4ZNL6jgF2Hs8V2-SxAKd8n-GCXyJWiSASFVAV9AgLO0EmdW7YS457ST_T5ZJ70c2NuqL8i7TX9qHr-XX0_F6AExPuEs4uP-9djEiNmr6TjDGQvl94p8GxFKXGWhSLWVc7-hZXJ9QlZ6-iTiRCjpsJG139OrhH49grkn20IuR-LMQV96oEOlExpSZqIIT7dX21d32_OY9gwjf-5dPVSqohmuMYoDI3Km3ADJJqlWGI3jKQyNVAncoPS1fUcI8HSD5zEQqJkSV6KjjbQlIl_XLoqTgyL_gH0rGMOGrWa8iwB61iBS8UEU_8f1knumDgxRCzclIqaLk8DUmuHEjL054s8d9FVGDdp6G--qvsy-Jt0Jy146N9qaqOVam2lRVFMRefwVSEf0EjrsR3iiyP7YvS-icfVwc0ng8E2gIUKJ4Q8tP_ejuJGcyL9mQIeQb3JWgSArJ8wzWC77q25n913QIqCyVkWOiVCgA9fmY37_zDNqyyf6fvDUD5e_psk06_LUMU4XGCRZ7cx2SnfkiC1vfsw8eD_PReKPCe-zDb1szSMiFSs6YPlxHlfYhc8a3BR9NvAM_G__Qkk9UHrVEhXqPQaGyy0QunTaeVdjtE_tkpXYBV6_cnkwtaq6WtFOXvXJPlwhR1LgkPn2U8kkOua0VLXZUJBk_qZr3exEUM77J6UIULF78tuf8f_pBQPrwepP3pzIrnWkex3QoDmHqLKFdXXFSXE5sE86R3pDclssR4JSBlOtWSsBBb_ZRsyNmVA3wkYQRMgbCTvIImth0-b4VZg_hEjnIflUUlJv7LpgYpkZ7d7-JykBxp_zl8IC7cwSN6nix8tknjNbuW-kxbUTISlJg-8vovYYMo4JCGwxHZsROH7tiAjLQtpNf7rTb5slfpuPviTDE5IRFouXH-2l7ETffZhOTLN2XgAxDMHrDJsFcx4gyAeuweeJMfTZEXTxTd0NjH5Qh-8Zo-d6hra-G2F-3_X7m00" alt="uml diagram"><ul><li>코드가 복잡해지고 <strong>가독성이 떨어질 수 있다.</strong></li><li><strong>의존성 배열 관리</strong>가 어렵다. 꼼꼼하게 메모이제이션을 한다고 해도 <strong>놓치는 구간</strong>이 분명 생길 수 있다.</li><li>실수로 <strong>빠뜨린 의존성이 있으면 버그</strong> 발생할 수 있다.</li><li><strong>메모화 자체에도 비용</strong>이 들어간다.</li></ul><h4 id="_4-상태-분산-시의-문제" tabindex="-1"><a class="header-anchor" href="#_4-상태-분산-시의-문제" aria-hidden="true">#</a> 4) 상태 분산 시의 문제</h4><p>다른 접근 방법으로 상태를 작은 단위로 나누어 관리해보자.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 🔧 상품 상태를 별도 컴포넌트로 분리</span>
<span class="token keyword">function</span> <span class="token function">ProductSection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token function">useProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductControls</span></span> <span class="token attr-name">products</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>products<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductList</span></span> <span class="token attr-name">products</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>products<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 🔧 장바구니 상태를 별도 컴포넌트로 분리</span>
<span class="token keyword">function</span> <span class="token function">CartSection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> carts <span class="token operator">=</span> <span class="token function">useCarts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-6 rounded-lg shadow w-[400px]<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-2xl font-bold mb-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">장바구니</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartItemList</span></span> <span class="token attr-name">carts</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartSummary</span></span> <span class="token attr-name">carts</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 간소화된 App</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container mx-auto py-20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-3xl font-bold mb-8 text-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">쇼핑몰</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductSection</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartSection</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>상품과 장바구니 간의 상호작용이 어려워진다.</li><li>상품 재고와 장바구니 수량 체크 같은 도메인 로직이 분산된다.</li><li>전체적인 상태의 일관성 관리가 복잡해진다.</li></ul><h3 id="_2-상태관리-라이브러리의-필요성" tabindex="-1"><a class="header-anchor" href="#_2-상태관리-라이브러리의-필요성" aria-hidden="true">#</a> (2) 상태관리 라이브러리의 필요성</h3><p>앞서 분석한 문제들을 해결하기 위해 <strong>상태관리 라이브러리</strong>를 도입해보자. 보통 &#39;전역 상태 관리&#39;를 위해 Redux나 Zustand를 사용한다고 생각하지만, 실제로는 &#39;전역 상태 관리&#39;라는 키워드에서 중요한건 <strong>&#39;전역&#39;이 아닌 <u>&#39;상태 관리&#39;</u> 이다.</strong></p><h4 id="_1-관심사의-집중화" tabindex="-1"><a class="header-anchor" href="#_1-관심사의-집중화" aria-hidden="true">#</a> 1) 관심사의 집중화</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ✅ 상태와 도메인 로직이 하나의 관심사로 묶임</span>
<span class="token keyword">const</span> useStore <span class="token operator">=</span> <span class="token generic-function"><span class="token function">create</span><span class="token generic class-name"><span class="token operator">&lt;</span>StoreState<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>set<span class="token punctuation">,</span> get<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 상태</span>
  products<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  carts<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 계산된 값 (getters)</span>
  <span class="token function-variable function">getFilteredProducts</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> products<span class="token punctuation">,</span> productOptions <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> productUtils<span class="token punctuation">.</span><span class="token function">getFilteredItems</span><span class="token punctuation">(</span>products<span class="token punctuation">,</span> productOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 비즈니스 로직 (actions)</span>
  <span class="token function-variable function">addToCart</span><span class="token operator">:</span> <span class="token punctuation">(</span>productId<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> products<span class="token punctuation">,</span> carts <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> updatedCarts <span class="token operator">=</span> cartService<span class="token punctuation">.</span><span class="token function">addToCart</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> products<span class="token punctuation">,</span> productId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span> carts<span class="token operator">:</span> updatedCarts <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-선택적-구독을-통한-성능-최적화" tabindex="-1"><a class="header-anchor" href="#_2-선택적-구독을-통한-성능-최적화" aria-hidden="true">#</a> 2) 선택적 구독을 통한 성능 최적화</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ✅ 컴포넌트가 필요한 데이터만 구독</span>
<span class="token keyword">function</span> <span class="token function">ProductItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 이 상품의 정보만 구독 (다른 상품이 변경되어도 리렌더링 안됨)</span>
  <span class="token keyword">const</span> product <span class="token operator">=</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>products<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> addToCart <span class="token operator">=</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>addToCart<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// addToCart 함수는 참조가 안정적임 (매번 새로 생성되지 않음)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">addToCart</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">장바구니 담기</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">CartSummary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 총 가격만 구독 (개별 상품 정보 변경시 리렌더링 안됨)</span>
  <span class="token keyword">const</span> totalPrice <span class="token operator">=</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span><span class="token function">getCartTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">총 합계: </span><span class="token punctuation">{</span>totalPrice<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">원</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-자동화된-참조-안정성" tabindex="-1"><a class="header-anchor" href="#_3-자동화된-참조-안정성" aria-hidden="true">#</a> 3) 자동화된 참조 안정성</h4><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ✅ 액션 함수들이 자동으로 참조 안정성을 가짐</span>
<span class="token keyword">const</span> <span class="token function-variable function">useCartActions</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  add<span class="token operator">:</span> state<span class="token punctuation">.</span>addToCart<span class="token punctuation">,</span>
  remove<span class="token operator">:</span> state<span class="token punctuation">.</span>removeFromCart<span class="token punctuation">,</span>
  clear<span class="token operator">:</span> state<span class="token punctuation">.</span>clearCart<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// memo 컴포넌트에서 안전하게 사용 가능</span>
<span class="token keyword">const</span> CartItem <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> actions <span class="token operator">=</span> <span class="token function">useCartActions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 참조가 안정적</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> actions<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">삭제</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-zustand를-활용한-문제-해결" tabindex="-1"><a class="header-anchor" href="#_3-zustand를-활용한-문제-해결" aria-hidden="true">#</a> (3) Zustand를 활용한 문제 해결</h3><p>본격적으로 zustand를 이용하여 기존 코드를 개선해보자.</p><h4 id="_1-step5-폴더-구성하기" tabindex="-1"><a class="header-anchor" href="#_1-step5-폴더-구성하기" aria-hidden="true">#</a> 1) step5 폴더 구성하기</h4><p>앞선 과정처럼 step4를 복사해서 step5를 구성해보자.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>./src/step5
├── domains
│   ├── __tests__
│   │   ├── cartService.test.ts
│   │   ├── cartUtils.test.ts
│   │   └── productUtils.test.ts
│   ├── cartService.ts
│   ├── cartUtils.ts
│   ├── constants.ts
│   ├── productUtils.ts
│   └── types.ts
├── hooks
│   ├── useCarts.ts
│   └── useProducts.ts
├── App.tsx
├── components.tsx
├── dummies.ts
└── main.tsx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-zustand-설치" tabindex="-1"><a class="header-anchor" href="#_2-zustand-설치" aria-hidden="true">#</a> 2) Zustand 설치</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">pnpm</span> <span class="token function">add</span> zustand
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_3-통합-스토어-구성" tabindex="-1"><a class="header-anchor" href="#_3-통합-스토어-구성" aria-hidden="true">#</a> 3) 통합 스토어 구성</h4><p>기존의 도메인 로직을 그대로 활용하여 hooks/useStore.ts 파일을 하나 만들고 Zustand 스토어를 구성한다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// hooks/useStore.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> create <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;zustand&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span>
  Carts<span class="token punctuation">,</span>
  CartWithProduct<span class="token punctuation">,</span>
  Product<span class="token punctuation">,</span>
  Products<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../domains/types&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> cartUtils <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../domains/cartUtils&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> cartService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../domains/cartService&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> productUtils <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../domains/productUtils&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  <span class="token constant">INITIAL_PRODUCT_OPTIONS</span><span class="token punctuation">,</span>
  <span class="token constant">INITIAL_PRODUCTS</span><span class="token punctuation">,</span>
  <span class="token keyword">type</span> <span class="token class-name">ProductOptions</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../domains/constants&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useShallow <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;zustand/react/shallow&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 유틸리티 함수: 배열을 맵으로 변환</span>
<span class="token keyword">const</span> toMap <span class="token operator">=</span> <span class="token punctuation">(</span>arr<span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> Products <span class="token operator">=&gt;</span>
  arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>acc<span class="token punctuation">,</span> <span class="token punctuation">[</span>product<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token operator">:</span> product <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">StoreState</span> <span class="token punctuation">{</span>
  <span class="token comment">// Products 상태</span>
  products<span class="token operator">:</span> Products<span class="token punctuation">;</span>
  productOptions<span class="token operator">:</span> ProductOptions<span class="token punctuation">;</span>

  <span class="token comment">// Carts 상태</span>
  carts<span class="token operator">:</span> Carts<span class="token punctuation">;</span>

  <span class="token comment">// Computed values (getters)</span>
  <span class="token function-variable function">getFilteredProducts</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function-variable function">getCartTotalPrice</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token function-variable function">getCartWithProduct</span><span class="token operator">:</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CartWithProduct<span class="token punctuation">;</span>
  <span class="token function-variable function">getCartsWithProduct</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CartWithProduct<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function-variable function">getSelectedCartItems</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CartWithProduct<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function-variable function">isAllCartsSelected</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>

  <span class="token comment">// Products 액션</span>
  <span class="token function-variable function">changeProductOptions</span><span class="token operator">:</span> <span class="token punctuation">(</span>newOptions<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>ProductOptions<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

  <span class="token comment">// Carts 액션</span>
  <span class="token function-variable function">addToCart</span><span class="token operator">:</span> <span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token function-variable function">incrementCartQuantity</span><span class="token operator">:</span> <span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> quantity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token function-variable function">removeFromCart</span><span class="token operator">:</span> <span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token function-variable function">removeSelectedCarts</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token function-variable function">toggleCartSelect</span><span class="token operator">:</span> <span class="token punctuation">(</span>productId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token function-variable function">toggleAllCartsSelected</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token function-variable function">clearCart</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> useStore <span class="token operator">=</span> <span class="token generic-function"><span class="token function">create</span><span class="token generic class-name"><span class="token operator">&lt;</span>StoreState<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>set<span class="token punctuation">,</span> get<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  products<span class="token operator">:</span> <span class="token function">toMap</span><span class="token punctuation">(</span><span class="token constant">INITIAL_PRODUCTS</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  productOptions<span class="token operator">:</span> <span class="token constant">INITIAL_PRODUCT_OPTIONS</span><span class="token punctuation">,</span>
  carts<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">getFilteredProducts</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> products<span class="token punctuation">,</span> productOptions <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> productUtils<span class="token punctuation">.</span><span class="token function">getFilteredItems</span><span class="token punctuation">(</span>products<span class="token punctuation">,</span> productOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">getCartTotalPrice</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> carts<span class="token punctuation">,</span> products <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> cartService<span class="token punctuation">.</span><span class="token function">getTotalCartPrice</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> products<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">getCartWithProduct</span><span class="token operator">:</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> carts<span class="token punctuation">,</span> products <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> cartService<span class="token punctuation">.</span><span class="token function">getCartWithProduct</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> products<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">getCartsWithProduct</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> carts<span class="token punctuation">,</span> products <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> cartService<span class="token punctuation">.</span><span class="token function">getCartsWithProduct</span><span class="token punctuation">(</span>carts<span class="token punctuation">,</span> products<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">getSelectedCartItems</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">getCartsWithProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>selected<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">isAllCartsSelected</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> cartItems <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCartsWithProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> selectedItems <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSelectedCartItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      selectedItems<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> selectedItems<span class="token punctuation">.</span>length <span class="token operator">===</span> cartItems<span class="token punctuation">.</span>length
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">changeProductOptions</span><span class="token operator">:</span> <span class="token punctuation">(</span>newOptions<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> productOptions <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      productOptions<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span>productOptions<span class="token punctuation">,</span> <span class="token operator">...</span>newOptions <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token function-variable function">addToCart</span><span class="token operator">:</span> <span class="token punctuation">(</span>productId<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      carts<span class="token operator">:</span> cartService<span class="token punctuation">.</span><span class="token function">addToCart</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>carts<span class="token punctuation">,</span> state<span class="token punctuation">.</span>products<span class="token punctuation">,</span> productId<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token function-variable function">incrementCartQuantity</span><span class="token operator">:</span> <span class="token punctuation">(</span>productId<span class="token punctuation">,</span> quantity<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      carts<span class="token operator">:</span> cartService<span class="token punctuation">.</span><span class="token function">incrementCartQuantity</span><span class="token punctuation">(</span>
        state<span class="token punctuation">.</span>carts<span class="token punctuation">,</span>
        state<span class="token punctuation">.</span>products<span class="token punctuation">,</span>
        productId<span class="token punctuation">,</span>
        quantity
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token function-variable function">removeFromCart</span><span class="token operator">:</span> <span class="token punctuation">(</span>productId<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      carts<span class="token operator">:</span> cartUtils<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>carts<span class="token punctuation">,</span> productId<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token function-variable function">removeSelectedCarts</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      carts<span class="token operator">:</span> cartUtils<span class="token punctuation">.</span><span class="token function">removeSelected</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>carts<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token function-variable function">toggleCartSelect</span><span class="token operator">:</span> <span class="token punctuation">(</span>productId<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      carts<span class="token operator">:</span> cartUtils<span class="token punctuation">.</span><span class="token function">toggleSelect</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>carts<span class="token punctuation">,</span> productId<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token function-variable function">toggleAllCartsSelected</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      carts<span class="token operator">:</span> cartUtils<span class="token punctuation">.</span><span class="token function">updateAllSelected</span><span class="token punctuation">(</span>
        state<span class="token punctuation">.</span>carts<span class="token punctuation">,</span>
        <span class="token operator">!</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isAllCartsSelected</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token function-variable function">clearCart</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span> carts<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> useShallowStore <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">(callback: (state: StoreState) =&gt; T) =&gt;
  useStore(useShallow(callback));
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-세분화된-훅-구성" tabindex="-1"><a class="header-anchor" href="#_4-세분화된-훅-구성" aria-hidden="true">#</a> 4) 세분화된 훅 구성</h4><p>컴포넌트에서 사용하기 편리하도록 세분화된 훅들을 만든다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// hooks/useProducts.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useShallowStore <span class="token keyword">as</span> useStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./useStore.ts&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useProductOptions</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>productOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useFilteredProducts</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span><span class="token function">getFilteredProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useChangeProductOptions</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>changeProductOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useProduct</span> <span class="token operator">=</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>products<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// hooks/useCarts.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useShallowStore <span class="token keyword">as</span> useStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./useStore.ts&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useCartIds</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>carts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useCartItemWithProduct</span> <span class="token operator">=</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span><span class="token function">getCartWithProduct</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useCartSelection</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span><span class="token function">getSelectedCartItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useCartTotalPrice</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span><span class="token function">getCartTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useCartAllSelected</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span><span class="token function">isAllCartsSelected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useAddToCart</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>addToCart<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useIncrementCartQuantity</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>incrementCartQuantity<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useRemoveFromCart</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>removeFromCart<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useRemoveSelectedCarts</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>removeSelectedCarts<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useToggleCartSelect</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>toggleCartSelect<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useToggleAllCartsSelected</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>toggleAllCartsSelected<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useClearCart</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>clearCart<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">🤔 그런데 왜 여러개의 훅을 구성해야 하는걸까?</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 🚨 하나의 훅이 너무 많은 데이터를 반환</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> products<span class="token punctuation">,</span> carts<span class="token punctuation">,</span> totalPrice<span class="token punctuation">,</span> selectedItems <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 🚨 장바구니 수량만 변경해도 모든 데이터가 변경되어 불필요한 리렌더링 발생</span>
<span class="token keyword">function</span> <span class="token function">CartItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> products<span class="token punctuation">,</span> carts <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>여러 개의 훅을 사용하면 <strong>컴포넌트가 정말 필요한 데이터만 구독</strong>할 수 있다. 예를 들어 ProductItem 컴포넌트는 해당 상품의 데이터만 구독하고, CartSummary 컴포넌트는 총 가격만 구독하면 된다. 이렇게 세분화된 구독은 <strong>불필요한 리렌더링을 막아 성능을 최적화</strong>할 수 있다.</p></div><h4 id="_5-최적화된-컴포넌트" tabindex="-1"><a class="header-anchor" href="#_5-최적화된-컴포넌트" aria-hidden="true">#</a> 5) 최적화된 컴포넌트</h4><p>이제 각 컴포넌트가 필요한 데이터만 구독하도록 개선한다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ✅ ProductItem이 개별 상품 데이터만 구독</span>
<span class="token comment">// id를 통해 다른 값을 store에서 가져올 수 있다.</span>
<span class="token comment">// props가 많을 경우 메모이제이션을 하는게 오히려 어려워진다.</span>
<span class="token keyword">const</span> ProductItem <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> image<span class="token punctuation">,</span> price<span class="token punctuation">,</span> quantity <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useProduct</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> addToCart <span class="token operator">=</span> <span class="token function">useAddToCart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> disabled <span class="token operator">=</span> quantity <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-4 rounded-lg shadow product-item<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">data-product-id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>relative<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span>
          <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>image<span class="token punctuation">}</span></span>
          <span class="token attr-name">alt</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span>
          <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">w-full h-48 object-cover mb-4 rounded </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>disabled <span class="token operator">?</span> <span class="token string">&#39;opacity-50&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span>
        <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>disabled <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 rounded text-white font-bold<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            품절
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-lg font-bold mb-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-gray-600 mb-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>price<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">원</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-sm text-gray-500 mb-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">재고: </span><span class="token punctuation">{</span>quantity<span class="token punctuation">}</span><span class="token plain-text">개</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed text-white py-2 px-4 rounded add-to-cart-btn</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span>
        <span class="token attr-name">data-product-id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span></span>
        <span class="token attr-name">disabled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>disabled<span class="token punctuation">}</span></span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">addToCart</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>disabled <span class="token operator">?</span> <span class="token string">&#39;품절&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;장바구니 담기&#39;</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ProductItem<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">&#39;ProductItem&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// ✅ ProductList는 필터링된 상품 목록만 구독</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">ProductList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// products가 변경되면 렌더링이 된다.</span>
  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token function">useFilteredProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product-list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>products<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductItem</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span> <span class="token attr-name">id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ✅ CartItem이 개별 장바구니 아이템만 구독</span>
<span class="token comment">// ProductItem과 마찬가지로, id만 받아아고 id를 통해 store에 값을 가져올 수 있도록 한다.</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> CartItem <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> selected<span class="token punctuation">,</span> price<span class="token punctuation">,</span> image<span class="token punctuation">,</span> quantity<span class="token punctuation">,</span> subtotal<span class="token punctuation">,</span> name <span class="token punctuation">}</span> <span class="token operator">=</span>
    <span class="token function">useCartItemWithProduct</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> select <span class="token operator">=</span> <span class="token function">useToggleCartSelect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> incrementQuantity <span class="token operator">=</span> <span class="token function">useIncrementCartQuantity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> remove <span class="token operator">=</span> <span class="token function">useRemoveFromCart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cart-item flex items-center gap-3 p-3 border-t<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">data-product-id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cart-item-checkbox<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">data-product-id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span></span>
        <span class="token attr-name">checked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>selected<span class="token punctuation">}</span></span>
        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">select</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
        <span class="token attr-name">readOnly</span>
      <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>image<span class="token punctuation">}</span></span> <span class="token attr-name">alt</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-16 h-16 object-cover rounded<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>font-bold text-sm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-gray-600 text-sm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span>price<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">원 * </span><span class="token punctuation">{</span>quantity<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">개 = </span><span class="token punctuation">{</span>subtotal<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">원
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex items-center gap-2 mt-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>decrease-btn bg-gray-300 text-gray-700 w-6 h-6 rounded text-sm<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">incrementQuantity</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token plain-text">
            -
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>quantity<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>quantity<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>increase-btn bg-gray-300 text-gray-700 w-6 h-6 rounded text-sm<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">incrementQuantity</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token plain-text">
            +
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>remove-btn bg-red-500 text-white px-2 py-1 rounded text-xs ml-2<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">remove</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token plain-text">
            삭제
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ✅ CartCheckboxAll이 allSelected와 toggleAllSelected 를 참조</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">CartCheckboxAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> allSelected <span class="token operator">=</span> <span class="token function">useCartAllSelected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> toggleAllSelected <span class="token operator">=</span> <span class="token function">useToggleAllCartsSelected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-2 mb-2 ml-3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>select-all-cart<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">checked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>allSelected<span class="token punctuation">}</span></span>
        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggleAllSelected<span class="token punctuation">}</span></span>
        <span class="token attr-name">readOnly</span>
      <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ✅ CartItemList이 cart의 ids 배열만 사용.</span>
<span class="token comment">// CartItem 내부에서 id를 토대로 useCartItemWithProduct 훅을 사용하여 필요한 데이터를 가져온다.</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">CartItemList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cartIds <span class="token operator">=</span> <span class="token function">useCartIds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cart-items<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>cartIds<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartCheckboxAll</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token punctuation">{</span>cartIds<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartItem</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span></span> <span class="token attr-name">id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

CartItem<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">&#39;CartItem&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">CartSummary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> totalPrice <span class="token operator">=</span> <span class="token function">useCartTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> selection <span class="token operator">=</span> <span class="token function">useCartSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> removeSelected <span class="token operator">=</span> <span class="token function">useRemoveSelectedCarts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> clear <span class="token operator">=</span> <span class="token function">useClearCart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mt-4 pt-4 border-t<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex justify-between items-center mb-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-lg font-bold<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">총 합계:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>total-price<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-xl font-bold text-blue-600<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span>totalPrice<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">원
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>remove-selected-cart<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">flex-1 bg-orange-500 hover:bg-orange-600 disabled:bg-gray-400 disabled:cursor-not-allowed text-white py-2 px-4 rounded</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span>
          <span class="token attr-name">disabled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token operator">!</span>selection<span class="token punctuation">}</span></span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>removeSelected<span class="token punctuation">}</span></span>
        <span class="token punctuation">&gt;</span></span><span class="token plain-text">
          선택 삭제
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clear-cart<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-1 bg-red-500 text-white py-2 px-4 rounded hover:bg-red-600<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>clear<span class="token punctuation">}</span></span>
        <span class="token punctuation">&gt;</span></span><span class="token plain-text">
          전체 비우기
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">ProductControls</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token function">useProductOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> changeOptions <span class="token operator">=</span> <span class="token function">useChangeProductOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> handleInputEnterKeyDown<span class="token operator">:</span> KeyboardEventHandler<span class="token operator">&lt;</span>HTMLInputElement<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
    e
  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>key <span class="token operator">===</span> <span class="token string">&#39;Enter&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> searchKey<span class="token operator">:</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> handleOrderChange<span class="token operator">:</span> ChangeEventHandler<span class="token operator">&lt;</span>HTMLSelectElement<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> orderBy <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token keyword">as</span> <span class="token string">&#39;asc&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;desc&#39;</span><span class="token punctuation">;</span>
    <span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> orderBy <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> handleSortChange<span class="token operator">:</span> ChangeEventHandler<span class="token operator">&lt;</span>HTMLSelectElement<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> sortBy <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token keyword">as</span> <span class="token string">&#39;price&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;name&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;default&#39;</span><span class="token punctuation">;</span>
    <span class="token function">changeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> sortBy <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-4 rounded-lg shadow mb-6<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex flex-wrap gap-4 items-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token comment">/* 검색 */</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-1 min-w-64<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
            <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search-input<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>상품명으로 검색...<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">onKeyDown</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleInputEnterKeyDown<span class="token punctuation">}</span></span>
          <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

        </span><span class="token punctuation">{</span><span class="token comment">/* 정렬 */</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span>
            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sort-select<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSortChange<span class="token punctuation">}</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span>
              <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>default<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">defaultChecked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>options<span class="token punctuation">.</span>sortBy <span class="token operator">===</span> <span class="token string">&#39;default&#39;</span><span class="token punctuation">}</span></span>
            <span class="token punctuation">&gt;</span></span><span class="token plain-text">
              기본순
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defaultChecked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>options<span class="token punctuation">.</span>sortBy <span class="token operator">===</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
              이름순
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>price<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defaultChecked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>options<span class="token punctuation">.</span>sortBy <span class="token operator">===</span> <span class="token string">&#39;price&#39;</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
              가격순
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span>
            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>order-select<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleOrderChange<span class="token punctuation">}</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>asc<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defaultChecked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>options<span class="token punctuation">.</span>orderBy <span class="token operator">===</span> <span class="token string">&#39;asc&#39;</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
              오름차순
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>desc<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defaultChecked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>options<span class="token punctuation">.</span>orderBy <span class="token operator">===</span> <span class="token string">&#39;desc&#39;</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
              내림차순
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ✅ 대폭 간소화된 App 컴포넌트</span>
<span class="token comment">// App 에는 일부로 상태를 만들지 않았다.</span>
<span class="token comment">// App에 상태가 없기 때문에, App은 리렌더링 되지 않는다.</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container mx-auto py-20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-3xl font-bold mb-8 text-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">쇼핑몰</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex gap-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span><span class="token comment">/* ProductControls의 변화가 다른 컴포넌트에 전파되지 않는다. */</span><span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductControls</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductList</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg-white p-6 rounded-lg shadow w-[400px]<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-2xl font-bold mb-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">장바구니</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span><span class="token comment">/* CartItemList, CartSummary 의 변화가 다른 컴포넌트에 전파되지 않는다. */</span><span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartItemList</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartSummary</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/TIL/assets/step5-to-be.85a14317.gif" alt="step5_렌더링개선.gif"></p><p>기존에 작성된 e2e 테스트에 step5 도 넣어준 다음에 검사해보자.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code>test<span class="token punctuation">.</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;두 번째 요구사항에 대한 테스트 &gt; &#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">testSecondAssignmentAtPage</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>page<span class="token operator">:</span> Page<span class="token punctuation">,</span> path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">goto</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://localhost:5173/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/* ... 생략 ... */</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;step3 &gt; &#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> page <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">testSecondAssignmentAtPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token string">&#39;step3&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;step4 &gt; &#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> page <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">testSecondAssignmentAtPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token string">&#39;step4&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;step5 &gt; &#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> page <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">testSecondAssignmentAtPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token string">&#39;step5&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-결과-비교" tabindex="-1"><a class="header-anchor" href="#_4-결과-비교" aria-hidden="true">#</a> (4) 결과 비교</h3><img src="https://www.plantuml.com/plantuml/svg/bLPTQzjc5BxNhpXBRrAlArj3e0WyAcinx68GSCTWv4QrjLJKbbn97lGkMPGIOcTnKwb9EZjrHZxQuJ4lLeR7iZ-JIxslM7_2pgiFItRjp2CN4NgVyvpdFUSvHtvWc99krYfbxYFpiLoHeLgM59KpdYXgLTAb2ZoIYazMTQscbaIjhEbmAo-mlnJ2a9_MPBKeVoKRXhGg2sLbLOMo_9t9SGWmbQ9IbLGJvjw_UN42NnkoFWUI4JoCd-_-0aArkgBEqurrVwC5TFyvRJTk1tWyW5jBz_EBI_V7m-mTMDQrKgreYffgwbhP22AMHHIRpoyiVJeUyF8i3lZIb2iWX71XHdWkXETcX8kHc7lJy3_jWOXlKb94OTfLqzXGXvYRXjth1TX2hLAHz6SXk80Y5fOMyulZu7thdy4kV5j3EwWbA9YQBWSHmHDcMCZVot_1STdi44EjZh_Hffrry2wxP7UJ_QF7FSXcEKxLJ1cqxsKTgyhL33cgnxnIuc5EcBlDiGRlRO40PAT7swvlzSXv8oBYP6Hd32CyEO0Fc789Ksvc9Z5G55Vn6yLy_A6werFIinb7dMcaZiMODrl_nPoxaHdLuXr6k7EpSnTYxeUQAPMNTQKepwDIjmrURysxU3Sn7jj5V-ZIr-_eKHDeUy2gStH8DmzuIEkW-tWQTuJ-OIDZq4Ose_39vzX47jw_UVKxiyY8Vb9tlK4F_7MNdFtAuGGXE70C3rAfz51ZUkU3adAXaP9p75iBeZadVRp1tojg4U76NU7kqngwKZ6VmSTP-2nTXI2MGsiVGoQJ690w3N9sbSbm8H5fjb9kEBsAwk8x1sJRvkXVhh_R9LR3tnwGboTuT--YmQeNigIgDvGi1lUtxM2UqgQDbCUXef12Mq3EkgJJ83isELzVKQzRcq3h9xJJ8iSjyB7lhstVUPjEKuZI95qTJO3smGbEa3EdI2g8QvHZi4o6BTHqUBHjiOfXLvW9sAjNBhNY5g6g9Zt7zyuMQRwTFAXYn3-sac_8XRORhwZNlmBITJrtRN8IOJH9k3idfs0p5oQX7OVqNVG0n3uv22-pZS0fM-SEsznHCb8_8QU3z797_qovLuGTlnuzNBlfNhX1mbJ9af_2dmRSI8uhmBle1VNyq_8kcsFxcOtudU5S_VWRcwlB5WwLVsW7SnIdnfpNQpyp__0mydc6w-TxaqG6y34Jy94-tnawQaeqTet5Jopvx2nfZhXY_vyW-JhpqNYberZ3qf73aEZ3oqyOvubnyLxpdKjQxsOo_722M-3r-y6AwZZ-eUCVROr69jr-W8_uO-vV" alt="uml diagram"><ul><li><p>AS-IS</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 🚨 모든 상태가 App에 집중</span>
<span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token function">useProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> carts <span class="token operator">=</span> <span class="token function">useCarts</span><span class="token punctuation">(</span>products<span class="token punctuation">.</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 🚨 복잡한 prop drilling</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductItem</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>product<span class="token punctuation">}</span></span> <span class="token attr-name">onCartAddClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>carts<span class="token punctuation">.</span>add<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>

<span class="token comment">// 🚨 불필요한 렌더링 발생</span>
<span class="token comment">// 장바구니 변경 → 모든 상품 아이템 리렌더링</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>TO-BE</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// ✅ 컴포넌트가 필요한 데이터만 구독</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> price <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useProduct</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> addToCart <span class="token operator">=</span> <span class="token function">useAddToCart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ✅ 간단한 props</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductItem</span></span> <span class="token attr-name">id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>

<span class="token comment">// ✅ 선택적 렌더링</span>
<span class="token comment">// 장바구니 변경 → 관련된 컴포넌트만 리렌더링</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_5-5단계-데모" tabindex="-1"><a class="header-anchor" href="#_5-5단계-데모" aria-hidden="true">#</a> (5) 5단계 데모</h3><ul><li>링크: <a href="https://junilhwang.github.io/simple-clean-code-project/step5.html" target="_blank" rel="noopener noreferrer">https://junilhwang.github.io/simple-clean-code-project/step5.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>전체코드: <a href="https://github.com/JunilHwang/simple-clean-code-project/tree/main/src/step5" target="_blank" rel="noopener noreferrer">https://github.com/JunilHwang/simple-clean-code-project/tree/main/src/step5<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><div class="iframe-container"><iframe src="https://junilhwang.github.io/simple-clean-code-project/step5.html"></iframe></div><h3 id="_6-summary-1" tabindex="-1"><a class="header-anchor" href="#_6-summary-1" aria-hidden="true">#</a> (6) Summary</h3><ul><li><strong>상태 집중화 문제</strong>: Zustand를 통한 관심사별 상태 분리</li><li><strong>불필요한 렌더링</strong>: 선택적 구독으로 필요한 부분만 렌더링</li><li><strong>복잡한 메모화</strong>: 자동화된 참조 안정성으로 <code>useMemo</code>/<code>useCallback</code> 제거</li><li><strong>Prop Drilling</strong>: 컴포넌트가 필요한 데이터를 직접 구독</li><li><strong>관심사 분산</strong>: 도메인 로직이 스토어에 집중화</li></ul><p>상태관리 라이브러리는 &quot;전역 상태&quot;를 위해서가 아니라 <strong>성능 최적화와 관심사 집중화</strong>를 위해 사용한다.</p><div class="custom-container tip"><p class="custom-container-title">🤔 상태관리 라이브러리 대신에 Context를 사용하면 어떨까?</p><ul><li><p>React Context를 사용하는 방법도 고려는 해볼 수 있다. 하지만 Context를 상태관리를 위해 사용하는 것은 적절하지 않다.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// Context 사용 예시</span>
<span class="token keyword">const</span> StoreContext <span class="token operator">=</span> <span class="token generic-function"><span class="token function">createContext</span><span class="token generic class-name"><span class="token operator">&lt;</span>StoreType <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">StoreProvider</span><span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> children<span class="token operator">:</span> ReactNode <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>products<span class="token punctuation">,</span> setProducts<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token comment">/* ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>carts<span class="token punctuation">,</span> setCarts<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token comment">/* ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    products<span class="token punctuation">,</span>
    carts<span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">addToCart</span><span class="token operator">:</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// ... 다른 액션들</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>products<span class="token punctuation">,</span> carts<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">StoreContext.Provider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">StoreContext.Provider</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>StoreContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;useStore must be used within StoreProvider&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> context<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Context value가 변경되면 context를 사용하는 모든 구독자가 리렌더링 된다.</p></li></ul><img src="https://www.plantuml.com/plantuml/svg/ZLLDRn916BxFhtYj5sYmCJ4afWb6s43YmQG9UX8FAuoL2BDrTwcQfWcDMuCj3RMbjLMmQFgbuR1jqJIn_XcFEqFiJ_2TtQLT22M60pExp_D-FE_7tZLCLJTBnGAvPZwZHGep1JNFYF4ypsPKNIt24pNxV5hNIYodQ0LDX-kfkFm540PzKQ8iI-zJmr2dQRoGdsPGe4zDGX1WvhFv6PMPC7Q-ytuN7XfK7mFLS0-3xslV8MrgEftIjTbypWVsBkWvbOmceuEa-eg4v4fPKz6OgMi5mwCfaf2wbRmvI5ZVxn7kcRG8SGyU_qzumeCdhe9_MWC5dmHCAsWwUJiLJTuUXVNiAechi6ksYqsNYaLLV-s1qnZ4hMGq5IKa5WE-V2YQPo1LeAzCS7wqnHSROZ52c6PIq6PHmoabWZJ2ln_ozHQ8NvrkhSsjQdVfrB7BK3AegtyepByq2AzjextkHYDeajSM2Sbgp331a528mHoPyVGn9c5kOc9YFaAo6EdbJSsQUMJuTp9FACk1ZCaBktqgMWqGRnQwszycGNpUutPTUbgkWAXiyPrtm4_Apl5lDnNPDd3Z3eew2USxcqT_Jsj3AMA_YHaHr1x1lHQQ13MNUw197KDZyR4m8HVDrOV2fhBSWDuqVDyPPb1JyemGeo_TGpZ3CWmLkq-BMYWKXjWT2Crb641FZGYuCaJ0pp_3viCHU3Jm-d6uhpv-30GBlWVZuywHpQlbO0rcrKA9Od0LB17-DOLrD3xk2SuFgdwuV7LBVAY8Wp8-8g9bYUEENox7Rk955hlF15yz35IbJnN5rQD-4O1V3B5HvVjd1CVi4cG1ts_pLfMlrFd1GeRzQLOlrBZWVNYBeV6bEb-nUSqQS1OVvGo0JCK3i67kPDNMAX07qThW9vt_yveOdM8Y01hXCo6sKTLj2_N6fkuu7LctOVwKaLdwFQjSaMDZ4SJoBawCB5vtmn8Vwx8zWgW1RwEpKn81qD3iWjFbvZWwkVHeT-a0Q6XodIOsALA--KpHEBjCrTqOph7jd9mDR3Qv6DpTThxpyH0dftyRYkQMlsXmMFwKlmwCKo_6PHJIMutUgXEVL_kLbLHXdNBRdKaFXAtM49lOQZyh63XVsdDHU0jKfsS0b_GkRYZWTWC7ppTtX1mqWYQtC8IsOoy4Pl4k7l7p_0y0" alt="uml diagram"><ul><li><strong>성능 최적화를 위해서는 여러 개의 Context로 분리</strong>해야 하는데, 이는 <strong>관리 복잡도를 증가</strong>시키기 때문에 세밀한 구독 제어가 어렵다. 가령, products만 구독하고 싶어도, <strong>의도하지 않게 전체 context를 구독</strong>해야 할 수 있다.<div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// Context를 여러 개로 분리해야 함</span>
<span class="token keyword">const</span> ProductContext <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token comment">/* ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> CartContext <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token comment">/* ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> UIContext <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token comment">/* ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 하지만 이렇게 하면 의존성 관리가 복잡해짐</span>
<span class="token keyword">function</span> <span class="token function">SomeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>ProductContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> carts <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>CartContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// products와 carts 간의 상호작용을 어떻게 처리할까?</span>
  <span class="token keyword">const</span> canAddToCart <span class="token operator">=</span> products<span class="token punctuation">.</span>items<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity <span class="token operator">&gt;</span> carts<span class="token punctuation">.</span>items<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token operator">?.</span>quantity<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><img src="https://www.plantuml.com/plantuml/svg/hLRHJXj757sVhxYbBu0Qkor2YX3GM1QMUAZaIlLJwODhBtGLM3lUTTIgYcJALYBWr43Mn80DTcMWL4wriKragUHdyhWpg_89lJCxQ--QKFMX0cHhviwPUyyzzmoFT2DTC8eRw-GZutjbGu7yUbhLYFvOrVBfGde3lajd7gyLSaKj6y-jvmhmSIB6Vm8HklAag6WPvKj5rzDhIcnTNTDWNLar2C40Gyse-RHcmCJjsNuRKhfIc82qBhwCxx_SWMGXborc3FnugcPbQ3A9joOICqkVZXyuEO0uheIYunYzz30nk_HmFFhNaxy75KWjXy9J77ncQJOnUm_uig5iGCo3ZWsXoS82i5STUjQ1U4upb1yCe6zDUj41vxh3MZOiB12YvGm5Sa-L0fRm2Tv4cFc6xfm3kwwpvgPxPD7p6s1rqwtsnr3coFlIRpuP_jO3O5kRxi4sq1SsQ_HTqnPHFCb0oEavjIrCWku60W54Q6fv59XQ5d1RTKBSQerTbkXb6LUsQQlEZlj0EmFMh0Erwsoh4Ob4YA9bWHSaIfUx7E3eQWulxJYz9hX7LTOOW7jYXjDWRot7BWbAUDlXmI9IEGUtPuTlU4V-q-aWc_4OkJrhMp0zJNlNxBJbLZ6LHesr-aZmz3GX8KJMC2N9SoIJqtG3yXwlEYn0KLSa9PDXjgTaR0RP7GiC43v52DtVyvl7sqahHsotpbxjSI7GoY_WLarsR0NeGnKX0Saa9m0LBtigKsRDAktr0K-mxck2ofTS-Ib7L9IZ_esQ_JRof8X2LOqVyKpTwLtxm741ZE9rQoQ2Zd6vNQDdpttu-11UL3d2_k9USD6sop_zT9sUoNwsLpHr5IPbYb_XeKK1YD-cuASL3I0QzJM0VpW1AzgpOBhfRFRh76TrSY8sCGLij-qUFlUp4-LOff2vL2pGNidflhiZYODpb8Iyo5CeVTdcUlWi0dItpThxmp7pcZD7080TzkdE7h0_tk6iI6YwL-FB5HDm66cpJ5zOz7AJV1uPwGnOjy_rAYLuP96PI63WK0VEmCPbWTziivCIlomqHNwg0e53yWaPDGNBjhooX-OWaWDMBTEBcr1Bh72c84GguwV2JaJUDyh8a--2WBImxXMdQNxCVHSnu_cWmV85N1fPgBU0Ix5y7g9oEnhUdu-68UQZTwuXZhs9lyWj-8lqSXjRXXMOl0jElyIzzSuiZGdW-7SkWB_wRgL3pRAx4-WEhs-rg6KCDQSDVNqIzKcuECDE7fxS_zyplAYY6WuPcZFs2tCQMPitPC2D6JNeNw75iba4-3TZM2JtpZLv5ZPqfslJLdFirU9cBTujJp4VVEzupp19p54Oh_V0oU7RiN2hpw7tv0FZlMkocrw5lBrkvJMxQFXlNb2M4afitHazYJCQC14LQ3-gvyE3Bo97m-hOfh2Mse2TxhFZAvaQuPxIufKtJRxgkO-VVUC6JzD16JaPQHD96F7w2B_YlrR_0000" alt="uml diagram"></div><h2 id="학습-과정-정리" tabindex="-1"><a class="header-anchor" href="#학습-과정-정리" aria-hidden="true">#</a> 학습 과정 정리</h2><p>클린코드는 코딩 스타일이나 네이밍 규칙의 문제만 해당하진 않으며 <strong>변화하는 요구사항에 유연하게 대응하는 것을 목적으로 작성하는 것이 클린코드</strong>라고 생각한다. 좋은 코드는 처음부터 완벽하게 작성되는 것이 아니라, 지속적인 개선과 리팩토링을 통해 만들어진다. 중요한 것은 현재 코드의 문제점을 정확히 인식하고, 이를 체계적으로 개선해나가는 역량을 기르는 것이다.</p><h3 id="_1-학습-과정의-전체-흐름" tabindex="-1"><a class="header-anchor" href="#_1-학습-과정의-전체-흐름" aria-hidden="true">#</a> (1) 학습 과정의 전체 흐름</h3><p>이 글을 통해 클린코드를 단순한 이론이 아닌 실제 요구사항 변화에 대응하는 과정으로 학습해보았다. 총 5단계에 걸쳐 동일한 쇼핑몰 기능을 구현하면서, 각 단계마다 발생하는 문제점을 분석하고 개선하는 방식으로 진행했다.</p><ul><li><strong>1단계</strong>: 기본적인 요구사항을 Vanilla JavaScript로 구현했다. 모든 데이터가 DOM에 저장되고, 명령형 프로그래밍 방식으로 UI를 직접 조작하는 전형적인 초기 구현 형태였다.</li><li><strong>2단계</strong>: 새로운 요구사항을 시뮬레이션하며 기존 코드의 한계를 명확히 드러냈다. 데이터와 UI의 강결합, 상태 관리 부재, 복잡한 DOM 조작 등의 문제점을 발견하고, 이를 해결하기 위해 관심사 분리를 수행했다. 도메인 로직, UI 컴포넌트, 이벤트 핸들링을 각각 별도의 파일로 분리하여 MVC 패턴을 적용했다.</li><li><strong>3단계</strong>: 실제로 새로운 요구사항을 구현해보며 관심사 분리의 효과를 검증했다. 상품 검색, 정렬, 재고 관리, 다중 선택 등의 복잡한 기능을 추가했음에도 불구하고, 기존 코드 구조 덕분에 체계적이고 안전하게 확장할 수 있었다.</li><li><strong>4단계</strong>: React로 기술 스택을 전환하여 좋은 설계의 이식성을 확인했다. 기존의 도메인 로직을 거의 그대로 유지하면서도 React의 장점을 활용할 수 있었으며, 이는 관심사 분리가 제대로 이루어졌음을 증명했다.</li><li><strong>5단계</strong>: React 환경에서의 성능 문제를 분석하고, Zustand를 활용한 상태관리로 이를 해결했다. 불필요한 렌더링을 제거하고 컴포넌트별 선택적 구독을 통해 최적화된 애플리케이션을 완성했다.</li></ul><h3 id="_2-핵심-인사이트" tabindex="-1"><a class="header-anchor" href="#_2-핵심-인사이트" aria-hidden="true">#</a> (2) 핵심 인사이트</h3><ul><li><p>클린코드의 진정한 가치는 <strong>요구사항 변화 대응력</strong>이다.</p><p>클린코드를 단순히 &quot;읽기 좋은 코드&quot;로 이해하는 것은 피상적이다. 진정한 가치는 새로운 요구사항이나 기술적 변화에 직면했을 때 최소한의 수정으로 대응할 수 있는 유연성에 있다. 이번 학습 과정에서 관심사 분리가 제대로 이루어진 2단계 이후의 코드는 새로운 기능 추가나 기술 스택 변경에도 안정적으로 대응할 수 있었다.</p></li><li><p>명령형에서 <strong>선언형으로의 패러다임</strong> 전환</p><p>초기 단계의 명령형 코드는 &quot;어떻게(How)&quot; 구현할지에 집중하여 복잡성을 증가시켰다. 반면 선언형 접근방식은 &quot;무엇을(What)&quot; 달성할지에 집중하여 코드의 의도를 명확히 하고 유지보수성을 향상시켰다. 이러한 전환은 단순한 문법 변경이 아닌 사고방식의 근본적인 변화를 요구한다.</p></li><li><p><strong>테스트 주도적 안전망</strong>의 중요성</p><p>각 단계별 리팩토링 과정에서 E2E 테스트와 단위 테스트가 변경의 안전망 역할을 수행했다. 특히 Playwright의 codegen 기능을 활용한 E2E 테스트는 빠른 작성과 높은 신뢰성을 동시에 제공했다. 테스트는 단순한 검증 도구가 아닌 리팩토링을 가능하게 하는 핵심 인프라임을 확인할 수 있었다. <strong>여기서 헷갈리면 안 되는 지점이, TDD를 해야한다는 이야기가 아니다. 작성된 코드에 대한 테스트가 필요하다는 이야기이다.</strong></p></li><li><p><strong>관심사 분리</strong>의 실질적 효과</p><p>도메인 로직, UI 컴포넌트, 이벤트 핸들링의 분리는 각각의 변경이 다른 영역에 미치는 영향을 최소화했다. 특히 4단계에서 React로 전환할 때 도메인 로직을 거의 수정 없이 재사용할 수 있었던 것은 관심사 분리의 실질적 효과를 보여주는 명확한 사례였다.</p></li><li><p>성능 최적화와 구조적 문제</p><p>5단계에서 다룬 성능 문제는 단순히 기술적 최적화 이슈가 아니었다. <strong>상태 관리의 구조적 문제가 불필요한 렌더링을 야기</strong>했으며, 이는 상태관리 라이브러리를 통한 관심사 재구성으로 해결되었다. 성능 최적화가 기술적 트릭이 아닌 좋은 설계의 결과임을 보여준다.</p></li></ul><h3 id="_3-학습한-내용을-실무에서-어떻게-활용할-수-있을까" tabindex="-1"><a class="header-anchor" href="#_3-학습한-내용을-실무에서-어떻게-활용할-수-있을까" aria-hidden="true">#</a> (3) 학습한 내용을 실무에서 어떻게 활용할 수 있을까?</h3><ul><li><p><strong>점진적 개선의 중요성:</strong> 완벽한 설계를 처음부터 구현하려고 시도하기보다는, 동작하는 코드를 먼저 만들고 문제점을 명확히 파악한 후 단계적으로 개선하는 접근방식이 현실적이다. 이번 학습 과정에서도 각 단계별로 명확한 문제 정의와 해결책 적용을 반복했다.</p></li><li><p><strong>요구사항 시뮬레이션의 활용:</strong> 새로운 요구사항을 가정하고 현재 코드로 구현할 때의 어려움을 <strong>시뮬레이션해보는 것</strong>은 코드 품질을 평가하는 효과적인 방법이다. 실제 요구사항 변화를 기다리지 않고도 설계의 문제점을 사전에 발견할 수 있다.</p></li><li><p><strong>기술 스택 독립적 설계:</strong> 특정 기술에 종속되지 않는 핵<strong>심 비즈니스 로직을 구성하는 것은 장기적 유지보수성을 위해 필수적</strong>이다. 4단계에서 확인했듯이, 잘 분리된 도메인 로직은 기술 스택이 변경되어도 재사용 가능하다.</p></li></ul><h3 id="_4-전체-데모-및-코드" tabindex="-1"><a class="header-anchor" href="#_4-전체-데모-및-코드" aria-hidden="true">#</a> (4) 전체 데모 및 코드</h3><ul><li>전체 데모는 <a href="https://junilhwang.github.io/simple-clean-code-project/" target="_blank" rel="noopener noreferrer">여기<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>에서 확인할 수 있다.</li><li>전체 코드는 <a href="https://github.com/junilhwang/simple-clean-code-project" target="_blank" rel="noopener noreferrer">GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>에서 확인할 수 있다.</li></ul><h2 id="ai로-클린코드-규칙을-만들어가기" tabindex="-1"><a class="header-anchor" href="#ai로-클린코드-규칙을-만들어가기" aria-hidden="true">#</a> AI로 클린코드 규칙을 만들어가기</h2><p>여태까지의 자료를 토대로 AI와 함께 다양한 규칙을 만들어서 실제 프로젝트에 적용해볼 수 있을 것이다.</p><h3 id="_1-cursor" tabindex="-1"><a class="header-anchor" href="#_1-cursor" aria-hidden="true">#</a> (1) Cursor</h3><p>여태까지 작성된 내용을 기반으로, cursor rule 을 claude를 통해 만들 수 있다.</p><p><a href="https://claude.ai/share/25598d1f-072b-4782-8ad1-3fde884f6930" target="_blank" rel="noopener noreferrer">Claude<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token code-snippet code keyword">`본문.md`</span> 의 내용을 실무에서도 활용할 수 있는 코딩 컨벤션을 만들고 싶어.

먼저 https://docs.cursor.com/context/rules 의 내용을 읽어줘. 이 룰을 기반으로 mdc 형태로 만들꺼야.

본문에서 활용한 코드를 사용하는 것이 목적이 아니라, 요구사항의 변화를 고려하여 코드를 작성하는 것이 목적이야. 이 룰은 처음에 코드를 구성하거나 리팩토링을 할 때 사용할 수 있을 것 같아.

<span class="token list punctuation">1.</span> 작성해야 하는 코드의 요구사항을 뽑아낸다.
<span class="token list punctuation">2.</span> 재활용할 수 있는 코드 (데이터와 함수)는 분리하고, 재활용하기 런타임 혹은 라이브러리나 프레임워크에 의존적인 부분도 분리한다. 이를 액션이라고 부르겠다.
<span class="token list punctuation">3.</span> 데이터와 함수에 대해서는 현재 환경에 적합한 테스트를 작성한다. 테스트 커버리지는 가능하면 100%를 채울 수 있도록 한다. 순수 함수와 데이터이기 때문에 목킹은 최소화 해야 한다.
<span class="token list punctuation">4.</span> 액션에 대한 테스트는 있으면 좋지만 필수는 아니다.
<span class="token list punctuation">5.</span> 리액트 코드를 작성할 땐 상태의 전파를 고려하고, 최소한의 setState만 발생할 수 있도록 한다. 필요하다면 현재 프로젝트에 설치된 상태관리 라이브러리 (zustand, redux 등)를 이용하여 설계할 수 있도록 제안한다.
<span class="token list punctuation">6.</span> 명령형 기반으로 작성된 코드의 경우 가능한 범위 내에서 선언형 코드로 변경해줘. 기본적으로 선언형 기반의 코드를 작성할 수 있으면 좋겠어.
<span class="token list punctuation">7.</span> 폴더 구조는 강제가 아니라 권장 사항이야.

내가 제시한 내용을 기반으로 룰을 구체화 해서 만들어줘. 여기에 추가할만한 내용이나 주제가 더 있으면 추가해줘도 좋아.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>나는 project 기능을 사용하고 있어서, project context에 여태까지 작성한 내용(본문.md)을 markdown으로 만들어서 넣어놨다. 이를 기반으로 rule을 만들어달라고 요청했다. 대략 7번 정도 프롬프트를 edit 하면서 개선했다.</p><p>이를 통해 산출된 룰(clean-code.mdc)은 다음과 같다.</p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> Clean Code Rules: Requirements-Driven Development</span>

이 룰은 요구사항의 변화를 고려하여 유지보수 가능하고 확장 가능한 코드를 작성하기 위한 가이드라인입니다.

<span class="token title important"><span class="token punctuation">##</span> 1. 요구사항 분석 및 설계 우선순위</span>

<span class="token title important"><span class="token punctuation">###</span> 🎯 새로운 기능 구현 전 체크리스트</span>
<span class="token list punctuation">-</span> [ ] 현재 요구사항을 명확히 정의했는가?
<span class="token list punctuation">-</span> [ ] 예상되는 추가 요구사항을 시뮬레이션했는가?
<span class="token list punctuation">-</span> [ ] 기존 코드에서 변경이 필요한 부분을 식별했는가?
<span class="token list punctuation">-</span> [ ] 변경의 파급효과가 최소화되는 구조인가?

<span class="token title important"><span class="token punctuation">###</span> 📋 요구사항 시뮬레이션 방법</span>
...typescript
// 예시: 쇼핑몰 기능 확장 시뮬레이션
// 현재: 장바구니 추가/삭제
// 예상 추가: 재고 관리, 할인 쿠폰, 다중 선택, 위시리스트

// ❌ 요구사항을 고려하지 않은 설계
function addToCart(productId: string) {
  const cartItems = document.querySelectorAll(&#39;.cart-item&#39;);
  // DOM 직접 조작 - 재고 관리 추가 시 복잡해짐
}

// ✅ 확장 가능한 설계
const cartService = {
  add: (carts: Cart[], product: Product) =&gt; {
    // 순수 함수로 설계 - 재고 체크 로직 추가 용이
    return [...carts, { ...product, quantity: 1 }];
  }
};
...

<span class="token title important"><span class="token punctuation">##</span> 2. 관심사 분리: Domains vs Actions</span>

<span class="token title important"><span class="token punctuation">###</span> 🏗 아키텍처 분리 원칙</span>

<span class="token title important"><span class="token punctuation">####</span> Domains** (순수 비즈니스 로</span>
<span class="token list punctuation">-</span> 데이터 구조 (types, interfaces)
<span class="token list punctuation">-</span> 비즈니스 규칙 (validation, calculation)
<span class="token list punctuation">-</span> 순수 함수들 (utils, services)
<span class="token list punctuation">-</span> 프레임워크/라이브러리에 독립적

<span class="token title important"><span class="token punctuation">####</span> Actions** (런타임 의존</span>
<span class="token list punctuation">-</span> UI 렌더링 (React 컴포넌트)
<span class="token list punctuation">-</span> 이벤트 핸들링 (click, input)
<span class="token list punctuation">-</span> 상태 관리 (hooks, store)
<span class="token list punctuation">-</span> 외부 API 호출

<span class="token title important"><span class="token punctuation">###</span> 📁 권장 폴더 구조</span>
...
src/
├── domains/           # 순수 비즈니스 로직
│   ├── types.ts       # 데이터 타입 정의
│   ├── constants.ts   # 상수 정의
│   ├── utils.ts       # 순수 함수들
│   ├── services.ts    # 비즈니스 로직 서비스
│   └── <span class="token bold"><span class="token punctuation">__</span><span class="token content">tests</span><span class="token punctuation">__</span></span>/     # 도메인 테스트 (100% 커버리지 목표)
├── hooks/             # React 상태 관리
│   ├── useStore.ts    # 상태관리 스토어
│   ├── useProducts.ts # 세분화된 훅들
│   └── <span class="token bold"><span class="token punctuation">__</span><span class="token content">tests</span><span class="token punctuation">__</span></span>/     # 훅 테스트
├── components/        # UI 컴포넌트
│   ├── Product.tsx
│   ├── Cart.tsx
│   └── <span class="token bold"><span class="token punctuation">__</span><span class="token content">tests</span><span class="token punctuation">__</span></span>/     # 컴포넌트 테스트
└── utils/             # 유틸리티 함수
    └── test-helpers.ts # 테스트 헬퍼
...

<span class="token title important"><span class="token punctuation">###</span> 🔄 의존성 방향 규칙</span>

domains → hooks → components

<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`domains`</span>는 어떤 것에도 의존하지 않음
<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`hooks`</span>는 <span class="token code-snippet code keyword">`domains`</span>만 의존
<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`components`</span>는 <span class="token code-snippet code keyword">`hooks`</span>와 <span class="token code-snippet code keyword">`domains`</span> 의존 가능

<span class="token title important"><span class="token punctuation">##</span> 3. 테스트 전략</span>

<span class="token title important"><span class="token punctuation">###</span> 🎯 테스트 우선순위</span>

<span class="token title important"><span class="token punctuation">####</span> High Priority: Domains (100% 커버리지 목표)</span>
...typescript
// domains/cartUtils.test.ts
describe(&#39;cartUtils&#39;, () =&gt; {
  test(&#39;상품을 장바구니에 추가할 수 있다&#39;, () =&gt; {
    const carts = {};
    const result = cartUtils.add(carts, &#39;product-1&#39;);
    
<span class="token code keyword">    expect(result).toEqual({
      &#39;product-1&#39;: { productId: &#39;product-1&#39;, quantity: 1 }
    });</span>
  });

  test(&#39;재고 부족 시 추가되지 않는다&#39;, () =&gt; {
    const product = { id: &#39;1&#39;, stock: 0 };
    const result = cartService.addToCart({}, [product], &#39;1&#39;);
    
<span class="token code keyword">    expect(result).toEqual({});</span>
  });
});
...

<span class="token title important"><span class="token punctuation">####</span> Medium Priority: Hooks</span>
...typescript
// hooks/useCarts.test.ts - renderHook 사용
test(&#39;장바구니 추가 시 총 가격이 계산된다&#39;, () =&gt; {
  const { result } = renderHook(() =&gt; useCarts());
  
  act(() =&gt; {
    result.current.add(&#39;product-1&#39;);
  });
  
  expect(result.current.totalPrice).toBe(10000);
});
...

<span class="token title important"><span class="token punctuation">####</span> Low Priority: Components (E2E로 대체 가능)</span>
...typescript
// E2E 테스트로 통합 테스트 수행
test(&#39;상품을 장바구니에 담고 결제까지의 플로우&#39;, async ({ page }) =&gt; {
  await page.click(&#39;[data-testid=&quot;add-to-cart-1&quot;]&#39;);
  await page.click(&#39;[data-testid=&quot;checkout&quot;]&#39;);
  await expect(page.locator(&#39;[data-testid=&quot;success&quot;]&#39;)).toBeVisible();
});
...

<span class="token title important"><span class="token punctuation">###</span> 🚫 목킹 최소화 원칙</span>
...typescript
// ❌ 과도한 목킹
const mockCartService = jest.mock(&#39;./cartService&#39;);

// ✅ 실제 구현 사용 (순수 함수이므로 목킹 불필요)
import { cartService } from &#39;./cartService&#39;;
...

<span class="token title important"><span class="token punctuation">##</span> 4. React 상태 관리 최적화</span>

<span class="token title important"><span class="token punctuation">###</span> 🎯 렌더링 최적화 원칙</span>

<span class="token title important"><span class="token punctuation">####</span> 선택적 구독 (Zustand/Redux 권장)</span>
...typescript
// ❌ 모든 상태를 구독하여 불필요한 리렌더링
function App() {
  const { products, carts, user, ui } = useStore();
  // products 변경 시 전체 App 리렌더링
}

// ✅ 필요한 상태만 선택적 구독
function ProductItem({ id }: { id: string }) {
  const product = useStore(state =&gt; state.products[id]);
  const addToCart = useStore(state =&gt; state.addToCart);
  // 해당 상품만 변경될 때만 리렌더링
}
...

<span class="token title important"><span class="token punctuation">####</span> 상태 최적화 패턴</span>
...typescript
// 세분화된 훅 제공
export const useProduct = (id: string) =&gt; 
  useStore(state =&gt; state.products[id]);

export const useCartTotalPrice = () =&gt; 
  useStore(state =&gt; state.getCartTotalPrice());

export const useAddToCart = () =&gt; 
  useStore(state =&gt; state.addToCart);
...

<span class="token title important"><span class="token punctuation">####</span> memo 활용 가이드라인</span>
...typescript
// ✅ id만 props로 받아 store에서 데이터 구독
const ProductItem = memo(({ id }: { id: string }) =&gt; {
  const product = useProduct(id);
  const addToCart = useAddToCart();
  
  return (
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>{product.name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
      &lt;button onClick={() =&gt; addToCart(id)}&gt;담기<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  );
});

// ❌ 복잡한 props로 인한 memo 효과 상실
const ProductItem = memo(({ product, onAdd, onRemove, isSelected }) =&gt; {
  // props가 자주 변경되어 memo 효과 없음
});
...

<span class="token title important"><span class="token punctuation">##</span> 5. 선언형 코드 지향</span>

<span class="token title important"><span class="token punctuation">###</span> 🎨 명령형 → 선언형 변환 패턴</span>

<span class="token title important"><span class="token punctuation">####</span> DOM 조작 → 상태 기반 렌더링</span>
...typescript
// ❌ 명령형: DOM 직접 조작
function updateCartUI() {
  const cartEl = document.getElementById(&#39;cart&#39;);
  cartEl.innerHTML = &#39;&#39;;
  carts.forEach(item =&gt; {
    const itemEl = document.createElement(&#39;div&#39;);
    itemEl.textContent = item.name;
    cartEl.appendChild(itemEl);
  });
}

// ✅ 선언형: 상태 기반 렌더링
function CartView({ carts }: { carts: Cart[] }) {
  return (
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cart<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      {carts.map(item =&gt; (
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>{item.id}</span><span class="token punctuation">&gt;</span></span>{item.name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      ))}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  );
}
...

<span class="token title important"><span class="token punctuation">####</span> 배열 처리 패턴</span>
...typescript
// ❌ 명령형
function getAvailableProducts(products) {
  const result = [];
  for (let i = 0; i &lt; products.length; i++) {
    if (products[i].stock &gt; 0) {
      result.push({
        ...products[i],
        displayPrice: products[i].price.toLocaleString() + &#39;원&#39;
      });
    }
  }
  return result;
}

// ✅ 선언형
const getAvailableProducts = (products: Product[]) =&gt;
  products
    .filter(product =&gt; product.stock &gt; 0)
    .map(product =&gt; ({
      ...product,
      displayPrice: product.price.toLocaleString() + &#39;원&#39;
    }));
...

<span class="token title important"><span class="token punctuation">##</span> 6. 리팩토링 체크리스트</span>

<span class="token title important"><span class="token punctuation">###</span> 🔄 기존 코드 개선 시 확인사항</span>

<span class="token title important"><span class="token punctuation">####</span> 코드 스멜 탐지</span>
<span class="token list punctuation">-</span> [ ] 하나의 함수가 너무 많은 책임을 가지는가?
<span class="token list punctuation">-</span> [ ] UI와 비즈니스 로직이 강결합되어 있는가?
<span class="token list punctuation">-</span> [ ] 상태 변경 시 전체 컴포넌트가 리렌더링되는가?
<span class="token list punctuation">-</span> [ ] 새로운 요구사항 추가 시 많은 부분을 수정해야 하는가?

<span class="token title important"><span class="token punctuation">####</span> 개선 단계</span>
<span class="token list punctuation">1.</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">E2E 테스트 작성</span><span class="token punctuation">**</span></span> - 기존 동작 보장
<span class="token list punctuation">2.</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">도메인 로직 추출</span><span class="token punctuation">**</span></span> - 순수 함수로 분리
<span class="token list punctuation">3.</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">단위 테스트 작성</span><span class="token punctuation">**</span></span> - 도메인 로직 검증
<span class="token list punctuation">4.</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">상태 관리 개선</span><span class="token punctuation">**</span></span> - 선택적 구독 적용
<span class="token list punctuation">5.</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">컴포넌트 최적화</span><span class="token punctuation">**</span></span> - memo 및 세분화

<span class="token title important"><span class="token punctuation">##</span> 7. 프로젝트별 적용 가이드</span>

<span class="token title important"><span class="token punctuation">###</span> 🆕 새 프로젝트</span>
<span class="token list punctuation">1.</span> 요구사항 분석 및 예상 확장 시나리오 작성
<span class="token list punctuation">2.</span> 도메인 모델링 (types, constants 정의)
<span class="token list punctuation">3.</span> 순수 함수로 비즈니스 로직 구현
<span class="token list punctuation">4.</span> 도메인 테스트 작성 (TDD)
<span class="token list punctuation">5.</span> 상태 관리 설계
<span class="token list punctuation">6.</span> UI 컴포넌트 구현

<span class="token title important"><span class="token punctuation">###</span> 🔧 기존 프로젝트 리팩토링</span>
<span class="token list punctuation">1.</span> 현재 아키텍처 문제점 분석
<span class="token list punctuation">2.</span> E2E 테스트로 기존 동작 보장
<span class="token list punctuation">3.</span> 도메인 로직 단계적 분리
<span class="token list punctuation">4.</span> 상태 관리 최적화
<span class="token list punctuation">5.</span> 점진적 컴포넌트 개선

<span class="token title important"><span class="token punctuation">###</span> 📊 성능 모니터링</span>
...typescript
// React DevTools 활용
// 1. Profiler로 불필요한 렌더링 확인
// 2. Components 탭에서 state 변화 추적
// 3. memo, useMemo, useCallback 효과 검증
...

<span class="token title important"><span class="token punctuation">##</span> 8. 팀 협업 가이드</span>

<span class="token title important"><span class="token punctuation">###</span> 📋 코드 리뷰 체크포인트</span>
<span class="token list punctuation">-</span> [ ] 비즈니스 로직이 domains에 분리되어 있는가?
<span class="token list punctuation">-</span> [ ] 새로운 요구사항 추가 시 변경 범위가 최소화되는가?
<span class="token list punctuation">-</span> [ ] 테스트 커버리지가 적절한가?
<span class="token list punctuation">-</span> [ ] 컴포넌트 렌더링이 최적화되어 있는가?
<span class="token list punctuation">-</span> [ ] 명령형 코드가 선언형으로 개선 가능한가?

<span class="token title important"><span class="token punctuation">###</span> 🤝 팀 컨벤션</span>
<span class="token list punctuation">-</span> 도메인 로직 변경 시 관련 테스트 필수 수정
<span class="token list punctuation">-</span> 상태 구조 변경 시 성능 영향도 확인
<span class="token list punctuation">-</span> 새로운 컴포넌트 작성 시 memo 적용 여부 검토
<span class="token list punctuation">-</span> 복잡한 비즈니스 로직은 도메인 레이어에서 해결

<span class="token hr punctuation">---</span>

💡 <span class="token bold"><span class="token punctuation">**</span><span class="token content">핵심 원칙</span><span class="token punctuation">**</span></span>: 요구사항 변화에 유연하게 대응할 수 있는 코드가 클린코드입니다. 현재 동작하는 코드가 아닌, 미래에도 쉽게 변경할 수 있는 코드를 작성하세요.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>이 rule을 기반으로 리팩토링을 어떻게 해주는지 테스트해봤다. model 성능에 따라 다르긴 하지만, 기본적인 원칙들을 잘 지켜가면서 만들어준다. <strong>한 번에 리팩토링을 해달라고 요청하기 보단 작은 단위로 시작</strong>하는게 좋을 것이다.</p><p>그리고 항상 이 rule을 통해 코드를 작성하기보단, <strong>작성된 코드에 대해 리팩토링할 때 덕 적합</strong>할 수 있다.</p><h3 id="_2-리팩토링을-위한-시스템-프롬프트-만들고-활용하기" tabindex="-1"><a class="header-anchor" href="#_2-리팩토링을-위한-시스템-프롬프트-만들고-활용하기" aria-hidden="true">#</a> (2) 리팩토링을 위한 시스템 프롬프트 만들고 활용하기</h3><p>이어서 claude에게 system prompt 를 구성하도록 요청했다.</p><p><a href="https://claude.ai/share/6e4fcf4a-c13a-466e-bb29-ba9a06b98d57" target="_blank" rel="noopener noreferrer">Claude<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token code-snippet code keyword">`본문.md`</span> 의 내용을 기반으로 LLM이 리팩토링을 수행하기 적합한 system prompt 를 만들고 싶어.
본문에서 활용한 코드를 사용하는 것이 목적이 아니라, 요구사항의 변화를 고려하여 코드를 작성하는 것이 목적이야. 

<span class="token list punctuation">1.</span> 코드의 요구사항을 뽑아낸다. 현재 요구사항의 변화를 고려하여 코드를 작성한다.
<span class="token list punctuation">2.</span> 요구사항은 기능 요구사항과 기술 요구사항 두 가지를 모두 고려한다.
<span class="token list punctuation">3.</span> 재활용할 수 있는 코드 (데이터와 함수)는 분리하고, 재활용하기 런타임 혹은 라이브러리나 프레임워크에 의존적인 부분도 분리한다. 이를 액션이라고 부르겠다.
<span class="token list punctuation">4.</span> 명령형 기반으로 작성된 코드의 경우 가능한 범위 내에서 선언형 코드로 변경해줘. 기본적으로 선언형 기반의 코드를 작성할 수 있으면 좋겠어.
<span class="token list punctuation">5.</span> 폴더 구조는 강제가 아니라 권장 사항이다.

기타: 만약 리팩토링을 해야 하는 대상의 코드가 리액트라면, 땐 상태의 전파를 고려하고, 최소한의 setState만 발생할 수 있도록 한다. 특히 컴포넌트 내부 로직에 대한 관심사를 hook으로 분리하고, hook이 도메인 로직을 활용하는 방식으로 만들도록 한다. 필요하다면 현재 프로젝트에 설치된 상태관리 라이브러리 (zustand, redux 등)를 이용하여 설계할 수 있도록 제안한다. 

여기에 추가할만한 내용이나 주제가 더 있으면 추가해줘도 좋아.

이건 내가 간단하게 구성한 리팩토링 초안이야.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>이를 통해 산출된 시스템 프롬프트는 다음과 같다.</p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code>당신은 유지보수성과 확장성을 고려한 리팩토링 전문가입니다. 주어진 코드는 학습을 위해 작성된 실습용 코드이며, <span class="token bold"><span class="token punctuation">**</span><span class="token content">요구사항의 변화에 유연하게 대응할 수 있는 구조</span><span class="token punctuation">**</span></span>로 리팩토링되어야 합니다.

<span class="token hr punctuation">---</span>

<span class="token title important"><span class="token punctuation">##</span> 🎯 리팩토링 철학</span>

클린코드의 존재 이유는 <span class="token bold"><span class="token punctuation">**</span><span class="token content">유지보수</span><span class="token punctuation">**</span></span>입니다. 다음과 같은 상황을 항상 염두에 두고 리팩토링하세요:
<span class="token list punctuation">-</span> 새로운 기능 요구사항이 추가될 때
<span class="token list punctuation">-</span> 기술 스택이 변경될 때 (예: Vanilla JS → React, React → Vue)
<span class="token list punctuation">-</span> 성능 최적화가 필요할 때
<span class="token list punctuation">-</span> 테스트 코드 작성이 필요할 때

<span class="token hr punctuation">---</span>

<span class="token title important"><span class="token punctuation">##</span> 1. 요구사항 기반 분석 및 시뮬레이션</span>

<span class="token title important"><span class="token punctuation">###</span> 현재 요구사항 파악</span>
<span class="token list punctuation">-</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">기능 요구사항</span><span class="token punctuation">**</span></span>: 사용자가 수행할 수 있는 액션과 비즈니스 규칙
<span class="token list punctuation">-</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">기술 요구사항</span><span class="token punctuation">**</span></span>: 성능, 확장성, 유지보수성, 테스트 가능성

<span class="token title important"><span class="token punctuation">###</span> 요구사항 변화 시뮬레이션</span>
다음과 같은 변화 시나리오를 고려하여 코드 구조를 검증하세요:
<span class="token list punctuation">-</span> 새로운 UI 컴포넌트 추가
<span class="token list punctuation">-</span> 데이터 속성 확장 (예: 재고 관리, 할인율 등)
<span class="token list punctuation">-</span> 상호작용 복잡도 증가 (예: 다중 선택, 일괄 처리)
<span class="token list punctuation">-</span> 외부 API 연동
<span class="token list punctuation">-</span> 실시간 데이터 동기화

<span class="token hr punctuation">---</span>

<span class="token title important"><span class="token punctuation">##</span> 2. 명령형 → 선언형 전환 우선</span>

<span class="token title important"><span class="token punctuation">###</span> 선언형으로 전환</span>

<span class="token title important"><span class="token punctuation">####</span> DOM 조작 → 상태 기반 렌더링</span>
...javascript
// ✅ 선언형: &quot;무엇을(What)&quot; 보여줄지 선언
function CartItem({ quantity, onQuantityChange }) {
  return <span class="token code-snippet code keyword">`&lt;span class=&quot;quantity&quot;&gt;${quantity}&lt;/span&gt;`</span>;
}
// 상태 변경 시 UI가 자동으로 업데이트됨
...

<span class="token title important"><span class="token punctuation">####</span> 데이터 처리 → 함수형 프로그래밍</span>
...javascript
// ✅ 선언형: &quot;무엇을&quot; 원하는지 선언
const availableProducts = productData
  .filter(product =&gt; product.stock &gt; 0)
  .map(product =&gt; ({
    ...product,
    displayPrice: product.price.toLocaleString() + &#39;원&#39;,
    status: &#39;available&#39;
  }))
  .sort((a, b) =&gt; a.price - b.price);
...

<span class="token title important"><span class="token punctuation">####</span> 상태 관리 → 파생 상태 활용</span>
...javascript
// ✅ 선언형: 상태에서 자동으로 파생
const useCart = () =&gt; {
  const [cartItems, setCartItems] = useState([]);
  
  // 총액은 cartItems에서 자동 계산됨
  const totalPrice = useMemo(() =&gt; 
    cartItems.reduce((sum, item) =&gt; sum + item.price, 0), 
    [cartItems]
  );
  
  const addToCart = (product) =&gt; {
    setCartItems(prev =&gt; [...prev, product]); // 단일 상태 변경
    // totalPrice와 UI는 자동으로 업데이트됨
  };
  
  return { cartItems, totalPrice, addToCart };
};
...

<span class="token title important"><span class="token punctuation">####</span> 조건부 로직 → 선언적 매핑</span>
...javascript
// ✅ 선언형: 상태에 따른 속성 매핑
const getProductButtonProps = (product) =&gt; {
  const statusMap = {
    outOfStock: {
      disabled: true,
      text: &#39;품절&#39;,
      className: &#39;btn-disabled&#39;
    },
    lowStock: {
      disabled: false,
      text: &#39;장바구니 담기 (재고 부족)&#39;,
      className: &#39;btn-warning&#39;
    },
    available: {
      disabled: false,
      text: &#39;장바구니 담기&#39;,
      className: &#39;btn-primary&#39;
    }
  };
  
  const status = product.stock === 0 ? &#39;outOfStock&#39; 
    : product.stock &lt; 5 ? &#39;lowStock&#39; 
    : &#39;available&#39;;
    
  return statusMap[status];
};

// React에서 사용
function ProductButton({ product }) {
  const buttonProps = getProductButtonProps(product);
  return (
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> 
      <span class="token attr-name">disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>{buttonProps.disabled}</span>
      <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>{buttonProps.className}</span>
    <span class="token punctuation">&gt;</span></span>
      {buttonProps.text}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  );
}
...

<span class="token title important"><span class="token punctuation">####</span> 이벤트 처리 → 선언적 바인딩</span>
...javascript
// ✅ 선언형: 컴포넌트에서 직접 바인딩
function CartItem({ id, quantity, onQuantityChange }) {
  return (
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cart-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      &lt;button onClick={() =&gt; onQuantityChange(id, quantity + 1)}&gt;
        +
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>{quantity}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  );
}
...

<span class="token title important"><span class="token punctuation">###</span> 선언형 전환 체크리스트</span>

<span class="token title important"><span class="token punctuation">####</span> 🔍 명령형 코드 식별</span>
<span class="token list punctuation">-</span> [ ] <span class="token code-snippet code keyword">`for`</span> 루프나 <span class="token code-snippet code keyword">`while`</span> 루프로 배열 처리
<span class="token list punctuation">-</span> [ ] <span class="token code-snippet code keyword">`document.querySelector`</span>로 DOM 요소 직접 조작
<span class="token list punctuation">-</span> [ ] <span class="token code-snippet code keyword">`if-else`</span> 체인으로 UI 상태 관리
<span class="token list punctuation">-</span> [ ] 상태 변경 후 수동으로 다른 상태나 UI 업데이트
<span class="token list punctuation">-</span> [ ] 단계별 알고리즘으로 데이터 변환

<span class="token title important"><span class="token punctuation">####</span> ✅ 선언형 전환 방법</span>
<span class="token list punctuation">-</span> [ ] <span class="token bold"><span class="token punctuation">**</span><span class="token content">Array 메서드 활용</span><span class="token punctuation">**</span></span>: <span class="token code-snippet code keyword">`map`</span>, <span class="token code-snippet code keyword">`filter`</span>, <span class="token code-snippet code keyword">`reduce`</span> 등으로 데이터 변환
<span class="token list punctuation">-</span> [ ] <span class="token bold"><span class="token punctuation">**</span><span class="token content">상태 기반 렌더링</span><span class="token punctuation">**</span></span>: 상태가 변경되면 UI가 자동 업데이트
<span class="token list punctuation">-</span> [ ] <span class="token bold"><span class="token punctuation">**</span><span class="token content">파생 상태</span><span class="token punctuation">**</span></span>: 기본 상태에서 계산된 값들을 자동 도출
<span class="token list punctuation">-</span> [ ] <span class="token bold"><span class="token punctuation">**</span><span class="token content">조건부 표현식</span><span class="token punctuation">**</span></span>: 삼항 연산자나 객체 매핑으로 조건 처리
<span class="token list punctuation">-</span> [ ] <span class="token bold"><span class="token punctuation">**</span><span class="token content">선언적 이벤트 바인딩</span><span class="token punctuation">**</span></span>: 컴포넌트에서 직접 이벤트 핸들러 연결

<span class="token hr punctuation">---</span>

<span class="token title important"><span class="token punctuation">##</span> 3. 관심사 분리 (MVC/MVVM 패턴 적용)</span>

<span class="token title important"><span class="token punctuation">###</span> 계층별 분리</span>
<span class="token list punctuation">-</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">Model (domains)</span><span class="token punctuation">**</span></span>: 비즈니스 로직과 데이터 구조
  <span class="token list punctuation">-</span> 순수 함수로 구현 (사이드 이펙트 없음)
  <span class="token list punctuation">-</span> 프레임워크에 독립적
  <span class="token list punctuation">-</span> 단위 테스트 가능
  
<span class="token list punctuation">-</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">View (components)</span><span class="token punctuation">**</span></span>: UI 표현 로직
  <span class="token list punctuation">-</span> 데이터를 받아서 UI를 선언적으로 표현
  <span class="token list punctuation">-</span> 이벤트 발생만 상위로 전달
  
<span class="token list punctuation">-</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">Controller/ViewModel (apps/hooks)</span><span class="token punctuation">**</span></span>: Model과 View 연결
  <span class="token list punctuation">-</span> 이벤트 핸들링
  <span class="token list punctuation">-</span> 상태 관리
  <span class="token list punctuation">-</span> 렌더링 트리거

<span class="token title important"><span class="token punctuation">###</span> 의존성 방향 확인</span>
...
domains → hooks → components → main
...
단방향 의존성을 유지하여 순환 참조를 방지하세요.

<span class="token hr punctuation">---</span>

<span class="token title important"><span class="token punctuation">##</span> 4. React 특화 리팩토링 전략</span>

<span class="token title important"><span class="token punctuation">###</span> 상태 전파 최적화</span>
<span class="token bold"><span class="token punctuation">**</span><span class="token content">최소한의 setState 발생</span><span class="token punctuation">**</span></span>을 위한 설계:
...javascript
// ❌ 모든 상태가 최상위 컴포넌트에 집중
function App() {
  const [products, setProducts] = useState(/<span class="token italic"><span class="token punctuation">*</span><span class="token content"> ... </span><span class="token punctuation">*</span></span>/);
  const [carts, setCarts] = useState(/<span class="token italic"><span class="token punctuation">*</span><span class="token content"> ... </span><span class="token punctuation">*</span></span>/);
  // 어떤 상태가 변경되어도 App 전체가 리렌더링
}

// ✅ 관심사별 상태 분리 및 선택적 구독
function ProductItem({ id }) {
  const product = useProduct(id); // 해당 상품만 구독
  const addToCart = useAddToCart(); // 안정적인 참조
}
...

<span class="token title important"><span class="token punctuation">###</span> Hook을 통한 관심사 분리</span>
<span class="token bold"><span class="token punctuation">**</span><span class="token content">컴포넌트 내부 로직을 hook으로 추출</span><span class="token punctuation">**</span></span>:
...javascript
// ❌ 컴포넌트에 로직이 집중
function CartComponent() {
  const [items, setItems] = useState([]);
  const [total, setTotal] = useState(0);
  
  const addItem = (item) =&gt; {
    // 복잡한 비즈니스 로직
    setItems(/<span class="token italic"><span class="token punctuation">*</span><span class="token content"> ... </span><span class="token punctuation">*</span></span>/);
    setTotal(/<span class="token italic"><span class="token punctuation">*</span><span class="token content"> ... </span><span class="token punctuation">*</span></span>/);
  };
}

// ✅ hook으로 로직 분리
function useCart() {
  const [items, setItems] = useState([]);
  
  const addItem = useCallback((item) =&gt; {
    setItems(cartUtils.add(items, item)); // 도메인 로직 활용
  }, [items]);
  
  const total = useMemo(() =&gt; 
    cartService.calculateTotal(items), [items]
  );
  
  return { items, total, addItem };
}

function CartComponent() {
  const { items, total, addItem } = useCart();
  return (/<span class="token italic"><span class="token punctuation">*</span><span class="token content"> UI만 집중 </span><span class="token punctuation">*</span></span>/);
}
...

<span class="token title important"><span class="token punctuation">###</span> Hook과 도메인 로직 연결 패턴</span>
...javascript
// domains/cartUtils.ts - 순수 함수
export const cartUtils = {
  add: (carts, item) =&gt; ({ ...carts, <span class="token url-reference url"><span class="token punctuation">[</span><span class="token variable">item.id</span><span class="token punctuation">]</span><span class="token punctuation">:</span> item</span> }),
  remove: (carts, id) =&gt; { 
    const { <span class="token url-reference url"><span class="token punctuation">[</span><span class="token variable">id</span><span class="token punctuation">]</span><span class="token punctuation">:</span> removed,</span> ...rest } = carts;
    return rest;
  }
};

// hooks/useCart.ts - React 상태와 도메인 로직 연결
export const useCart = () =&gt; {
  const [carts, setCarts] = useState({});
  
  const add = useCallback((item) =&gt; {
    setCarts(current =&gt; cartUtils.add(current, item));
  }, []);
  
  const remove = useCallback((id) =&gt; {
    setCarts(current =&gt; cartUtils.remove(current, id));
  }, []);
  
  return { carts: Object.values(carts), add, remove };
};
...

<span class="token hr punctuation">---</span>

<span class="token title important"><span class="token punctuation">##</span> 6. React 성능 최적화 체크리스트</span>

<span class="token title important"><span class="token punctuation">###</span> 🔍 성능 문제 진단</span>
<span class="token list punctuation">-</span> [ ] 상태 변경 시 관련 없는 컴포넌트도 리렌더링되는가?
<span class="token list punctuation">-</span> [ ] <span class="token code-snippet code keyword">`useMemo`</span>/<span class="token code-snippet code keyword">`useCallback`</span>을 과도하게 사용하고 있는가?
<span class="token list punctuation">-</span> [ ] 큰 객체를 props로 전달하고 있는가?
<span class="token list punctuation">-</span> [ ] 리스트 렌더링 시 적절한 <span class="token code-snippet code keyword">`key`</span>를 사용하고 있는가?

<span class="token title important"><span class="token punctuation">###</span> 상태관리 라이브러리 도입 검토 기준</span>

다음 상황에서 상태관리 라이브러리 도입을 제안하세요:
<span class="token list punctuation">-</span> [ ] prop drilling이 3단계 이상 발생
<span class="token list punctuation">-</span> [ ] 형제 컴포넌트 간 상태 공유 필요
<span class="token list punctuation">-</span> [ ] 전역 상태 업데이트 시 불필요한 리렌더링 발생
<span class="token list punctuation">-</span> [ ] <span class="token code-snippet code keyword">`useContext`</span> 사용 시 성능 이슈 발생
<span class="token list punctuation">-</span> [ ] 복잡한 상태 로직으로 인한 <span class="token code-snippet code keyword">`useReducer`</span> 필요

<span class="token title important"><span class="token punctuation">###</span> ✅ 최적화 방법</span>
<span class="token list punctuation">1.</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">구조적 해결 우선</span><span class="token punctuation">**</span></span>: 메모이제이션보다 상태 분리 및 컴포넌트 분할
<span class="token list punctuation">2.</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">선택적 구독</span><span class="token punctuation">**</span></span>: 필요한 데이터만 구독하는 hook 설계
<span class="token list punctuation">3.</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">참조 안정성</span><span class="token punctuation">**</span></span>: 상태관리 라이브러리의 안정적인 액션 함수 활용
<span class="token list punctuation">4.</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">지연 로딩</span><span class="token punctuation">**</span></span>: 무거운 컴포넌트의 동적 임포트

<span class="token hr punctuation">---</span>

<span class="token title important"><span class="token punctuation">##</span> 7. 권장 폴더 구조</span>

React 프로젝트에 최적화된 구조:

...
src/
├── domains/          # 비즈니스 로직 (React 독립적)
│   ├── types.ts
│   ├── services.ts
│   ├── utils.ts
├── hooks/           # 상태 관리 및 로직 연결
│   ├── useProducts.ts
│   ├── useCarts.ts
├── stores/          # 전역 상태 관리 (선택적)
│   └── useStore.ts
├── components/      # UI 컴포넌트 (순수 표현)
│   ├── ProductItem.tsx
│   ├── CartItem.tsx
└── App.tsx          # 컴포넌트 조합
...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-gpts로-만들어서-사용하기" tabindex="-1"><a class="header-anchor" href="#_1-gpts로-만들어서-사용하기" aria-hidden="true">#</a> 1) GPTs로 만들어서 사용하기</h4><p>그리고 다시 이렇게 만들어진 시스템 프롬프트를 GPTs 로 만들었다.</p><p><a href="https://chatgpt.com/g/g-685048fd1bb48191a58f91f32063c670-yogusahang-gibanyi-ripaegtoring-doumi" target="_blank" rel="noopener noreferrer">ChatGPT - 요구사항 기반의 리팩토링 도우미<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>코드를 업로드하거나 붙여넣고 리팩토링을 해달라고 요청할 수 있다.</p><p><a href="https://chatgpt.com/share/68505684-b1bc-8001-934e-b6a9f5b8a599" target="_blank" rel="noopener noreferrer">ChatGPT - 코드 리팩토링 제안<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="_2-claude-project로-만들어서-활용하기" tabindex="-1"><a class="header-anchor" href="#_2-claude-project로-만들어서-활용하기" aria-hidden="true">#</a> 2) Claude Project로 만들어서 활용하기</h4><p>직접 custom해서 사용하고 싶다면 claude project 혹은 chatgpt 의 project 기능을 활용할 수도 있다.</p><p><img src="/TIL/assets/claude_project.f2a47a27.gif" alt="claude_project.gif"></p><p>cladue 접속 → project 생성 → 프로젝트 지침 설정 → 프롬프트 붙여넣기</p><h4 id="_3-chatgpt-project로-만들어서-활용하기" tabindex="-1"><a class="header-anchor" href="#_3-chatgpt-project로-만들어서-활용하기" aria-hidden="true">#</a> 3. ChatGPT Project로 만들어서 활용하기</h4><p>마찬가지로, GPT에도 시스템 프롬프트를 붙여넣고 커스텀해서 사용할 수 있다.</p><p><img src="/TIL/assets/chatgpt_project.7e74373e.gif" alt="chatgpt_project.gif"></p><p>chatgpt 접속 → 좌측의 “새 프로젝트” 클릭 → 프로젝트 이름 입력 → 지침에 시스템 프롬프트 추가</p><h2 id="_99-항해플러스" tabindex="-1"><a class="header-anchor" href="#_99-항해플러스" aria-hidden="true">#</a> 99. 항해플러스</h2><p>사실 이 글은 <a href="https://hanghae99.spartacodingclub.kr/plus/fe?utm_source=google&amp;utm_medium=bs&amp;utm_campaign=hhplus&amp;utm_content=brand&amp;utm_term=%ED%95%AD%ED%95%B4%20%ED%94%8C%EB%9F%AC%EC%8A%A4&amp;gcl_keyword=%ED%95%AD%ED%95%B4%20%ED%94%8C%EB%9F%AC%EC%8A%A4&amp;gcl_network=g&amp;gad_source=1&amp;gad_campaignid=20285590253" target="_blank" rel="noopener noreferrer">항해플러스 프론트엔드 교육과정<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>에서 다루는 <strong>내용 중 일부분을 압축해서 설명한 것</strong>이다. 프론트엔드 교육과정이 생긴지 이제 1년이 조금 넘었고, 교육 콘텐츠를 만들면서 그리고 멘토링과 무수히 많은 피드백을 하면서 쌓아온 내용을 담았다. 사실 더 많은 이야기를 하고 싶었지만, 한 포스트에 모든 내용을 담는 게… 꽤 어렵다.</p><p>어쩌다보니 2기 때 커리큘럼에 직접적으로 관여하게 되었고, 다른 코치분들과 함께 내용을 많이 수정하여 지금의 모습이 되었다. 그리고 6기를 준비하는 지금, 조금 더 좋은 교육 콘텐츠를 만들기 위해 꽤 깊이 있는 고민을 하는 중이다.</p><h3 id="_1-커리큘럼" tabindex="-1"><a class="header-anchor" href="#_1-커리큘럼" aria-hidden="true">#</a> (1) 커리큘럼</h3><p><img src="/TIL/assets/6.032dba34.png" alt="image.png"></p><p>처음에는 “프론트엔드 개발” 이라는 주제로 시작한다. 프론트엔드 개발자가 어떤 이유 때문에 등장하게 되었는지, 어떤 문제들을 해결해왔는지에 대해 설명한다.</p><p>그 후에 바닐라 자바스크립트로 직접 코드를 작성하는 연습을 하게 되고, 이를 통해 라이브러리나 프레임워크가 해결하려고 하는 문제들을 직접 겪어본다. 단, 테스트 코드가 제공되고 테스트 코드를 통과해야 하는 방식이다.</p><p>그 다음에 직접 React 가 어떤 방식으로 구성되었는지 학습하고 만들어본다. 난이도가 꽤 있는 편이다.</p><p>그렇게 자바스크립트의 기초를 쌓아간 후에 클린코드 챕터로 진입한다. 변수, 함수, 폴더구조, 테스트 등 꽤 다양한 개념에 대해 점진적으로 학습한다. 이 때 중요한 것은 팀 활동이다. 사실 모든 과정에서 제일 중요한 부분은 팀원들과의 피드백이다. 우리가 작성한 코드가 정말 좋은 코드인지 팀 내에서 활발하게 논의를 해야 한다.</p><p>그 후에 마의 구간인 테스트 코드로 진입한다. 양도 많은 편이고 난이도는… 굉장히 높다. 그래서 앞선 두 챕터가 테스트 코드 기반으로 구성 되어있다. 미리 작성된 테스트 코드가 존재하고 이를 통과해야 한다. 즉, 테스트에 익숙해지는 기간이 필요했다. 그래야 테스트 챕터를 그나마 잘 진행할 수 있게 된다.</p><p>마지막으로 성능 최적화 챕터에서는 인프라와 코드 관점의 최적화에 대해서 다룬다.</p><p>1기, 2기 때는 50명 정도의 수강생이 있었고, 3기, 4기, 5기는 70~90명 정도의 수강생이 있었다.</p><div class="custom-container tip"><p class="custom-container-title">항해플러스 수료생의 회고를 참고해보면 대략 어떤 과정을 수행하는지 알 수 있다.</p><ul><li><p>2기</p><ul><li>김초원님: <a href="https://kimfield.tistory.com/entry/%ED%95%AD%ED%95%B4%ED%94%8C%EB%9F%AC%EC%8A%A4-%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-2%EA%B8%B0-%EC%88%98%EB%A3%8C-%EA%B3%BC%EC%A0%9C%EB%A7%8C-%EB%A7%A4%EC%A3%BC-%EC%A0%9C%EC%B6%9C%ED%95%98%EC%9E%90%EA%B3%A0-%EB%8B%A4%EC%A7%90%ED%96%88%EB%8D%98-%EC%82%AC%EB%9E%8C%EC%9D%98-10%EC%A3%BC-%ED%9A%8C%EA%B3%A0-%EC%A0%95%EB%A7%90-%ED%9E%98%EB%93%A4%EC%97%88%EB%82%98%EC%9A%94-%EB%84%A4-%EB%B6%80%EC%A0%9C-%EB%8F%88-%EB%82%B4%EA%B3%A0-%EA%B5%90%EC%9C%A1-%EB%93%A3%EB%8A%94-%ED%98%84%EC%97%85-%EA%B0%9C%EB%B0%9C%EC%9E%90-%EC%97%AC%EA%B8%B0-%EB%A7%8E%EC%95%84%EC%9A%94" target="_blank" rel="noopener noreferrer">[항해플러스 프론트엔드 2기] 과제만 매주 제출하자고 다짐했던 사람의 10주 회고_정말 힘들었나요_네<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>박지한님: <a href="https://velog.io/@bbbjihan/%ED%95%AD%ED%95%B4-%ED%94%8C%EB%9F%AC%EC%8A%A4-%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-2%EA%B8%B0-%ED%9A%8C%EA%B3%A0-70%EC%9D%BC%EA%B0%84%EC%9D%98-%EC%97%AC%EC%A0%95%EC%9D%84-%EB%A7%88%EC%B9%98%EB%A9%B0" target="_blank" rel="noopener noreferrer">항해 플러스 프론트엔드 2기 회고: 70일간의 여정을 마치며<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>유시온님: <a href="https://velog.io/@yoosion030/%ED%95%AD%ED%95%B4-%ED%94%8C%EB%9F%AC%EC%8A%A4-%EB%A7%88%EC%A7%80%EB%A7%89-%ED%9A%8C%EA%B3%A0-%ED%95%9C-%EB%8B%A8%EA%B3%84-%EB%8D%94-%EC%84%B1%EC%9E%A5%ED%95%9C-%EA%B0%9C%EB%B0%9C%EC%9E%90-%EB%90%98%EA%B8%B0" target="_blank" rel="noopener noreferrer">10. 항해 플러스 마지막 회고: 한 단계 더 성장한 개발자 되기<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></li><li><p>3기</p><ul><li>오소현님: <a href="https://velog.io/@osohyun0224/%EB%8D%94-%ED%81%B0-%EB%B0%94%EB%8B%A4-%EC%95%9E%EC%9C%BC%EB%A1%9C-%EB%82%98%EC%95%84%EA%B0%88-%EC%88%98-%EC%9E%88%EA%B2%8C-%EB%90%9C-%ED%95%AD%ED%95%B4-%ED%94%8C%EB%9F%AC%EC%8A%A4-%ED%94%84%EB%A1%A0%ED%8A%B8-3%EA%B8%B0-%EC%B5%9C%EC%A2%85-%ED%9A%8C%EA%B3%A0" target="_blank" rel="noopener noreferrer">더 큰 바다 앞으로 나아갈 수 있게 된,,, 🌊 [항해 플러스 프론트 3기 최종 회고]<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>정소윤님: <a href="https://soyoondaily.com/entry/%ED%95%AD%ED%95%B4-%ED%94%8C%EB%9F%AC%EC%8A%A4-%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-3%EA%B8%B0-%EC%88%98%EB%A3%8C-%ED%9B%84%EA%B8%B0" target="_blank" rel="noopener noreferrer">[항해 플러스] 프론트엔드 3기 수료 후기<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>박정우님: <a href="https://velog.io/@jwberry1113/10%EC%A3%BC%EA%B0%84%EC%9D%98-%ED%95%AD%ED%95%B4%EB%A5%BC-%EB%A7%88%EC%B9%98%EB%A9%B0" target="_blank" rel="noopener noreferrer">10주간의 항해를 마치며✍️<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>장효령님: <a href="https://velog.io/@ryeong1109/%ED%95%AD%ED%95%B4-%ED%94%8C%EB%9F%AC%EC%8A%A4-%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-%EC%86%94%EC%A7%81-%ED%9B%84%EA%B8%B0" target="_blank" rel="noopener noreferrer">항해 플러스 프론트엔드 솔직 후기<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></li><li><p>4기</p><ul><li>장원정님: <a href="https://velog.io/@jang_expedition/%ED%95%AD%ED%95%B4-%ED%94%8C%EB%9F%AC%EC%8A%A4-%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-4%EA%B8%B0-%EB%82%98%EC%9D%98-%ED%95%AD%ED%95%B4-%EC%9B%90%EC%A0%95%EA%B8%B0" target="_blank" rel="noopener noreferrer">[항해 플러스 프론트엔드 4기] 나의 항해 원정기<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>김혜연님: <a href="https://velog.io/@khy2106/31?utm_source=googlereview&amp;utm_medium=search&amp;utm_campaign=review&amp;utm_term=1&amp;utm_content=1&amp;gad_source=1&amp;gad_campaignid=21458524526" target="_blank" rel="noopener noreferrer">항해 플러스 프론트엔드 후기 (마지막) - 진짜 항해는 지금부터 시작<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></li><li><p>5기</p><ul><li>유한별님: <a href="https://velog.io/@hayou/%ED%95%AD%ED%95%B4%ED%94%8C%EB%9F%AC%EC%8A%A4-%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-5%EA%B8%B0-%ED%9A%8C%EA%B3%A0" target="_blank" rel="noopener noreferrer">항해플러스 프론트엔드 5기 회고<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>김영웅님: <a href="https://velog.io/@houndhollis/%ED%95%AD%ED%95%B4-%ED%94%8C%EB%9F%AC%EC%8A%A4-%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-%ED%9B%84%EA%B8%B0-5%EA%B8%B0-%EB%93%9C%EB%94%94%EC%96%B4-%EC%88%98%EB%A3%8C" target="_blank" rel="noopener noreferrer">항해 플러스 프론트엔드 후기 (5기) 드디어 수료<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>박수민님: <a href="https://s-o-o-min.tistory.com/entry/%ED%95%AD%ED%95%B4-%ED%94%8C%EB%9F%AC%EC%8A%A4-%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-%EB%A7%88%EB%AC%B4%EB%A6%AC-%ED%9A%8C%EA%B3%A0-%F0%9F%8C%8A-%EC%97%AC%EA%B8%B0%EA%B0%80-%EC%9C%A1%EC%A7%80%EC%9D%B8%EA%B0%80-%E2%9B%B5" target="_blank" rel="noopener noreferrer">[항해 플러스 프론트엔드] 마무리 회고 - 🌊 여기가 육지인가? ⛵<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></li></ul></div><h3 id="_2-멘토링" tabindex="-1"><a class="header-anchor" href="#_2-멘토링" aria-hidden="true">#</a> (2) 멘토링</h3><p>항해플러스에서는 매주 다양한 코치 분들과 멘토링을 진행할 수 있다.</p><p><img src="/TIL/assets/7.68b588d8.png" alt="image.png"></p><p>무수히 많은 멘토링의 흔적들이다… ㅋㅋ</p><p>기술적인 이야기, 커리어에 대한 이야기, 가끔은 개인적인 이야기 (고민상담 / 연애상담 / 결혼..?) 등 꽤 많은 종류의 이야기가 오고간다.</p><p><strong>혼자서 쓸쓸하게 개발하던 사람들을 연결시켜주는 게 항해플러스의 역할</strong>이라고 생각한다.</p><h3 id="_3-커뮤니티" tabindex="-1"><a class="header-anchor" href="#_3-커뮤니티" aria-hidden="true">#</a> (3) 커뮤니티</h3><p><strong>사실 항해플러스라는 교육의 제일 큰 의미는 “커뮤니티” 라고 생각한다.</strong> 위에서 언급한 5기 수료생 유한별님의 회고에 나오는 일 부분을 발췌했다.</p><div class="custom-container tip"><p class="custom-container-title">🤔 개발자를 연결하는 곳, 항해플러스.</p><p><img src="/TIL/assets/8.b2972cfe.png" alt="image.png"></p></div><p>성장을 갈망하는 개발자들을 연결하고 앞으로의 커리어를 혼자가 아닌 함께, 다같이 이어나갈 수 있도록 만들어준다는 것. 그래서 이들의 열기가 정말 뜨겁다. 코치로 함께하고 있지만, “나도 교육생으로 참여한다면 어떤 느낌일까?” 라는 생각을 매번 하게 된다.</p><p>그리고 수료생 이후에 학습메이트로 참여하여 학습에 더 적극적으로 참여할 수 있도록 도와주고, 함께 네트워킹을 참여하는 모습도 무척 인상적이다.</p><div class="custom-container tip"><p class="custom-container-title">학습메이트 회고</p><ul><li>황태영님: <a href="https://velog.io/@osohyun0224/%EB%82%B4-%EC%9E%90%EB%B6%80%EC%8B%AC-%ED%95%AD%ED%95%B4-%ED%94%8C%EB%9F%AC%EC%8A%A4-%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-%ED%95%99%EC%8A%B5%EB%A9%94%EC%9D%B4%ED%8A%B8-%ED%9B%84%EA%B8%B0" target="_blank" rel="noopener noreferrer">항해 플러스 프론트엔드 학습메이트 후기<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>오소현님: <a href="https://velog.io/@hty0525/%ED%95%99%EC%8A%B5%EB%A9%94%EC%9D%B4%ED%8A%B8-%ED%9A%8C%EA%B3%A0" target="_blank" rel="noopener noreferrer">학습메이트 회고<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>박지수님: <a href="https://until.blog/@susmisc14/%ED%95%AD%ED%95%B4-99-%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-%ED%95%99%EC%8A%B5%EB%A9%94%EC%9D%B4%ED%8A%B8-%ED%9A%8C%EA%B3%A0---%EB%A7%88%EC%A7%80%EB%A7%89" target="_blank" rel="noopener noreferrer">항해 99 프론트엔드 학습메이트 회고 - 마지막<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><h3 id="_4-내가-생각하는-교육" tabindex="-1"><a class="header-anchor" href="#_4-내가-생각하는-교육" aria-hidden="true">#</a> (4) 내가 생각하는 교육</h3><p>5기 마지막 멘토링에 어떤 분께서 “준일님께서 생각하는 좋은 교육이란 무엇인가요?” 라는 질문을 주신 적이 있다. <strong>좋은 교육은 정답을 제공하지 않는 교육이라고 생각한다.</strong></p><ul><li>좋은 코드를 알려주는 것이 아니라, <strong>좋은 코드를 찾아가는 방법</strong>을 알려주는 것.</li><li>경험을 해보는 것. 경험을 나의 것으로 만들 수 있도록 <strong>경험하는 과정</strong>을 만들어주는 것.</li><li>피드백을 해주는 것. <strong>정답이 아닌 방향</strong>으로.</li></ul><p>이런 생각은 우아한테크코스, 넥스트스텝, 부스트캠프 등의 교육과정에 교육생/리뷰어/멘토/강사 등으로 참여하면서 쌓아온 생각이다. 그리고 이런 경험과 생각을 항해에 최대한 녹여보려고 시도 중이다.</p><div class="custom-container tip"><p class="custom-container-title">👉🏻 항해플러스에 지원하고 싶은 분들께</p><p><img src="https://hanghae99.spartacodingclub.kr/images/plus/fe-og.jpg" alt="지원하기"></p><ul><li><a href="https://bit.ly/43OaDNK" target="_blank" rel="noopener noreferrer">지원하기<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>추천인코드: <code>43OaDNK</code></li></ul><p>위의 추천인 코드를 사용하면 <strong>30만원 할인</strong>을 받을 수 있습니다!</p><p>이 외에 교육과정에 대해 궁금한점이 있다면 아래의 연락처로 편하게 문의 주세요!</p><ul><li>오픈카톡 링크: <a href="https://open.kakao.com/me/junilhwang" target="_blank" rel="noopener noreferrer">https://open.kakao.com/me/junilhwang<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>이메일: junil.h@kakao.com</li></ul></div></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><!----></footer><!----><!--[--><!--[--><div></div><!----><!--]--><!--]--></main><!--]--></div><footer class="siteFooter"><div class="container"><p class="siteFooterCopyright"> Copyright © 2025 All Right <em>개발자 황준일</em></p><p class="siteFooterContact"> junil.h@kakao.com . +82-10-5764-4483 . <a href="https://github.com/junilhwang" target="_blank">GitHub</a> . <a href="https://github.com/junilhwang/TIL/" target="_blank">Repository</a></p></div></footer><!--]--><!----><!--]--></div>
    <script type="module" src="/TIL/assets/app.04106e09.js" defer></script>
  </body>
</html>
