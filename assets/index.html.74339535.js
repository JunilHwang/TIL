import{_ as n,o as s,c as a,a as t}from"./app.8cc31649.js";const p={},e=t(`<h1 id="\u110F\u1173\u11AF\u1105\u1175\u11AB\u110F\u1169\u1103\u1173-\u110C\u1169\u1100\u1161\u11A8\u1106\u1169\u110B\u1173\u11B7-\u110E\u116E\u1109\u1161\u11BC\u1112\u116A\u1105\u1173\u11AF-\u110C\u1165\u11BC\u1105\u1167\u11AF\u1112\u1161\u1100\u1175" tabindex="-1"><a class="header-anchor" href="#\u110F\u1173\u11AF\u1105\u1175\u11AB\u110F\u1169\u1103\u1173-\u110C\u1169\u1100\u1161\u11A8\u1106\u1169\u110B\u1173\u11B7-\u110E\u116E\u1109\u1161\u11BC\u1112\u116A\u1105\u1173\u11AF-\u110C\u1165\u11BC\u1105\u1167\u11AF\u1112\u1161\u1100\u1175" aria-hidden="true">#</a> [\uD074\uB9B0\uCF54\uB4DC \uC870\uAC01\uBAA8\uC74C] \uCD94\uC0C1\uD654\uB97C \uC815\uB82C\uD558\uAE30</h1><div class="custom-container tip"><p class="custom-container-title">\uC88B\uC740 \uCF54\uB4DC\uB294 \uD55C \uD3B8\uC758 \uAE00\uACFC \uAC19\uB2E4.</p><p>\uBB38\uB2E8\uC740 \uBB38\uC7A5\uC73C\uB85C, \uBB38\uC7A5\uC740 \uB2E8\uC5B4\uB85C, \uB2E8\uC5B4\uB294 \uAE00\uC790\uB85C \uAD6C\uC131\uB418\uB4EF\uC774, \uCF54\uB4DC\uB3C4 \uB3D9\uC77C\uD55C \uCD94\uC0C1\uD654 \uB808\uBCA8\uC774 \uBAA8\uC5EC \uB354 \uB192\uC740 \uCC28\uC6D0\uC758 \uCD94\uC0C1\uD654\uB97C \uB9CC\uB4E4\uC5B4\uC57C \uD55C\uB2E4.</p></div><h2 id="_1-\u1112\u1161\u11AB\u1100\u1173\u11AF\u1105\u1169-\u1109\u1162\u11BC\u1100\u1161\u11A8\u1112\u1162\u1107\u1169\u1102\u1173\u11AB-\u110E\u116E\u1109\u1161\u11BC\u1112\u116A-\u1109\u116E\u110C\u116E\u11AB" tabindex="-1"><a class="header-anchor" href="#_1-\u1112\u1161\u11AB\u1100\u1173\u11AF\u1105\u1169-\u1109\u1162\u11BC\u1100\u1161\u11A8\u1112\u1162\u1107\u1169\u1102\u1173\u11AB-\u110E\u116E\u1109\u1161\u11BC\u1112\u116A-\u1109\u116E\u110C\u116E\u11AB" aria-hidden="true">#</a> 1. \uD55C\uAE00\uB85C \uC0DD\uAC01\uD574\uBCF4\uB294 &quot;\uCD94\uC0C1\uD654 \uC218\uC900&quot;</h2><p>\uD55C\uAE00\uC740 \uAE30\uBCF8 \uC694\uC18C\uB294 \u201C\uC790\uC74C\u201D\uACFC \u201C\uBAA8\uC74C\u201D\uC774\uB2E4.</p><p>\uC790\uC74C\uACFC \uBAA8\uC74C\uC774 \uBAA8\uC5EC\uC11C \uAE00\uC790\uAC00 \uB418\uACE0, \uAE00\uC790\uAC00 \uBAA8\uC5EC \uB2E8\uC5B4\uAC00 \uB418\uACE0, \uB2E8\uC5B4\uAC00 \uBAA8\uC5EC \uBB38\uC7A5\uC774 \uB41C\uB2E4.</p><p>\uAC00\uB839, &quot;\uC548\uB155\uD558\uC138\uC694 \uD669\uC900\uC77C\uC785\uB2C8\uB2E4&quot;\uB77C\uB294 \uBB38\uC7A5\uC740 \uC774\uB807\uAC8C \uAD6C\uC131\uC774 \uB41C\uB2E4.</p><img src="https://www.plantuml.com/plantuml/svg/TLDBJiCm4Dtx52Phw05OSHDaWg68DguI0mj0AY81H14WqI10QKKHvQTA5Df25cN3LTZ5xXqOkqa8KHifayJlpNiputZ1uSJc6-KIck55MgQuKY9h5a8LOgwJLOgDaHz4OHNBZxhStnjTrt7KSsKuCF0smXYhsomHny66R9xBnidtftXvWgU1YODDPZdC8XPVt6HRj3HEWUl7Evo5S0R1xIV1ysSJu5IZXK8XvH-fbOkKsahVDFLAPyRytLnTK3sKDgwdI6nYScgdbKWVb8Mo7lcW8jqGmaqzGM-hW1xN0Rr-1k0UFcLZ2A7f0L1JkRNxIQQYzYGl-zfqYzdBMJzm0ozm-kUJk817uW3wqzGxeMosjRf3BKujaqvpACJYVzgfScvQkRtQsPcROzkPaSt35hUw8__PqFHqFIRgDe4JlQSSlHJ3QPsACkX8zyr0kmXPZ5DihwqMEMOhMP8S1FBEaxTxCXYALW1ZlnAleMWFeHzNr3hGeEfApJbmSp9nAUBC4mzVIg8HPlAZRbK-kjhWu6IoGBPfqGtWTrPPuhWDXs5IuXBZd9LrPcwAytXyVi0UHs5Nz48yxbxzPI23q0Arbk7u_G80" alt="uml diagram"><p>\uADF8\uB7FC \uC774 \uADDC\uCE59\uC774 \uAE68\uC9C0\uBA74 \uC5B4\uB5A4 \uBAA8\uC2B5\uC77C\uAE4C?</p><p><strong>\u201C\uC548\uB155\uD558\uC138\uC694\u3148\u3153\u3134\u3161\u3134\u314E\u3158\u3147\uC900\uC77C\u3147\u3163\u3142\uB2C8\uB2E4\u201D</strong> \uC774\uB77C\uB294 \uCD94\uC0C1\uD654 \uADDC\uCE59\uC774 \uAE68\uC9C4 \uBB38\uC7A5\uC744 \uD30C\uD5E4\uCCD0\uBCF4\uBA74 \uB2E4\uC74C\uACFC \uAC19\uB2E4.</p><img src="https://www.plantuml.com/plantuml/svg/TPF1RjD048Rl-nH3JurG3z0RKb0Vf1VJM6hKn8vSK_LKER0B0OUs4ZOqA8uIMaY2E5WYjAu45rx5Dy_u7Jh9EeqCuU9Txyxt-vz_v9r3rt3Svys6UE3kcqqJMWsZRWdHujFwNhrbM2viu9cYmVa668VWc4RDTChND0pfPHlmUqA3BxlM9eKTL64UNf1Cw5DGMO2MxJIDHXdCRYSqbYimLPrKlK_bB5MZnVCqLHUfUarN7aM_U9EgorIzGB-3_fMMVURO1oRxhLP1sw1Xcw84AFgT9J5Kgq8xXgsdXGLuihmaluzdKXXxRlt8SCsbnQ9iYuc2PUBh6wvcC24_chVuyHnbXyOUF3gkY9hvjyR2ptN0Vl9UaCKU5AskiwLR-B-jPOiDssv15hU1Pq5HzyyDVflmYZyaZlgYK2dfbUe0hoN9ICSC3u6JXdbeNaMOLasi4yWIZpM0Hd4UJkTT3pq6yMsWGTvKrc7eJ-Z33F9mfh-dIo7lJVKWQQ2A4TxJfQn_zkcpAd2WdiJBRYdonoVRvT2N2LaslzX7hB8I-sS87avdknPhO1m3lWi0nwSKUR3IfrTTZao87Sw5_umx" alt="uml diagram"><ul><li>\u201C\uC548\uB155\uD558\uC138\uC694\u201D \u2192 \uCC98\uC74C\uC5D0\uB294 \uB9E4\uB044\uB7FD\uAC8C \uC798 \uC77D\uD78C\uB2E4.</li><li>\u201C\u3148\u3153\u3134\u3161\u3134\u314E\u3158\u3147\uC900\uC77C\u3147\u3163\u3142\uB2C8\uB2E4\u201D \u2192 <strong>\uD55C \uAE00\uC790\uC529 \uACF1\uC539\uC5B4\uBCF4\uBA74\uC11C \uC790\uC74C \uBAA8\uC74C\uC744 \uC870\uD569\uD558\uC5EC \uC5B4\uB5A4 \uB2E8\uC5B4\uC778\uC9C0 \uC720\uCD94</strong>\uD55C\uB2E4</li><li>\u201C\uC800\uB294 \uD669\uC900\uC77C\uC785\uB2C8\uB2E4\u201D \uB77C\uACE0 \uD574\uC11D\uC774 \uC644\uB8CC\uB418\uC5C8\uC744 \uB54C, \u201C\uC548\uB155\uD558\uC138\uC694\u201D\uB97C \uD569\uCCD0\uC11C \uC804\uCCB4\uC801\uC778 \uD55C \uBB38\uC7A5\uC73C\uB85C \uD574\uC11D\uD560 \uC218 \uC788\uB2E4.</li></ul><p>\uCD94\uC0C1\uD654\uAC00 \uC798 \uB418\uC5B4\uC788\uB294 \uAE30\uC874\uC758 \uBB38\uC7A5\uC740 \uD55C\uAE00\uC774 \uC219\uB828\uB41C \uC0AC\uB78C\uB4E4\uC5D0\uAC8C \uAD49\uC7A5\uD788 \uC798 \uC77D\uD78C\uB2E4.</p><p>\uADF8\uB7F0\uB370 \uC774\uC81C <strong>\uCD94\uC0C1\uD654 \uC218\uC900\uC774 \uAE68\uC9C0\uBA74 \uC774\uB97C \uD574\uC11D\uD558\uAE30 \uC704\uD574 \uC798 \uC4F0\uC5EC\uC9C4 \uBB38\uC7A5\uBCF4\uB2E4 2~3\uBC30\uC758 \uC5D0\uB108\uC9C0</strong>\uB97C \uB354 \uC368\uC57C\uD55C\uB2E4.</p><p>\uC774\uAC74 <strong>\uCF54\uB4DC\uB97C \uC791\uC131\uD560 \uB54C\uC5D0\uB3C4 \uB9C8\uC8FC\uD560 \uC218 \uC788\uB294 \uBB38\uC81C</strong>\uB77C\uACE0 \uC0DD\uAC01\uD55C\uB2E4.</p><h2 id="_2-\u1106\u116E\u11AB\u110C\u1166\u1100\u1161-\u1103\u116C\u1102\u1173\u11AB-\u110F\u1169\u1103\u1173" tabindex="-1"><a class="header-anchor" href="#_2-\u1106\u116E\u11AB\u110C\u1166\u1100\u1161-\u1103\u116C\u1102\u1173\u11AB-\u110F\u1169\u1103\u1173" aria-hidden="true">#</a> 2. \uBB38\uC81C\uAC00 \uB418\uB294 \uCF54\uB4DC</h2><p>React\uC5D0\uC11C \uBB34\uD55C \uC2A4\uD06C\uB864\uC744 \uAD6C\uD604\uD558\uB294 \uCEE4\uC2A4\uD140 \uD6C5\uC744 \uC0B4\uD3B4\uBCF4\uC790.</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// useThemeInfiniteScroll.ts - \uBB38\uC81C\uAC00 \uC788\uB294 \uCF54\uB4DC</span>
<span class="token keyword">const</span> <span class="token function-variable function">useThemeInfiniteScroll</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  queryKey<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function-variable function">queryFn</span><span class="token operator">:</span> <span class="token punctuation">(</span>page<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>ThemeProductsResponse<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  threshold <span class="token operator">=</span> <span class="token number">0.8</span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Level 2: useQuery \uD6C5\uC744 \uC9C1\uC811 \uC0AC\uC6A9</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>
    data<span class="token operator">:</span> queryData<span class="token punctuation">,</span>
    error<span class="token operator">:</span> queryError<span class="token punctuation">,</span>
    isLoading<span class="token operator">:</span> queryLoading<span class="token punctuation">,</span>
    refetch<span class="token punctuation">,</span>
  <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    queryKey<span class="token punctuation">,</span>
    <span class="token function-variable function">queryFn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">queryFn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Level 1: \uC6D0\uC2DC \uC0C1\uD0DC\uB4E4\uC744 \uC9C1\uC811 \uAD00\uB9AC</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>products<span class="token punctuation">,</span> setProducts<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>Product<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>currentPage<span class="token punctuation">,</span> setCurrentPage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>loading<span class="token punctuation">,</span> setLoading<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>moreAvailable<span class="token punctuation">,</span> setMoreAvailable<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> observerRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLDivElement<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Level 1: \uBCF5\uC7A1\uD55C \uBE44\uC988\uB2C8\uC2A4 \uB85C\uC9C1\uC744 \uC9C1\uC811 \uAD6C\uD604</span>
  <span class="token keyword">const</span> fetchNext <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>loading <span class="token operator">||</span> <span class="token operator">!</span>moreAvailable<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

    <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> nextPage <span class="token operator">=</span> currentPage <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">queryFn</span><span class="token punctuation">(</span>nextPage<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>products<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setProducts</span><span class="token punctuation">(</span>prev <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token operator">...</span>prev<span class="token punctuation">,</span> <span class="token operator">...</span>response<span class="token punctuation">.</span>products<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setCurrentPage</span><span class="token punctuation">(</span>nextPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setMoreAvailable</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>hasMore<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">setMoreAvailable</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;Error fetching next page:&#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>currentPage<span class="token punctuation">,</span> loading<span class="token punctuation">,</span> moreAvailable<span class="token punctuation">,</span> queryFn<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Level 2: useIntersectionObserver \uD6C5\uC744 \uC9C1\uC811 \uC0AC\uC6A9</span>
  <span class="token function">useIntersectionObserver</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    targetRef<span class="token operator">:</span> observerRef<span class="token punctuation">,</span>
    onIntersect<span class="token operator">:</span> fetchNext<span class="token punctuation">,</span>
    enabled<span class="token operator">:</span> moreAvailable <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>loading <span class="token operator">&amp;&amp;</span> products<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
    threshold<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    products<span class="token punctuation">,</span>
    loading<span class="token operator">:</span> loading <span class="token operator">||</span> queryLoading<span class="token punctuation">,</span>
    moreAvailable<span class="token punctuation">,</span>
    error<span class="token operator">:</span> error <span class="token operator">||</span> queryError<span class="token punctuation">,</span>
    observerRef<span class="token punctuation">,</span>
    fetchNext<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\uC774 \uCF54\uB4DC\uB294 \uCD94\uC0C1\uD654 \uC218\uC900\uC774 \uC815\uB82C\uB418\uC9C0 \uC54A\uC740 <strong>\uC11C\uB85C \uB2E4\uB978 \uCD94\uC0C1\uD654 \uB808\uBCA8\uB85C \uC870\uD569\uB41C \uCF54\uB4DC\uC774\uB2E4.</strong></p><ul><li>Level 1: <code>useState</code> \uB4F1\uC758 \uAE30\uBCF8 \uD6C5\uACFC \uC774\uB97C \uC0AC\uC6A9\uD558\uB294 \uBCF5\uC7A1\uD55C \uD398\uC774\uC9D5 \uB85C\uC9C1\uACFC \uC5D0\uB7EC\uCC98\uB9AC</li><li>Level 2: <code>useQuery</code>, <code>useIntersectionObserver</code> \uB4F1\uC758 \uCEE4\uC2A4\uD140 \uD6C5</li><li>Level 3: 1~2\uB97C \uAC00\uC838\uB2E4 \uC0AC\uC6A9\uD55C <code>useThemeInfiniteScroll</code> \uD6C5 \uC790\uCCB4</li></ul><img src="https://www.plantuml.com/plantuml/svg/TL9DIyD04BtlhnZJgnvgRps8u4aGn8-ZbpHkDBZTIB8LH8IsDXXGHB71L69fKQc21w4g5VqtkNKd_y5DgTQFkeVPOVRntfl7phf2TqIfoCY4sAH52jjCjpWX3ZM4pZSO1Ms1xb06MGrq5rZQPo5ZceOwi4S0u1kqvD8LeGiw2QfRfkRWdjCPA-Z6blOBBBlFs6mdGGJ9IOXNJzW9GBOZx5GqiZ_6mVJ8mNJg8FKmpi5IYJgxsj_vF1VKSTN8ilbYmQNE3dN6A-L6IZd86CP_IgjfOlFSjBWbw8hXs8mD28SfJKtDV9BaGLDxOUiCiFg0b_SQ6Uxn4vC4T_sty0j3k2qe56mXxA9wbWyzR4Lvm5gaSW9vT2DlUu0lTJoe98qwe1_YJLab2Mce_MuNBquLk8dDsXgN7HzVGsKZyAKN9468jHvUrcFFZxtpkFOKU-r1FOczCFOE1qJlgeczwzYhoYDVoMdOA4F_iO5NnuJCKhwk_iq7" alt="uml diagram"><p>\uB9C8\uCE58 \uBB38\uC7A5\uC744 \uC4F8 \uB54C &quot;<strong>\uC548\uB155\uD558\uC138\uC694\u3148\u3153\u3134\u3161\u3134\u314E\u3158\u3147\uC900\uC77C\u3147\u3163\u3142\uB2C8\uB2E4</strong>&quot; \uCC98\uB7FC \uC77D\uAE30 \uC5B4\uB824\uC6B4 \uD615\uD0DC\uC758 \uD6C5\uC774\uB77C\uACE0 \uD560 \uC218 \uC788\uB2E4. \uC774\uAC78 \u201C\uC548\uB155\uD558\uC138\uC694 \uC800\uB294 \uD669\uC900\uC77C\uC785\uB2C8\uB2E4\u201D \uB85C \uAC1C\uC120\uD558\uB294 \uACFC\uC815\uC774 \uD544\uC694\uD558\uB2E4.</p><div class="custom-container tip"><p class="custom-container-title">\uD30C\uC0DD\uB418\uB294 \uBB38\uC81C</p><p>\uC0AC\uC2E4 \uCD94\uC0C1\uD654 \uC218\uC900\uACFC \uAD00\uB828\uB41C \uBD80\uBD84 \uB9D0\uACE0\uB3C4 \uC544\uB798\uC640 \uAC19\uC740 \uC7A0\uC7AC\uC801\uC778 \uBB38\uC81C\uB97C \uAC00\uC9C0\uACE0 \uC788\uB2E4. \uCD94\uC0C1\uD654 \uC218\uC900\uC774 \uB0AE\uB2E4\uB294 \uAC83\uC740 \uB2E8\uC77C \uCC45\uC784 \uC6D0\uCE59\uC5D0 \uC704\uBC30\uB418\uB294 \uC0C1\uD669\uACFC \uB9DE\uBB3C\uB9B4 \uC218 \uC788\uB2E4. <strong>\uD604\uC7AC useThemeInfiniteScroll \uD6C5\uC740 \uC5EC\uB7EC\uAC00\uC9C0 \uC77C\uC744 \uD55C \uBC88\uC5D0 \uC218\uD589\uD558\uACE0 \uC788\uB2E4.</strong></p><ul><li>api \uD638\uCD9C \uB370\uC774\uD130\uB97C \uC9C1\uC811\uC801\uC73C\uB85C \uAD00\uB9AC\uD55C\uB2E4.</li><li>api \uD638\uCD9C\uC744 \uC9C1\uC811 \uC218\uD589\uD558\uACE0 \uC788\uB2E4.</li><li>\uB2E4\uC591\uD55C \uD6C5\uC744 \uC870\uD569\uD558\uACE0 \uC788\uB2E4.</li></ul><p>\uAC1C\uBC1C \uC870\uC9C1\uC744 \uD1B5\uD574 \uBE44\uC720\uD574\uBCF4\uC790\uBA74, \uD300\uC7A5\uC774 \uD300\uC7A5\uC758 \uC5ED\uD560 \uC678\uC758 \uB2E4\uC591\uD55C \uC7A1\uC77C(?)\uC744 \uC218\uD589\uD558\uB294 \uBAA8\uC2B5\uC774\uB2E4. <s>\uC0AC\uC2E4 \uC778\uB825\uC774 \uBD80\uC871\uD558\uBA74 \uC774\uB7F0 \uC77C\uC774 \uBC1C\uC0DD\uD55C\uB2E4.</s></p><p>\uC2E0\uC785 \uAC1C\uBC1C\uC790\uB97C \uCC44\uC6A9\uD558\uC5EC(=\uCEE4\uC2A4\uD140\uD6C5\uC744 \uB9CC\uB4E4\uC5B4\uC11C) \uC774 \uBB38\uC81C\uB97C \uD574\uACB0 \uD558\uAC70\uB098 \uD639\uC740 \uB2E4\uB978 \uAC1C\uBC1C\uC790(=\uB2E4\uB978 \uD6C5)\uC5D0\uAC8C \uC774 \uC77C\uC744 \uC704\uC784\uD560 \uC218 \uC788\uB2E4.</p></div><h2 id="_3-\u1100\u1162\u1109\u1165\u11AB\u1103\u116C\u11AB-\u1106\u1169\u1109\u1173\u11B8" tabindex="-1"><a class="header-anchor" href="#_3-\u1100\u1162\u1109\u1165\u11AB\u1103\u116C\u11AB-\u1106\u1169\u1109\u1173\u11B8" aria-hidden="true">#</a> 3. \uAC1C\uC120\uB41C \uBAA8\uC2B5</h2><h3 id="\u110C\u1165\u11BC\u1105\u1167\u11AF\u1103\u116C\u11AB-\u110E\u116E\u1109\u1161\u11BC\u1112\u116A-\u1105\u1166\u1107\u1166\u11AF\u1100\u116A-\u110C\u1169\u1112\u1161\u11B8" tabindex="-1"><a class="header-anchor" href="#\u110C\u1165\u11BC\u1105\u1167\u11AF\u1103\u116C\u11AB-\u110E\u116E\u1109\u1161\u11BC\u1112\u116A-\u1105\u1166\u1107\u1166\u11AF\u1100\u116A-\u110C\u1169\u1112\u1161\u11B8" aria-hidden="true">#</a> \uC815\uB82C\uB41C \uCD94\uC0C1\uD654 \uB808\uBCA8\uACFC \uC870\uD569</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Level 2 (\uAC01\uAC01 \uBA85\uD655\uD55C \uB2E8\uC77C \uCC45\uC784):
\u251C\u2500\u2500 useInitThemeData (\uCD08\uAE30 \uB370\uC774\uD130 fetching)
\u251C\u2500\u2500 useInitNextThemeData (\uB2E4\uC74C \uD398\uC774\uC9C0 \uB370\uC774\uD130 \uCFFC\uB9AC)
\u2514\u2500\u2500 useThemeData (\uD14C\uB9C8 \uB370\uC774\uD130 \uC0C1\uD0DC \uAD00\uB9AC)

Level 3 (Level 2 \uD6C5\uB4E4\uC758 \uC870\uD569):
\u2514\u2500\u2500 useThemeInfiniteScroll (\uD6C5\uB4E4\uC744 \uC870\uD569\uD558\uC5EC \uC644\uC804\uD55C \uAE30\uB2A5 \uC81C\uACF5)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="step-1-level-1-\u110B\u116F\u11AB\u110C\u1161\u110C\u1165\u11A8-\u1112\u116E\u11A8\u1103\u1173\u11AF-\u1100\u1161\u11A8\u1100\u1161\u11A8-\u1112\u1161\u1102\u1161\u110B\u1174-\u1106\u1167\u11BC\u1112\u116A\u11A8\u1112\u1161\u11AB-\u110E\u1162\u11A8\u110B\u1175\u11B7" tabindex="-1"><a class="header-anchor" href="#step-1-level-1-\u110B\u116F\u11AB\u110C\u1161\u110C\u1165\u11A8-\u1112\u116E\u11A8\u1103\u1173\u11AF-\u1100\u1161\u11A8\u1100\u1161\u11A8-\u1112\u1161\u1102\u1161\u110B\u1174-\u1106\u1167\u11BC\u1112\u116A\u11A8\u1112\u1161\u11AB-\u110E\u1162\u11A8\u110B\u1175\u11B7" aria-hidden="true">#</a> Step 1) Level 1 - \uC6D0\uC790\uC801 \uD6C5\uB4E4 (\uAC01\uAC01 \uD558\uB098\uC758 \uBA85\uD655\uD55C \uCC45\uC784)</h3><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 2-1. \uCD08\uAE30 \uB370\uC774\uD130 fetching\uB9CC \uB2F4\uB2F9</span>
<span class="token keyword">const</span> <span class="token function-variable function">useInitThemeData</span> <span class="token operator">=</span> <span class="token punctuation">(</span>themeId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token generic-function"><span class="token function">useSuspenseApiQuery</span><span class="token generic class-name"><span class="token operator">&lt;</span>ThemeProductResponse<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token constant">API_ENDPOINTS</span><span class="token punctuation">.</span><span class="token constant">THEME_PRODUCTS</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>themeId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
    queryKey<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;theme-products&quot;</span><span class="token punctuation">,</span> themeId<span class="token punctuation">,</span> <span class="token string">&quot;initial&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 2-2. \uB2E4\uC74C \uD398\uC774\uC9C0 \uB370\uC774\uD130 \uCFFC\uB9AC\uB9CC \uB2F4\uB2F9</span>
<span class="token keyword">const</span> <span class="token function-variable function">useInitNextThemeData</span> <span class="token operator">=</span> <span class="token punctuation">(</span>themeId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> cursor<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token generic-function"><span class="token function">useApiQuery</span><span class="token generic class-name"><span class="token operator">&lt;</span>ThemeProductResponse<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token constant">API_ENDPOINTS</span><span class="token punctuation">.</span><span class="token constant">THEME_PRODUCTS</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>themeId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>cursor <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">?cursor=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>cursor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
    queryKey<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;theme-products&quot;</span><span class="token punctuation">,</span> themeId<span class="token punctuation">,</span> cursor<span class="token punctuation">]</span><span class="token punctuation">,</span>
    enabled<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 2-3. \uD14C\uB9C8 \uB370\uC774\uD130 \uC0C1\uD0DC \uAD00\uB9AC\uB9CC \uB2F4\uB2F9</span>
<span class="token keyword">const</span> useThemeData <span class="token operator">=</span> <span class="token punctuation">(</span>
  initData<span class="token operator">:</span> ReturnType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> useInitThemeData<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  initialCursor<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>products<span class="token punctuation">,</span> setProducts<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>Product<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>cursor<span class="token punctuation">,</span> setCursor<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initialCursor<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>moreAvailable<span class="token punctuation">,</span> setMoreAvailable<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>loading<span class="token punctuation">,</span> setLoading<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>error<span class="token punctuation">,</span> setError<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \uBA85\uD655\uD55C \uC5ED\uD560 \uBD84\uB9AC\uB41C \uB0B4\uBD80 \uD568\uC218\uB4E4</span>
  <span class="token keyword">const</span> <span class="token function-variable function">start</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setError</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">onError</span> <span class="token operator">=</span> <span class="token punctuation">(</span>err<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">end</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> append <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span>newProducts<span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> newCursor<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span> hasMore<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setProducts</span><span class="token punctuation">(</span><span class="token punctuation">(</span>prev<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> existingIds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>prev<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> filtered <span class="token operator">=</span> newProducts<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
          <span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>existingIds<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>prev<span class="token punctuation">,</span> <span class="token operator">...</span>filtered<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setCursor</span><span class="token punctuation">(</span>newCursor<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setMoreAvailable</span><span class="token punctuation">(</span>hasMore <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token operator">!</span>newProducts<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> fetchNext <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span>
      <span class="token function-variable function">request</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>QueryObserverResult<span class="token operator">&lt;</span>ThemeProductResponse<span class="token punctuation">,</span> Error<span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>moreAvailable <span class="token operator">||</span> loading<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> data <span class="token operator">=</span> result<span class="token punctuation">.</span>data <span class="token keyword">as</span> ThemeProductResponse<span class="token punctuation">;</span>
          <span class="token function">append</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>list<span class="token punctuation">,</span> data<span class="token punctuation">.</span>cursor<span class="token punctuation">,</span> data<span class="token punctuation">.</span>hasMoreList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>onError<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>append<span class="token punctuation">,</span> loading<span class="token punctuation">,</span> moreAvailable<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \uCD08\uAE30 \uB370\uC774\uD130 \uC124\uC815</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>initData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">append</span><span class="token punctuation">(</span>initData<span class="token punctuation">.</span>list<span class="token punctuation">,</span> initData<span class="token punctuation">.</span>cursor <span class="token operator">??</span> <span class="token keyword">null</span><span class="token punctuation">,</span> initData<span class="token punctuation">.</span>hasMoreList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>initData<span class="token punctuation">,</span> append<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    data<span class="token operator">:</span> products<span class="token punctuation">,</span>
    cursor<span class="token punctuation">,</span>
    moreAvailable<span class="token punctuation">,</span>
    loading<span class="token punctuation">,</span>
    error<span class="token punctuation">,</span>
    fetchNext<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="step-2-level-2-\u110C\u1169\u1112\u1161\u11B8-\u1112\u116E\u11A8\u1103\u1173\u11AF-level-1-\u1112\u116E\u11A8\u1103\u1173\u11AF\u110B\u1174-\u110C\u1169\u1112\u1161\u11B8" tabindex="-1"><a class="header-anchor" href="#step-2-level-2-\u110C\u1169\u1112\u1161\u11B8-\u1112\u116E\u11A8\u1103\u1173\u11AF-level-1-\u1112\u116E\u11A8\u1103\u1173\u11AF\u110B\u1174-\u110C\u1169\u1112\u1161\u11B8" aria-hidden="true">#</a> Step 2) Level 2 - \uC870\uD569 \uD6C5\uB4E4 (Level 1 \uD6C5\uB4E4\uC758 \uC870\uD569)</h3><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 3. Level 2 \uD6C5\uB4E4\uC744 \uC870\uD569\uD558\uC5EC \uC644\uC804\uD55C \uBB34\uD55C \uC2A4\uD06C\uB864 \uAE30\uB2A5 \uC81C\uACF5</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useThemeInfiniteScroll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  themeId<span class="token punctuation">,</span>
  initialCursor <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  threshold <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> ThemeInfiniteScrollOptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> observerRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLDivElement <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Level 2 \uD6C5\uB4E4\uC744 \uC870\uD569</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> initialData <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useInitThemeData</span><span class="token punctuation">(</span>themeId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> theme <span class="token operator">=</span> <span class="token function">useThemeData</span><span class="token punctuation">(</span>initialData<span class="token punctuation">,</span> initialCursor<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> nextTheme <span class="token operator">=</span> <span class="token function">useInitNextThemeData</span><span class="token punctuation">(</span>themeId<span class="token punctuation">,</span> theme<span class="token punctuation">.</span>cursor<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// \uAC01 \uD6C5\uC758 \uAE30\uB2A5\uC744 \uC5F0\uACB0</span>
  <span class="token keyword">const</span> fetchNextTheme <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> theme<span class="token punctuation">.</span><span class="token function">fetchNext</span><span class="token punctuation">(</span>nextTheme<span class="token punctuation">.</span>refetch<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>nextTheme<span class="token punctuation">.</span>refetch<span class="token punctuation">,</span> theme<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Level 1 \uD6C5\uACFC \uC5F0\uACB0</span>
  <span class="token function">useIntersectionObserver</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    targetRef<span class="token operator">:</span> observerRef<span class="token punctuation">,</span>
    onIntersect<span class="token operator">:</span> fetchNextTheme<span class="token punctuation">,</span>
    enabled<span class="token operator">:</span> theme<span class="token punctuation">.</span>moreAvailable <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>theme<span class="token punctuation">.</span>loading <span class="token operator">&amp;&amp;</span> theme<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
    threshold<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>theme<span class="token punctuation">,</span>
    loading<span class="token operator">:</span> theme<span class="token punctuation">.</span>loading <span class="token operator">??</span> nextTheme<span class="token punctuation">.</span>isLoading<span class="token punctuation">,</span>
    error<span class="token operator">:</span> theme<span class="token punctuation">.</span>error <span class="token operator">??</span> nextTheme<span class="token punctuation">.</span>error<span class="token punctuation">,</span>
    observerRef<span class="token punctuation">,</span>
    fetchNext<span class="token operator">:</span> fetchNextTheme<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://www.plantuml.com/plantuml/svg/VP6nRi8m48PtFyNXp0nWgKE72YGMf0g4mbwPy8TQCYQodL1KTUihz04OaJgq0o-5u1r862f72Htl_azttza3vwNr-LgpZd_56fHfgGnZ5ecNPgL1_1a5DFKuIKS6snTTrJsAy92ADALtHaG1dZkCZOTrPKjjp7JXO0jOtiJYt6Km3iDCpNBO7ITgGdyX-sYnwjUj-XGbIUbrnqhvUNNZI7h9s_C9tlvbWgnDHzHr14KBiPJjEhTHOvEgSYtYn6wqlWqDdhZRVGflUoH-EdwVFtyv2xerI5JGUVzp-JfmnWOmo_9hhm00" alt="uml diagram"><div class="custom-container tip"><p class="custom-container-title">\uC815\uB9AC\uD558\uAE30</p><ol><li><p>\uBA85\uD655\uD55C \uCD94\uC0C1\uD654 \uB808\uBCA8 \uBD84\uB9AC</p><ul><li><code>Level 1:</code> useIntersectionObserver, useSuspenseApiQuery, useApiQuery</li><li><code>Level 2:</code> useInitThemeData, useInitNextThemeData, useThemeData</li><li><code>Level 3:</code> useThemeInfiniteScroll (\uC870\uD569\uC744 \uD1B5\uD55C \uC644\uC804\uD55C \uAE30\uB2A5)</li></ul></li><li><p>\uB2E8\uC77C \uCC45\uC784 \uC6D0\uCE59 \uC900\uC218</p><ul><li><code>useInitThemeData</code>: \uCD08\uAE30 \uB370\uC774\uD130 fetching\uB9CC</li><li><code>useInitNextThemeData</code>: \uB2E4\uC74C \uD398\uC774\uC9C0 \uCFFC\uB9AC\uB9CC</li><li><code>useThemeData</code>: \uB370\uC774\uD130 \uC0C1\uD0DC \uAD00\uB9AC\uB9CC</li><li><code>useThemeInfiniteScroll</code>: \uC870\uD569\uC744 \uD1B5\uD55C \uC5F0\uACB0\uB9CC</li></ul></li><li><p>\uC870\uD569 \uAC00\uB2A5\uC131\uACFC \uC7AC\uC0AC\uC6A9\uC131</p><ul><li><code>useThemeData</code>\uB294 \uB2E4\uB978 \uB370\uC774\uD130 \uD0C0\uC785\uC5D0\uB3C4 \uC7AC\uC0AC\uC6A9 \uAC00\uB2A5</li><li>\uAC01 \uD6C5\uC744 \uB3C5\uB9BD\uC801\uC73C\uB85C \uD14C\uC2A4\uD2B8 \uAC00\uB2A5</li><li>\uD544\uC694\uC5D0 \uB530\uB77C \uC77C\uBD80 \uD6C5\uB9CC \uC0AC\uC6A9 \uAC00\uB2A5</li></ul></li><li><p>\uAC00\uB3C5\uC131 \uD5A5\uC0C1</p><ul><li>AS-IS: &quot;\uC548\uB155\uD558\uC138\uC694\u3148\u3153\u3134\u3161\u3134\u314E\u3158\u3147\uC900\uC77C\u3147\u3163\u3142\uB2C8\uB2E4&quot;</li><li>TO-BE: &quot;\uC548\uB155\uD558\uC138\uC694. \uC800\uB294 \uAC1C\uBC1C\uC790\uC785\uB2C8\uB2E4.&quot;</li></ul></li></ol></div><h2 id="_4-\u110E\u116E\u1109\u1161\u11BC\u1112\u116A-\u110C\u1165\u11BC\u1105\u1167\u11AF\u110B\u1174-\u1112\u1162\u11A8\u1109\u1175\u11B7-\u110B\u116F\u11AB\u110E\u1175\u11A8" tabindex="-1"><a class="header-anchor" href="#_4-\u110E\u116E\u1109\u1161\u11BC\u1112\u116A-\u110C\u1165\u11BC\u1105\u1167\u11AF\u110B\u1174-\u1112\u1162\u11A8\u1109\u1175\u11B7-\u110B\u116F\u11AB\u110E\u1175\u11A8" aria-hidden="true">#</a> 4. \uCD94\uC0C1\uD654 \uC815\uB82C\uC758 \uD575\uC2EC \uC6D0\uCE59</h2><h3 id="_1-\u1100\u1161\u11C0\u110B\u1173\u11AB-\u1105\u1166\u1107\u1166\u11AF\u1101\u1175\u1105\u1175\u1106\u1161\u11AB-\u110C\u1169\u1112\u1161\u11B8\u1112\u1161\u110C\u1161" tabindex="-1"><a class="header-anchor" href="#_1-\u1100\u1161\u11C0\u110B\u1173\u11AB-\u1105\u1166\u1107\u1166\u11AF\u1101\u1175\u1105\u1175\u1106\u1161\u11AB-\u110C\u1169\u1112\u1161\u11B8\u1112\u1161\u110C\u1161" aria-hidden="true">#</a> (1) \uAC19\uC740 \uB808\uBCA8\uB07C\uB9AC\uB9CC \uC870\uD569\uD558\uC790</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u2705 \uC62C\uBC14\uB978 \uC870\uD569:
useInitThemeData + useThemeData + useInitNextThemeData = useThemeInfiniteScroll

\u274C \uC798\uBABB\uB41C \uC870\uD569 (\uAE30\uC874):
useState + useSuspenseApiQuery + \uBCF5\uC7A1\uD55C \uB85C\uC9C1 + useIntersectionObserver = ???
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-\u1100\u1161\u11A8-\u1112\u116E\u11A8\u110B\u1174-\u1106\u1167\u11BC\u1112\u116A\u11A8\u1112\u1161\u11AB-\u1103\u1161\u11AB\u110B\u1175\u11AF-\u110E\u1162\u11A8\u110B\u1175\u11B7" tabindex="-1"><a class="header-anchor" href="#_2-\u1100\u1161\u11A8-\u1112\u116E\u11A8\u110B\u1174-\u1106\u1167\u11BC\u1112\u116A\u11A8\u1112\u1161\u11AB-\u1103\u1161\u11AB\u110B\u1175\u11AF-\u110E\u1162\u11A8\u110B\u1175\u11B7" aria-hidden="true">#</a> (2) \uAC01 \uD6C5\uC758 \uBA85\uD655\uD55C \uB2E8\uC77C \uCC45\uC784</h3><ul><li><strong>useInitThemeData</strong>: &quot;\uCD08\uAE30 \uB370\uC774\uD130\uB9CC \uAC00\uC838\uC628\uB2E4&quot;</li><li><strong>useThemeData</strong>: &quot;\uD14C\uB9C8 \uB370\uC774\uD130 \uC0C1\uD0DC\uB9CC \uAD00\uB9AC\uD55C\uB2E4&quot;</li><li><strong>useInitNextThemeData</strong>: &quot;\uB2E4\uC74C \uD398\uC774\uC9C0 \uCFFC\uB9AC\uB9CC \uC900\uBE44\uD55C\uB2E4&quot;</li><li><strong>useThemeInfiniteScroll</strong>: &quot;\uC704 \uD6C5\uB4E4\uC744 \uC870\uD569\uD574\uC11C \uC644\uC804\uD55C \uAE30\uB2A5\uC744 \uC81C\uACF5\uD55C\uB2E4&quot;</li></ul><h3 id="_3-\u110C\u1169\u1112\u1161\u11B8\u110B\u1173\u11AF-\u1110\u1169\u11BC\u1112\u1161\u11AB-\u1112\u116A\u11A8\u110C\u1161\u11BC\u1109\u1165\u11BC" tabindex="-1"><a class="header-anchor" href="#_3-\u110C\u1169\u1112\u1161\u11B8\u110B\u1173\u11AF-\u1110\u1169\u11BC\u1112\u1161\u11AB-\u1112\u116A\u11A8\u110C\u1161\u11BC\u1109\u1165\u11BC" aria-hidden="true">#</a> (3) \uC870\uD569\uC744 \uD1B5\uD55C \uD655\uC7A5\uC131</h3><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// \uB2E4\uB978 \uBC29\uC2DD\uC73C\uB85C\uB3C4 \uC870\uD569 \uAC00\uB2A5</span>
<span class="token keyword">const</span> <span class="token function-variable function">MyComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> initialData <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useInitThemeData</span><span class="token punctuation">(</span>themeId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> theme <span class="token operator">=</span> <span class="token function">useThemeData</span><span class="token punctuation">(</span>initialData<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \uB2E4\uB978 \uC870\uAC74\uC73C\uB85C \uC0AC\uC6A9</span>
  <span class="token keyword">const</span> <span class="token function-variable function">handleButtonClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    theme<span class="token punctuation">.</span><span class="token function">fetchNext</span><span class="token punctuation">(</span>someOtherRefetchFunction<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u1106\u1161\u1106\u116E\u1105\u1175" tabindex="-1"><a class="header-anchor" href="#\u1106\u1161\u1106\u116E\u1105\u1175" aria-hidden="true">#</a> \uB9C8\uBB34\uB9AC</h2><p>\uC88B\uC740 \uCF54\uB4DC\uB294 \uD55C\uAE00\uC744 \uC77D\uB294 \uAC83\uCC98\uB7FC \uC790\uC5F0\uC2A4\uB7FD\uAC8C \uC77D\uD600\uC57C \uD55C\uB2E4. <strong>\uAC19\uC740 \uCD94\uC0C1\uD654 \uB808\uBCA8\uC758 \uD6C5\uB4E4\uC774 \uBAA8\uC5EC \uB354 \uB192\uC740 \uB808\uBCA8\uC758 \uAE30\uB2A5\uC744 \uAD6C\uC131</strong>\uD560 \uB54C, \uCF54\uB4DC\uC758 \uC758\uB3C4\uAC00 \uBA85\uD655\uD574\uC9C0\uACE0 \uC720\uC9C0\uBCF4\uC218\uAC00 \uC26C\uC6CC\uC9C4\uB2E4. \uAC01 \uD6C5\uC774 \uBA85\uD655\uD55C \uB2E8\uC77C \uCC45\uC784\uC744 \uAC00\uC9C0\uACE0, \uC774\uB4E4\uC774 \uC870\uD569\uB418\uC5B4 \uC644\uC804\uD55C \uAE30\uB2A5\uC744 \uB9CC\uB4DC\uB294 \uAD6C\uC870.</p><p>\uC774\uAC83\uC774 \uBC14\uB85C <strong>\uCD94\uC0C1\uD654\uB97C \uC815\uB82C\uD558\uB294 \uBC29\uBC95</strong>\uC774\uB77C\uACE0 \uC0DD\uAC01\uD55C\uB2E4.</p><p>\uD6C5(\uD639\uC740 \uD568\uC218)\uB294 \uB808\uACE0 \uBE14\uB85D\uACFC \uBE44\uC2B7\uD558\uB2E4. \uAC01\uAC01\uC774 \uBA85\uD655\uD55C \uAE30\uB2A5\uC744 \uAC00\uC9C0\uACE0, \uC774\uB4E4\uC744 \uC870\uD569\uD574\uC11C \uB354 \uBCF5\uC7A1\uD55C \uAE30\uB2A5\uC744 \uB9CC\uB4E4\uC5B4\uC57C \uD55C\uB2E4. \uD558\uB098\uC758 \uBE14\uB85D\uC5D0 \uBAA8\uB4E0 \uAE30\uB2A5\uC744 \uC6B0\uACA8\uB123\uC9C0 \uB9D0\uACE0, \uC791\uC740 \uBE14\uB85D\uB4E4\uC744 \uC870\uD569\uD574\uC11C \uC544\uB984\uB2E4\uC6B4 \uAD6C\uC870\uBB3C\uC744 \uB9CC\uB4E4 \uC218 \uC788\uB2E4.</p>`,42),o=[e];function c(l,i){return s(),a("div",null,o)}var r=n(p,[["render",c],["__file","index.html.vue"]]);export{r as default};
