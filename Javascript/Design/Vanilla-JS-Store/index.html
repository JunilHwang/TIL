<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vanilla Javascript로 상태관리 시스템 만들기 | 개발자 황준일</title>
    <meta name="generator" content="VuePress 1.6.0">
    <link rel="alternate" type="application/rss+xml" href="https://junilhwang.github.io/TIL/rss.xml" title="개발자 황준일 RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://junilhwang.github.io/TIL/feed.atom" title="개발자 황준일 Atom Feed">
    <link rel="alternate" type="application/json" href="https://junilhwang.github.io/TIL/feed.json" title="개발자 황준일 JSON Feed">
    <meta name="description" content="Vanilla Javascript로 Vuex와 Redux 같은 상태관리 시스템을 만드는 방법에 대해 소개합니다.">
    <meta name="google-site-verification" content="sHfBWIoCUOYFXJ3b0ulN8jp9jpD8SEW5Wpxvlk-UABA">
    <link rel="preload" href="/TIL/assets/css/0.styles.1710ac3a.css" as="style"><link rel="preload" href="/TIL/assets/js/app.2a77796b.js" as="script"><link rel="preload" href="/TIL/assets/js/3.c0cd15b9.js" as="script"><link rel="preload" href="/TIL/assets/js/8.ae0ed089.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.d65acbe2.js"><link rel="prefetch" href="/TIL/assets/js/11.2f6b017e.js"><link rel="prefetch" href="/TIL/assets/js/12.1bd94ebe.js"><link rel="prefetch" href="/TIL/assets/js/13.9c79c764.js"><link rel="prefetch" href="/TIL/assets/js/14.9052f09d.js"><link rel="prefetch" href="/TIL/assets/js/15.49d8ba74.js"><link rel="prefetch" href="/TIL/assets/js/16.0d414fd9.js"><link rel="prefetch" href="/TIL/assets/js/17.a21a1ad2.js"><link rel="prefetch" href="/TIL/assets/js/18.1dac679f.js"><link rel="prefetch" href="/TIL/assets/js/19.bbb65f3b.js"><link rel="prefetch" href="/TIL/assets/js/2.1216d139.js"><link rel="prefetch" href="/TIL/assets/js/20.f952c816.js"><link rel="prefetch" href="/TIL/assets/js/21.a78e36d1.js"><link rel="prefetch" href="/TIL/assets/js/22.8ca452ae.js"><link rel="prefetch" href="/TIL/assets/js/23.04c06398.js"><link rel="prefetch" href="/TIL/assets/js/24.76bcd055.js"><link rel="prefetch" href="/TIL/assets/js/25.c00a0ed4.js"><link rel="prefetch" href="/TIL/assets/js/26.61cbb701.js"><link rel="prefetch" href="/TIL/assets/js/27.14bf3c7e.js"><link rel="prefetch" href="/TIL/assets/js/28.fcdfa88d.js"><link rel="prefetch" href="/TIL/assets/js/29.9f5a8dfb.js"><link rel="prefetch" href="/TIL/assets/js/30.ecd3b15c.js"><link rel="prefetch" href="/TIL/assets/js/31.c27f877d.js"><link rel="prefetch" href="/TIL/assets/js/32.8642c1de.js"><link rel="prefetch" href="/TIL/assets/js/33.26421bd2.js"><link rel="prefetch" href="/TIL/assets/js/34.275a95e0.js"><link rel="prefetch" href="/TIL/assets/js/35.fb657618.js"><link rel="prefetch" href="/TIL/assets/js/36.32cb25c1.js"><link rel="prefetch" href="/TIL/assets/js/37.876d2114.js"><link rel="prefetch" href="/TIL/assets/js/38.01a45472.js"><link rel="prefetch" href="/TIL/assets/js/39.5cc6ab9a.js"><link rel="prefetch" href="/TIL/assets/js/4.ef9ef741.js"><link rel="prefetch" href="/TIL/assets/js/40.082a652c.js"><link rel="prefetch" href="/TIL/assets/js/41.af3d4fd2.js"><link rel="prefetch" href="/TIL/assets/js/42.40625c22.js"><link rel="prefetch" href="/TIL/assets/js/43.30fba650.js"><link rel="prefetch" href="/TIL/assets/js/44.d26472c5.js"><link rel="prefetch" href="/TIL/assets/js/45.73eeabb4.js"><link rel="prefetch" href="/TIL/assets/js/46.7dc044f1.js"><link rel="prefetch" href="/TIL/assets/js/47.2086a79c.js"><link rel="prefetch" href="/TIL/assets/js/48.23b58fc1.js"><link rel="prefetch" href="/TIL/assets/js/49.5a75b377.js"><link rel="prefetch" href="/TIL/assets/js/5.7ccc1821.js"><link rel="prefetch" href="/TIL/assets/js/50.94194cca.js"><link rel="prefetch" href="/TIL/assets/js/51.844b6e3c.js"><link rel="prefetch" href="/TIL/assets/js/52.a9c6f496.js"><link rel="prefetch" href="/TIL/assets/js/53.827d03de.js"><link rel="prefetch" href="/TIL/assets/js/54.6af50573.js"><link rel="prefetch" href="/TIL/assets/js/55.bd575f71.js"><link rel="prefetch" href="/TIL/assets/js/56.838b4f70.js"><link rel="prefetch" href="/TIL/assets/js/57.fd0d1dda.js"><link rel="prefetch" href="/TIL/assets/js/6.edaf2f06.js"><link rel="prefetch" href="/TIL/assets/js/7.b5a1edf9.js"><link rel="prefetch" href="/TIL/assets/js/9.de425998.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.1710ac3a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><main class="page"> <div class="hit"><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://junilhwang.github.io/TIL/Javascript/Design/Vanilla-JS-Store/&amp;count_bg=%230099FF&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=%EC%A1%B0%ED%9A%8C%EC%88%98&amp;edge_flat=true" alt="Hits bn"></div> <div class="theme-default-content content__default"><h1 id="vanilla-javascript로-상태관리-시스템-만들기"><a href="#vanilla-javascript로-상태관리-시스템-만들기" class="header-anchor">#</a> Vanilla Javascript로 상태관리 시스템 만들기</h1> <blockquote><p>본 포스트는 Vuex나 Redux 같은 상태관리 프레임워크를 직접 만들어보는 내용이다.
그리고 이 포스트를 읽기 전에 <a href="https://junilhwang.github.io/TIL/Javascript/Design/Vanilla-JS-Component/" target="_blank" rel="noopener noreferrer">Vanilla Javascript로 웹 컴포넌트 만들기<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>를 먼저 정독해야 이해하기가 수월하다.</p></blockquote> <h2 id="_1-중앙-집중식-상태관리"><a href="#_1-중앙-집중식-상태관리" class="header-anchor">#</a> 1. 중앙 집중식 상태관리</h2> <p><a href="https://junilhwang.github.io/TIL/Javascript/Design/Vanilla-JS-Component/" target="_blank" rel="noopener noreferrer">이전에 작성했던 포스트<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>에도 언급했지만, 현대적인 프론트엔드 개발에서 제일 중요한 것은 바로 <code>상태관리</code> 라고 해도 무방하다. Vue나 React 같은 프론트엔드 프레임워크의 주된 목적 중 하나가 <strong>상태를 기반으로 DOM을 렌더링 하는 것</strong>이기 때문이다.</p> <p>학습을 위해 TodoList를 만드는 수준에서는 사실 상태관리 프레임워크가 필요하진 않다. 다양한 종류의 컴포넌트가 있는 것도 아니고, 컴포넌트의 Depth도 낮기 때문이다.</p> <p>그런데 엔터프라이즈급 어플리케이션을 만든다고 생각하면 이야기가 달라진다. 상태관리가 복잡해지고 컴포넌트의 Depth가 무척 깊어지기 때문이다.</p> <p><img src="data:image/png;base64,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" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ea24d26a-1eda-4777-99b7-040d2823e387/Untitled.png"></p> <p>Vuepress의 컴포넌트 구조</p> <p>이 때 <code>중앙 집중식 저장소 역할을 하며 예측 가능한 방식으로 상태를 변경</code> 할 수 있다면 편하지 않을까? 사실 이에 대한 자료는 이미 시중에 많이 있기 때문에 본 포스트에서는 자세하게 다루진 않겠다.</p> <p>대신 다음 아티클을 참고하면 될 것이다.</p> <ul><li><a href="https://vuex.vuejs.org/kr/" target="_blank" rel="noopener noreferrer">Vuex가 무엇인가요?<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://ko.redux.js.org/introduction/getting-started/" target="_blank" rel="noopener noreferrer">Redux 시작하기<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://joshua1988.github.io/web-development/vuejs/vuex-start/" target="_blank" rel="noopener noreferrer">Vuex 시작하기<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="_2-observer-pattern에-대해-이해하기"><a href="#_2-observer-pattern에-대해-이해하기" class="header-anchor">#</a> 2. Observer Pattern에 대해 이해하기</h2> <p><code>중앙 집중식 저장소</code>를 간단하게 <code>Store</code> 라고 표현해보자. <code>Store</code>를 구현하기 위해 먼저 <code>저장소(Store)</code>와 <code>컴포넌트(Component)</code>의 관계를 잘 살펴봐야 한다.</p> <ul><li>Store는 여러 개의 컴포넌트에서 사용될 수 있다..</li> <li>Store가 변경될 때, Store가 사용되고 있는 Component도 변경되어야 한다.</li></ul> <p>이를 코드로 표현해보자.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// Store를 생성한다.</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 컴포넌트를 생성한다.</span>
<span class="token keyword">const</span> component1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span> subscribe<span class="token operator">:</span> <span class="token punctuation">[</span>store<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> component2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span> subscribe<span class="token operator">:</span> <span class="token punctuation">[</span>store<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 컴포넌트가 store를 구독한다.</span>
component1<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a + b = ${store.state.a + store.state.b}</span>
component2<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a * b = ${store.state.a * store.state.b}</span>

<span class="token comment">// store의 state를 변경한다.</span>
store<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// store가 변경되었음을 알린다.</span>
store<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>처음에 <code>component1</code>은 <code>a + b = 30</code>을 출력하고, <code>component2</code>는  <code>a * b = 200</code> 을 출력할 것이다.</li> <li>store의 값이 변경된 다음에는 각각 <code>a + b = 300</code> <code>a * b = 20000</code> 을 출력할 것이다</li></ul> <p>이러한 형태로 코드를 작성하는 것을 <code>Observer Pattern</code> 이라고 한다.</p> <ul><li>Observer pattern은 객체의 상태 변화를 관찰하는 관찰자들, 즉 옵저버들의 목록을 객체에 등록하여 <code>상태 변화가 있을 때마다 메서드 등을 통해 객체가 직접 목록의 각 옵저버에게 통지하도록 하는 디자인 패턴</code>이다.</li> <li>주로 <code>분산 이벤트 핸들링 시스템</code>을 구현하는 데 사용된다.</li> <li><code>발행/구독 모델</code>로 알려져 있기도 한다.</li></ul> <p>대충 어떤 느낌인지만 감이 오는가? <s>이보다 더 자세한 설명이 필요하다면 구글링을 해보자!</s></p> <p>아마 한 번에 이해하기는 어려울 것이다. 우리는 개발자이므로 조금 더 구체적인 코드를 통해 이해해보자.</p> <h3 id="_1-publish"><a href="#_1-publish" class="header-anchor">#</a> (1) Publish</h3> <p>제일 먼저 <code>발행기관(Publish)</code>를 만들어보자.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">class</span> 발행기관 <span class="token punctuation">{</span>
  #state<span class="token punctuation">;</span>
  #observers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#state <span class="token operator">=</span> state<span class="token punctuation">;</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#state<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">내부에_변화가_생김</span> <span class="token punctuation">(</span><span class="token parameter">newState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#state <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>#state<span class="token punctuation">,</span> <span class="token operator">...</span>newState <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">구독자에게_알림</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">구독자_등록</span> <span class="token punctuation">(</span><span class="token parameter">subscriber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#observers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>subscriber<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">구독자에게_알림</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>음.. 어색하지만 일단 최대한의 이해를 돕기 위해 한글로 메소드를 작성했는데, 무척 어색하하다 😅</li> <li>메소드의 내용 그대로 이해하면 될 것이다.</li> <li>위에서 핵심적인 내용은 <code>내부에 변화가 생길 경우 구독자에게 알리는 것</code> 이다.</li></ul> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">내부에_변화가_생김</span> <span class="token punctuation">(</span><span class="token parameter">newState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>#state <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>#state<span class="token punctuation">,</span> <span class="token operator">...</span>newState <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">구독자에게_알림</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-subscriber"><a href="#_2-subscriber" class="header-anchor">#</a> (2) Subscriber</h3> <p>이제 <code>구독자(Subscriber)</code>를 만들어보자.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">class</span> 구독자 <span class="token punctuation">{</span>
  #fn<span class="token punctuation">;</span>

  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter">발행기관에_변화가_생길_때_하는_일</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#fn <span class="token operator">=</span> 발행기관에_변화가_생길_때_하는_일<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">구독</span> <span class="token punctuation">(</span><span class="token parameter">publisher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    publisher<span class="token punctuation">.</span><span class="token function">구독자_등록</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>#fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><ul><li>구독자는 <code>발행기관에서 변화가 생겼을 때 하는 일</code>을 정의해야 한다.</li> <li>그리고 <code>발행기관을 구독</code> 한다.</li></ul> <h3 id="_3-적용하기"><a href="#_3-적용하기" class="header-anchor">#</a> (3) 적용하기</h3> <p>이제 작성된 코드를 사용해보자.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> 상태 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">발행기관</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> 덧셈계산기 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">구독자</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a + b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>a <span class="token operator">+</span> 상태<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> 곱셈계산기 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">구독자</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a * b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>a <span class="token operator">*</span> 상태<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

덧셈계산기<span class="token punctuation">.</span><span class="token function">구독</span><span class="token punctuation">(</span>상태<span class="token punctuation">)</span><span class="token punctuation">;</span>
곱셈계산기<span class="token punctuation">.</span><span class="token function">구독</span><span class="token punctuation">(</span>상태<span class="token punctuation">)</span><span class="token punctuation">;</span>

상태<span class="token punctuation">.</span><span class="token function">구독자에게_알림</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// a + b = 30</span>
<span class="token comment">// a * b = 200</span>

상태<span class="token punctuation">.</span><span class="token function">내부에_변화가_생김</span><span class="token punctuation">(</span><span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// a + b = 300</span>
<span class="token comment">// a * b = 20000</span>
</code></pre></div><p>이에 대한 결과는 다음과 같다.</p> <p><img src="data:image/png;base64,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" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b38545e4-9c87-45a5-acde-20c8ef714646/Untitled.png"></p> <p>그런데 이 코드의 문제점이 있다.</p> <ul><li>지금 작성한 코드는 쉽게 말해서 <code>2명의 구독자</code>가 <code>1개의 신문사(혹은 잡지)</code>를 구독하고 있는 상황이다.</li> <li>그런데 만약에 <code>10명의 구독자</code>가 <code>100개의 신문사(혹은 잡지)</code>를 구독한다고 했을 경우, 구독 관련 코드가 기하급수적으로 늘어날 것이다.</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><a href="https://github.com/JunilHwang/simple-store/blob/master/01-pubsub/index.html" target="_blank" rel="noopener noreferrer">전체 코드 보기<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://junilhwang.github.io/simple-store/01-pubsub/" target="_blank" rel="noopener noreferrer">결과 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <h2 id="_3-리팩토링"><a href="#_3-리팩토링" class="header-anchor">#</a> 3. 리팩토링</h2> <p>앞서 작성한 코드를 다시 단순하게 <code>observable</code>과 <code>observe</code>라는 관계로 만들어보자.</p> <ul><li>observable은 observe 에서 사용된다.</li> <li>observable에 변화가 생기면, observe에 등록된 함수가 실행된다.</li></ul> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> 상태 <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a + b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a * b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a - b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

상태<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
상태<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
</code></pre></div><p>위의 코드는 다음과 같은 결과를 보일 것이다.</p> <p><img src="/TIL/assets/img/3.04f0fb40.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ac5b83d0-6c2e-4e85-98d4-65f08a80285c/Untitled.png"></p> <h3 id="_1-object-defineproperty-이해하기"><a href="#_1-object-defineproperty-이해하기" class="header-anchor">#</a> (1) Object.defineProperty 이해하기</h3> <p>이를 구현하기 위해선 먼저 <a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="noopener noreferrer">Object.defineProperty<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 라는 API에 대해 알아야 한다.</p> <p>MDN 문서에 나와있는 설명은 다음과 같다.</p> <blockquote><p>객체에 직접 새로운 속성을 정의하거나 이미 존재하는 속성을 수정한 후, 그 객체를 반환합니다.</p></blockquote> <p>사실 이런 설명을 보면 이해되지 않는 경우가 대부분일 것이다. 그래서 구구절절 늘어놓기 보단, 역시 코드로 이해하는 게 더 빠를 것이다.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">현재 a의 값은 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 입니다.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> a<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">set</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a <span class="token operator">=</span> value<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">변경된 a의 값은 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 입니다.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">state.a = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>state<span class="token punctuation">.</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
state<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/TIL/assets/img/4.f82b12cd.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/056a896b-cc40-4b46-9ca2-0bdce3358db5/Untitled.png"></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><a href="https://github.com/JunilHwang/simple-store/blob/master/02-object-define-property/01-example.html" target="_blank" rel="noopener noreferrer">코드 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://junilhwang.github.io/simple-store/02-object-define-property/01-example.html" target="_blank" rel="noopener noreferrer">결과 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <ul><li><code>Object.defineProperty(object, prop, descriptor)</code> <ul><li><code>object</code> 속성을 정의할 객체</li> <li><code>prop</code> 새로 정의하거나 수정하려는 속성의 이름 또는 Symbol</li> <li><code>descriptor</code> 새로 정의하거나 수정하려는 속성을 기술하는 객체</li></ul></li></ul> <p>이렇게 <code>Object.defineProperty(object, prop, descriptor)</code> 는 객체에 어떤 변화가 생기거나 객체를 참조할 경우 우리가 원하는 행위를 중간에 집어넣을 수도 있다.</p> <h3 id="_2-여러-개의-속성-관리하기"><a href="#_2-여러-개의-속성-관리하기" class="header-anchor">#</a> (2) 여러 개의 속성 관리하기</h3> <p>여러 개의 속성이 있을 때는 다음과 같이 표현할 수 있다.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> stateKeys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">of</span> stateKeys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> _value <span class="token operator">=</span> state<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">현재 state.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">의 값은 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>_value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 입니다.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> _value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _value <span class="token operator">=</span> value<span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">변경된 state.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">의 값은 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>_value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 입니다.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a + b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>state<span class="token punctuation">.</span>a <span class="token operator">+</span> state<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

state<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
state<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
</code></pre></div><p>결과는 다음과 같다.</p> <p><img src="/TIL/assets/img/5.ead929ba.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ca5e5696-ac79-49dd-bd32-cc12e79bf3ee/Untitled.png"></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><a href="https://github.com/JunilHwang/simple-store/blob/master/02-object-define-property/02-multiple-key.html" target="_blank" rel="noopener noreferrer">코드 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://junilhwang.github.io/simple-store/02-object-define-property/02-multiple-key.html" target="_blank" rel="noopener noreferrer">결과 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <p>여기서 <code>console.log</code> 부분을 <code>observer</code> 함수로 바꿔보자.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> stateKeys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">observer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a + b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>state<span class="token punctuation">.</span>a <span class="token operator">+</span> state<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">of</span> stateKeys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> _value <span class="token operator">=</span> state<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> _value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _value <span class="token operator">=</span> value<span class="token punctuation">;</span>
      <span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

state<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
state<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/TIL/assets/img/6.6cf34e2d.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/42b0cb5a-8a78-4665-86cd-6baa0c28fad1/Untitled.png"></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><a href="https://github.com/JunilHwang/simple-store/blob/master/02-object-define-property/03-multiple-key-refactor.html" target="_blank" rel="noopener noreferrer">코드 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://junilhwang.github.io/simple-store/02-object-define-property/03-multiple-key-refactor.html" target="_blank" rel="noopener noreferrer">결과 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <h3 id="_3-여러-개의-observer-관리하기"><a href="#_3-여러-개의-observer-관리하기" class="header-anchor">#</a> (3) 여러 개의 Observer 관리하기</h3> <p>이제 여러 개의 observer를 만들어서 관리해보자.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">let</span> currentObserver <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> stateKeys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">of</span> stateKeys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> _value <span class="token operator">=</span> state<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> observers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>currentObserver<span class="token punctuation">)</span> observers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>currentObserver<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> _value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _value <span class="token operator">=</span> value<span class="token punctuation">;</span>
      observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">observer</span> <span class="token operator">=&gt;</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">덧셈_계산기</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  currentObserver <span class="token operator">=</span> 덧셈_계산기<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a + b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>state<span class="token punctuation">.</span>a <span class="token operator">+</span> state<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">뺄셈_계산기</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  currentObserver <span class="token operator">=</span> 뺄셈_계산기<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a - b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>state<span class="token punctuation">.</span>a <span class="token operator">-</span> state<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">덧셈_계산기</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
state<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

<span class="token function">뺄셈_계산기</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
state<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>

state<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
state<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre></div><p>이 코드에서 핵심은, 함수가 실행될 때 <code>currentObsever가 실행중인 함수를 참조하도록 만드는 것</code> 이다.</p> <ul><li><code>state</code>의 <code>property</code>가 <strong>사용</strong>될 때(=<code>get</code> 메소드가 실행될 때) currentObserver를 observers에 등록한다.</li> <li><code>state</code>의 <code>property</code>가 <strong>변경</strong>될 때(=<code>set</code> 메소드가 실행될 때) observers에 등록된 모든 observer를 실행한다.</li></ul> <p>결과는 다음과 같다.</p> <p><img src="/TIL/assets/img/7.aece5bd3.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6e1bc392-e496-46b2-8259-8808747b9376/Untitled.png"></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><a href="https://github.com/JunilHwang/simple-store/blob/master/02-object-define-property/04-multiple-observer.html" target="_blank" rel="noopener noreferrer">코드 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://junilhwang.github.io/simple-store/02-object-define-property/04-multiple-observer.html" target="_blank" rel="noopener noreferrer">결과 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <h3 id="_4-함수화"><a href="#_4-함수화" class="header-anchor">#</a> (4) 함수화</h3> <p>앞서 작성한 코드를 재사용하기 위해서 <code>observe</code>와 <code>observable</code> 함수로 만들어야 한다.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">let</span> currentObserver <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">observe</span> <span class="token operator">=</span> <span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  currentObserver <span class="token operator">=</span> fn<span class="token punctuation">;</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  currentObserver <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">observable</span> <span class="token operator">=</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> _value <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> observers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentObserver<span class="token punctuation">)</span> observers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>currentObserver<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> _value<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token function">set</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _value <span class="token operator">=</span> value<span class="token punctuation">;</span>
        observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>다음과 같이 사용할 수 있다.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> 상태 <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a + b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a * b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a - b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>상태<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

상태<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
상태<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
</code></pre></div><p>결과는 다음과 같다.</p> <p><img src="/TIL/assets/img/8.2adce0d0.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6a51674e-2737-4889-a6cc-74673f71038e/Untitled.png"></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><a href="https://github.com/JunilHwang/simple-store/blob/master/02-object-define-property/05-functionalized.html" target="_blank" rel="noopener noreferrer">코드 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://junilhwang.github.io/simple-store/02-object-define-property/05-functionalized.html" target="_blank" rel="noopener noreferrer">결과 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <h2 id="_4-dom에-적용하기"><a href="#_4-dom에-적용하기" class="header-anchor">#</a> 4. DOM에 적용하기</h2> <p>이제 DOM(Component)에 직접 적용해보자.</p> <h3 id="_1-일단-구현해보기"><a href="#_1-일단-구현해보기" class="header-anchor">#</a> (1) 일단 구현해보기</h3> <p>일단 구조적인 부분은 생각하지말고, 기능만 구현해보자.</p> <ul><li><p><code>index.html</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Store를 적용해보자<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./src/main.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p><code>src/main.js</code></p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> observable<span class="token punctuation">,</span> observe <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./core/observer.js&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> $app <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  $app<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;p&gt;a + b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>state<span class="token punctuation">.</span>a <span class="token operator">+</span> state<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p&gt;
    &lt;input id=&quot;stateA&quot; value=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>state<span class="token punctuation">.</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; /&gt;
    &lt;input id=&quot;stateB&quot; value=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>state<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; /&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

  $app<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#stateA'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  $app<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#stateB'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">observe</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><code>src/core/observer.js</code></p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">let</span> currentObserver <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">observe</span> <span class="token operator">=</span> <span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  currentObserver <span class="token operator">=</span> fn<span class="token punctuation">;</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  currentObserver <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">observable</span> <span class="token operator">=</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> _value <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> observers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentObserver<span class="token punctuation">)</span> observers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>currentObserver<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> _value<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token function">set</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _value <span class="token operator">=</span> value<span class="token punctuation">;</span>
        observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <p>input의 값을 변경할 경우 바로 rendering이 실행될 것이다.</p> <iframe src="https://junilhwang.github.io/simple-store/03-with-component/01-just-implement/" width="100%" class="example-frame"></iframe> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><a href="https://github.com/JunilHwang/simple-store/tree/master/03-with-component/01-just-implement/" target="_blank" rel="noopener noreferrer">전체코드<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://junilhwang.github.io/simple-store/03-with-component/01-just-implement/" target="_blank" rel="noopener noreferrer">브라우저에서 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <h3 id="_2-component로-추상화하기"><a href="#_2-component로-추상화하기" class="header-anchor">#</a> (2) Component로 추상화하기</h3> <ul><li><p>먼저 <a href="https://junilhwang.github.io/TIL/Javascript/Design/Vanilla-JS-Component/#_2-%E1%84%8E%E1%85%AE%E1%84%89%E1%85%A1%E1%86%BC%E1%84%92%E1%85%AA" target="_blank" rel="noopener noreferrer">웹 컴포넌트 만들기<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>의 코드를 참고하여 Component 코드를 구성해보자.</p></li> <li><p><code>src/core/Component.js</code></p> <div class="language-jsx extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br></div><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> observable<span class="token punctuation">,</span> observe <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./observer.js'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">;</span> props<span class="token punctuation">;</span> $el<span class="token punctuation">;</span>

  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter">$el<span class="token punctuation">,</span> props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$el <span class="token operator">=</span> $el<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props <span class="token operator">=</span> props<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// state를 관찰한다.</span>
    <span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// state가 변경될 경우, 함수가 실행된다.</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
  <span class="token function">template</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">template</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token function">setEvent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div></li> <li><p>그 다음 <code>src/App.js</code> 에 <code>Component</code>를 적용해보자.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./core/Component.js&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">initState</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
      b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">template</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> a<span class="token punctuation">,</span> b <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      &lt;input id=&quot;stateA&quot; value=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; size=&quot;5&quot; /&gt;
      &lt;input id=&quot;stateB&quot; value=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; size=&quot;5&quot; /&gt;
      &lt;p&gt;a + b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>a <span class="token operator">+</span> b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">setEvent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> $el<span class="token punctuation">,</span> state <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    $el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#stateA'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    $el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#stateB'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>그 다음 <code>src/main.js</code> 에서 <code>App</code>을 불러와서 실행시켜야한다.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./App.js&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">App</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <iframe src="https://junilhwang.github.io/simple-store/03-with-component/02-component/" width="100%" class="example-frame"></iframe> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><a href="https://github.com/JunilHwang/simple-store/tree/master/03-with-component/02-component/" target="_blank" rel="noopener noreferrer">전체코드<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://junilhwang.github.io/simple-store/03-with-component/02-component/" target="_blank" rel="noopener noreferrer">브라우저에서 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <p>결과물은 똑같다. 다만 구조화를 했을 뿐!</p> <h3 id="_3-고민해보기"><a href="#_3-고민해보기" class="header-anchor">#</a> (3) 고민해보기</h3> <p>사실 이렇게 Component 내부에서 관리되는 State에 observable을 씌워 사용할 경우 만들 경우 <code>setState</code>를 사용하는 방식이랑 크게 다르지 않다고 느낄 수 있다.
<strong>setState 또한 state가 변경될 때 마다 render를 실행하는 방식</strong>이기 때문이다.</p> <div class="language-jsx extra-class"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-jsx"><code><span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">newState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> <span class="token operator">...</span>newState <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">template</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>observer</code>는 이렇게 컴포넌트의 상태에 사용하기 보단 <code>중앙 집중식 저장소</code> 를 관리할때 매우 효과적이다.</p> <h3 id="_4-컴포넌트-외부에-상태를-만들어주기"><a href="#_4-컴포넌트-외부에-상태를-만들어주기" class="header-anchor">#</a> (4) 컴포넌트 외부에 상태를 만들어주기</h3> <p>Vuex나 Redux 같은 프레임워크를 사용하기 이전에, 일단 <strong>매우 간단하게 Store를 만들어서 관리</strong>해보자.</p> <ul><li><code>src/store.js</code></li></ul> <div class="language-jsx extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./core/observer.js'</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token punctuation">{</span>

  state<span class="token operator">:</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token function">setState</span> <span class="token punctuation">(</span><span class="token parameter">newState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>newState<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>src/App.js</code></li></ul> <div class="language-jsx extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./core/Component.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./store.js'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">InputA</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  &lt;input id=&quot;stateA&quot; value=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; size=&quot;5&quot; /&gt;
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">InputB</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  &lt;input id=&quot;stateB&quot; value=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; size=&quot;5&quot; /&gt;
</span><span class="token template-punctuation string">`</span></span>

<span class="token keyword">const</span> <span class="token function-variable function">Calculator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  &lt;p&gt;a + b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>a <span class="token operator">+</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p&gt;
</span><span class="token template-punctuation string">`</span></span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">template</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">InputA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">InputB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">Calculator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">setEvent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> $el<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    $el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#stateA'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      store<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    $el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#stateB'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      store<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> b<span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>여기서 InputA, InputB, Calculator를 무척 단순하게 구현했는데, 이게 전부 복잡한 컴포넌트라고 생각해보자.
<strong>세 개의 컴포넌트가 store를 참조</strong>하고 있고, <strong>store가 변경되었을 때 컴포넌트가 자동으로 렌더링</strong> 되는 형태로 만든 것이다.</li> <li>여기에 <strong>Flux 패턴</strong>을 붙이면 <strong>Redux</strong>나 <strong>Vuex</strong>가 되는 것이다.</li></ul> <iframe src="https://junilhwang.github.io/simple-store/03-with-component/03-store/" width="100%" class="example-frame"></iframe> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><a href="https://github.com/JunilHwang/simple-store/tree/master/03-with-component/03-store/" target="_blank" rel="noopener noreferrer">전체코드<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://junilhwang.github.io/simple-store/03-with-component/03-store/" target="_blank" rel="noopener noreferrer">브라우저에서 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <h2 id="_5-flux-pattern"><a href="#_5-flux-pattern" class="header-anchor">#</a> 5. Flux Pattern</h2> <p>앞서 Observer Pattern에 대해 알아본 것 처럼, Vuex나 Redux에서 사용되는 Flux Pattern에 대해서 알아보자.</p> <p><img src="/TIL/assets/img/9.c657b6ab.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e7145258-f0a0-4743-81a1-850a8ab1ab5c/Untitled.png"></p> <ul><li>Flux의 가장 큰 특징은 <strong>단방향 데이터 흐름</strong>이다.</li> <li>데이터 흐름은 다음과 같다
<ul><li>Dispatcher → Store</li> <li>Store → View</li> <li>View → Action</li> <li>Action → Dispatcher</li></ul></li> <li>이런 단방향 데이터 흐름은 데이터 변화를 휠씬 예측하기 쉽게 만든다.</li></ul> <p>Vue는 이를 조금 변형하여 다음과 같은 형태로 사용한다.</p> <p><img src="/TIL/assets/img/10.8466eecc.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4357f11a-1db2-4543-b51b-1ea4022cd148/Untitled.png"></p> <ul><li>actions, mutations, state를 묶어서 store라고 보면 된다.</li> <li>state를 변화시킬 수 있는 것은 오직 mutations다.</li> <li>actions는 backend api를 가쳐온 다음에 mutations를 이용하여 데이터를 변경한다.</li> <li>state가 변경 되면, state를 사용 중인 컴포넌트를 업데이트한다.</li></ul> <h2 id="_6-vuex-같은-store-만들기"><a href="#_6-vuex-같은-store-만들기" class="header-anchor">#</a> 6. Vuex 같은 Store 만들기</h2> <p>일단 vuex를 만들기 이전에, vuex가 어떤 interface를 가지고 있는지 살펴보자.
<a href="https://vuex.vuejs.org/kr/guide/" target="_blank" rel="noopener noreferrer">공식문서<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>에서 보여주고 있는 코드는 다음과 같다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">increment</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>count<span class="token operator">++</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>state</code>가 있고, state를 변경시킬 수 있는 <code>mutations</code>가 존재하는 것을 확인할 수 있다.</p> <p>그리고 이렇게 선언된 store는 다음과 같이 사용된다.</p> <div class="language-js extra-class"><pre class="language-js"><code>store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token comment">// -&gt; 1</span>
</code></pre></div><p><code>commit</code>으로 <code>mutations</code>에 선언된 메소드를 실행하는 구조이다.</p> <p>이러한 형태로 사용할 수 있도록 한 번 <code>Store</code> 클래스를 구성해보자.</p> <ul><li><p><code>src/core/Store.js</code></p> <div class="language-jsx extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./observer.js'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Store</span> <span class="token punctuation">{</span>

  #state<span class="token punctuation">;</span> #mutations<span class="token punctuation">;</span> #actions<span class="token punctuation">;</span> <span class="token comment">// private으로 지정하여 외부에서는 접근이 안 되도록 한다.</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> state<span class="token punctuation">,</span> mutations<span class="token punctuation">,</span> actions <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#state <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#mutations <span class="token operator">=</span> mutations<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#actions <span class="token operator">=</span> actions<span class="token punctuation">;</span>
    
    <span class="token comment">// state를 직접적으로 수정하지 못하도록 다음과 같이 정의한다.</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span>
        key<span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#state<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">commit</span> <span class="token punctuation">(</span><span class="token parameter">action<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// state는 오직 commit을 통해서 수정 할 수 있다.</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#mutations<span class="token punctuation">[</span>action<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>#state<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">dispatch</span> <span class="token punctuation">(</span><span class="token parameter">action<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 예제에서 dispatch는 사용되고 있진 않진 않지만 아마 vuex를 써본 사람이라면 익숙할 것이다.
     * @see {https://vuex.vuejs.org/kr/api/#actions}
     */</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#actions<span class="token punctuation">[</span>action<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      state<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#state<span class="token punctuation">,</span>
      commit<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      dispatch<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>dispatch</code>에서 실행해주는 <code>action</code>의 첫 번째 인자인 <code>context</code> 의 요소는 <a href="https://vuex.vuejs.org/kr/api/#actions" target="_blank" rel="noopener noreferrer">이 문서<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>에서 확인할 수 있다.</li> <li><code>store.state</code>는 Object.defineProperty로 get만 사용할 수 있도록 선언했다. 즉, 직접적으로 할당할 수 없는 형태이다.</li> <li><code>store.state</code>의 값을 변경하고 싶다면 무조건 <code>commit</code> method를 사용해야 한다.</li></ul></li> <li><p><code>src/store.js</code></p> <div class="language-jsx extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./core/Store.js'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// state의 값은 오직 mutations를 통해서 변경할 수 있다.</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token constant">SET_A</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>a <span class="token operator">=</span> payload<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token constant">SET_B</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>b <span class="token operator">=</span> payload<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// actions도 있으면 좋겠지만.. 딱히 지금 쓸만한 API가 없다.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><code>src/App.js</code></p> <div class="language-jsx extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./core/Component.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./store.js'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">InputA</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;input id=&quot;stateA&quot; value=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; size=&quot;5&quot; /&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">InputB</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;input id=&quot;stateB&quot; value=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; size=&quot;5&quot; /&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">Calculator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;p&gt;a + b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>a <span class="token operator">+</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">template</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">InputA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">InputB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">Calculator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">setEvent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> $el<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    $el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#stateA'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// commit을 통해서 값을 변경시킨다.</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'SET_A'</span><span class="token punctuation">,</span> <span class="token function">Number</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    $el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#stateB'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// commit을 통해서 값을 변경시킨다.</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'SET_B'</span><span class="token punctuation">,</span> <span class="token function">Number</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <p>이렇게 vuex를 정의해 사용할 수 있다. 원리만 알고 있다면 크게 어렵지 않을 것이다.</p> <iframe src="https://junilhwang.github.io/simple-store/04-simple-vuex/" width="100%" class="example-frame"></iframe> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><a href="https://github.com/JunilHwang/simple-store/tree/master/04-simple-vuex" target="_blank" rel="noopener noreferrer">전체코드<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://junilhwang.github.io/simple-store/04-simple-vuex/" target="_blank" rel="noopener noreferrer">브라우저에서 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <h2 id="_7-redux-만들기"><a href="#_7-redux-만들기" class="header-anchor">#</a> 7. Redux 만들기</h2> <p>앞선 과정 처럼 Redux를 만들기 전에, Redux가 사용되는 형태를 일단 살펴보자.
<a href="https://ko.redux.js.org/introduction/getting-started/" target="_blank" rel="noopener noreferrer">공식 문서<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>에 나와있는 코드이다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span>

<span class="token comment">/**
 * 이것이 (state, action) =&gt; state 형태의 순수 함수인 리듀서입니다.
 * 리듀서는 액션이 어떻게 상태를 다음 상태로 변경하는지 서술합니다.
 *
 * 상태의 모양은 당신 마음대로입니다: 기본형(primitive)일수도, 배열일수도, 객체일수도,
 * 심지어 Immutable.js 자료구조일수도 있습니다.  오직 중요한 점은 상태 객체를 변경해서는 안되며,
 * 상태가 바뀐다면 새로운 객체를 반환해야 한다는 것입니다.
 *
 * 이 예제에서 우리는 `switch` 구문과 문자열을 썼지만,
 * 여러분의 프로젝트에 맞게
 * (함수 맵 같은) 다른 컨벤션을 따르셔도 좋습니다.
 */</span>
<span class="token keyword">function</span> <span class="token function">counter</span><span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'INCREMENT'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">case</span> <span class="token string">'DECREMENT'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 앱의 상태를 보관하는 Redux 저장소를 만듭니다.</span>
<span class="token comment">// API로는 { subscribe, dispatch, getState }가 있습니다.</span>
<span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span>

<span class="token comment">// subscribe()를 이용해 상태 변화에 따라 UI가 변경되게 할 수 있습니다.</span>
<span class="token comment">// 보통은 subscribe()를 직접 사용하기보다는 뷰 바인딩 라이브러리(예를 들어 React Redux)를 사용합니다.</span>
<span class="token comment">// 하지만 현재 상태를 localStorage에 영속적으로 저장할 때도 편리합니다.</span>

store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// 내부 상태를 변경하는 유일한 방법은 액션을 보내는 것뿐입니다.</span>
<span class="token comment">// 액션은 직렬화할수도, 로깅할수도, 저장할수도 있으며 나중에 재실행할수도 있습니다.</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'INCREMENT'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 1</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'INCREMENT'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 2</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'DECREMENT'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 1</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>사실 redux는 <code>불변성</code> 이라는 개념을 사용하고 있기 때문에 <code>observable</code>과 <code>observe</code>를 이용하는 것이 부자연스러울 수 있다.</p></div> <p>코드를 살펴보니 <code>createStore</code>가 <code>subscribe, dispatch, getState</code> 등의 메소드를 가진 객체를 반환하는 것을 알 수 있다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">createStore</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">reducer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 내부 구현 */</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> subscribe<span class="token punctuation">,</span> dispatch<span class="token punctuation">,</span> getState <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>이렇게 interface만 알고 있어도 구현은 어렵지 않다. 한 번 구현해보자.</p> <ul><li><code>src/core/Store.js</code></li></ul> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./observer.js'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createStore</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">reducer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  
  <span class="token comment">// reducer가 실행될 때 반환하는 객체(state)를 observable로 만들어야 한다.</span>
  <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token function">reducer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// getState가 실제 state를 반환하는 것이 아니라 frozenState를 반환하도록 만들어야 한다.</span>
  <span class="token keyword">const</span> frozenState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>frozenState<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// get만 정의하여 set을 하지 못하도록 만드는 것이다.</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// dispatch로만 state의 값을 변경할 수 있다.</span>
  <span class="token keyword">const</span> <span class="token function-variable function">dispatch</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> newState <span class="token operator">=</span> <span class="token function">reducer</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>newState<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// state의 key가 아닐 경우 변경을 생략한다.</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
      state<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> <span class="token function-variable function">getState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> frozenState<span class="token punctuation">;</span>
  
  <span class="token comment">// subscribe는 observe로 대체한다.</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> getState<span class="token punctuation">,</span> dispatch <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><p>이제 createStore를 이용하여 store를 만들어보자.</p> <ul><li><code>src/store.js</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>createStore<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./core/Store.js'</span><span class="token punctuation">;</span>

<span class="token comment">// 초기 state의 값을 정의해준다.</span>
<span class="token keyword">const</span> initState <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// dispatch에서 사용될 type들을 정의해준다.</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SET_A</span> <span class="token operator">=</span> <span class="token string">'SET_A'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SET_B</span> <span class="token operator">=</span> <span class="token string">'SET_B'</span><span class="token punctuation">;</span>

<span class="token comment">// reducer를 정의하여 store에 넘겨준다.</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> initState<span class="token punctuation">,</span> action <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'SET_A'</span> <span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> a<span class="token operator">:</span> action<span class="token punctuation">.</span>payload <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token string">'SET_B'</span> <span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> b<span class="token operator">:</span> action<span class="token punctuation">.</span>payload <span class="token punctuation">}</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// reducer에서 사용될 action을 정의해준다.</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">setA</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">payload</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token constant">SET_A</span><span class="token punctuation">,</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">setB</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">payload</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token constant">SET_B</span><span class="token punctuation">,</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>이제 App에서 Store를 사용하도록 작업해줘야 한다.</p> <ul><li><code>src/App.js</code></li></ul> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./core/Component.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>setA<span class="token punctuation">,</span> setB<span class="token punctuation">,</span> store<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./store.js'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">InputA</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;input id=&quot;stateA&quot; value=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; size=&quot;5&quot; /&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">InputB</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;input id=&quot;stateB&quot; value=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; size=&quot;5&quot; /&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">Calculator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;p&gt;a + b = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>a <span class="token operator">+</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">template</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">InputA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">InputB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">Calculator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">setEvent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> $el<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    $el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#stateA'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// commit을 통해서 값을 변경시킨다.</span>
      store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">setA</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    $el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#stateB'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// commit을 통해서 값을 변경시킨다.</span>
      store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">setB</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><iframe src="https://junilhwang.github.io/simple-store/05-simple-redux/" width="100%" class="example-frame"></iframe> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><a href="https://github.com/JunilHwang/simple-store/tree/master/05-simple-redux" target="_blank" rel="noopener noreferrer">전체코드<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://junilhwang.github.io/simple-store/05-simple-redux/" target="_blank" rel="noopener noreferrer">브라우저에서 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <p>이렇게 간단한 <code>redux</code>를 만들 수 있다.</p> <h2 id="_8-심화학습"><a href="#_8-심화학습" class="header-anchor">#</a> 8. 심화학습</h2> <p><code>observable</code>과 <code>observer</code>를 사용할 때 고려해야 할 것들이 몇 가지 더 있다.</p> <h3 id="_1-최적화"><a href="#_1-최적화" class="header-anchor">#</a> (1) 최적화</h3> <p>상태가 변경되어 render를 해야하는데, 만약에 변경된 상태가 이전 상태와 값이 똑같을 경우에는 어떻게 해야할까?</p> <div class="language-js extra-class"><pre class="language-js"><code>state<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
state<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
state<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
state<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p>이럴 때는 다시 렌더링 되지 않도록 방어로직을 작성하면 된다.</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div></div><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">observable</span> <span class="token operator">=</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> _value <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> observers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentObserver<span class="token punctuation">)</span> observers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>currentObserver<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> _value<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token function">set</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>_value <span class="token operator">===</span> value<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>_value<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        _value <span class="token operator">=</span> value<span class="token punctuation">;</span>
        observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>숫자, 문자열, null, undefined 등의 원시타입은 <code>_value === value</code> 처럼 검사하면 된다.</li> <li>배열이나 객체의 경우 <code>JSON.stringify(_value) === JSON.stringify(value)</code>를 사용하면 된다.</li> <li>Set, Map, WeekSet, WeekMap 같은 것들은 <code>JSON.stringify</code>로 변환되지 않는다. 이런 경우에는 추가적인 검사 로직이 필요하다.
<ul><li>시간이 된다면 직접 구현해보길!</li> <li>내용이 너무 길어지고 있어서 다시 구현하기는 귀찮다..</li></ul></li></ul> <p>그리고 상태가 연속으로 변경되는 경우에는 어떻게 해야 좋을까?</p> <div class="language-js extra-class"><pre class="language-js"><code>state<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
state<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre></div><p>단순하게 console.log를 찍는 경우라면 상관없지만, 브라우저에 DOM으로 렌더링 되는 경우라면 이야기가 다르다.
이럴 때는 <code>requestAnimationFrame</code>과 <code>debounce</code>를 이용하여 한 프레임에 한 번만 렌더링 되도록 만들어줘야한다.</p> <div class="custom-block tip"><p class="custom-block-title">requestAnimationFrame</p> <p><a href="https://developer.mozilla.org/ko/docs/Web/API/Window/requestAnimationFrame" target="_blank" rel="noopener noreferrer">MDN 문서<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>에 나와있는 내용은 다음과 같다.</p> <ul><li>브라우저에게 수행하기를 원하는 애니메이션을 알리고 다음 리페인트가 진행되기 전에 해당 애니메이션을 업데이트하는 함수를 호출하게 합니다.
이 메소드는 <strong>리페인트 이전에 실행할 콜백</strong>을 인자로 받습니다.</li> <li>화면에 새로운 애니메이션을 업데이트할 준비가 될때마다 이 메소드를 호출하는것이 좋습니다.
<strong>콜백의 수는 보통 1초에 60회</strong>지만,
일반적으로 대부분의 브라우저에서는 W3C 권장사항에 따라 그 수가 <strong>디스플레이 주사율과 일치</strong>하게됩니다.</li></ul> <p>쉽게 말해서 requestAnimationFrame은 1프레임에 1회 호출된다. 보통 <code>1초에 60프레임</code>이고, 1프레임은 약 <code>16ms</code> 정도 된다.</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">debounceFrame</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> currentCallback <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span>currentCallback<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 현재 등록된 callback이 있을 경우 취소한다.</span>
    currentCallback <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1프레임 뒤에 실행되도록 한다.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">debounceFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">debounceFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">debounceFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">debounceFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">debounceFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 이것만 실행된다.</span>
</code></pre></div><p><img src="/TIL/assets/img/11.ff54fa22.png" alt="결과11"></p> <p>이렇게 구성한 debounceFrame을 <code>observe</code>에 씌워주면 된다. 그런데 debounce된 함수를 넘겨야해서, 즉시실행 부분은 제거해야줘야 한다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">debounceFrame</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> currentCallback <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span>currentCallback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    currentCallback <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">observe</span> <span class="token operator">=</span> <span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  currentObserver <span class="token operator">=</span> <span class="token function">debounceFrame</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  currentObserver <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><a href="https://github.com/JunilHwang/simple-store/tree/master/06-optimization/src/core/observer.js" target="_blank" rel="noopener noreferrer">전체코드<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://junilhwang.github.io/simple-store/06-optimization/" target="_blank" rel="noopener noreferrer">브라우저에서 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <h3 id="_2-proxy"><a href="#_2-proxy" class="header-anchor">#</a> (2) Proxy</h3> <p>사실 <code>Object.defineProperty</code>는 <code>IE</code>를 지원하기 위해 사용하는 <code>API</code>이다.
최신 브라우저에서는 <a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="noopener noreferrer">Proxy<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>를 이용한다면 더 쉽게 <code>Observable</code>을 만들 수 있다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">observable</span> <span class="token operator">=</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  
  <span class="token keyword">const</span> observerMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      observerMap<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> observerMap<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>currentObserver<span class="token punctuation">)</span> observerMap<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>currentObserver<span class="token punctuation">)</span>
      <span class="token keyword">return</span> target<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> name<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">===</span> value<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>target<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      target<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
      observerMap<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><p>맥락은 크게 다르지 않지만, Proxy를 사용하는 코드가 더 짧은 것을 알 수 있다.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><a href="https://github.com/JunilHwang/simple-store/tree/master/07-proxy/src/core/observer.js" target="_blank" rel="noopener noreferrer">전체코드<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://junilhwang.github.io/simple-store/07-proxy/" target="_blank" rel="noopener noreferrer">브라우저에서 확인<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <h2 id="저장소"><a href="#저장소" class="header-anchor">#</a> 저장소</h2> <ul><li>이 아티클에 사용된 모든 코드는 <a href="https://github.com/JunilHwang/simple-store" target="_blank" rel="noopener noreferrer">여기<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>에서 확인할 수 있습니다.</li></ul> <h2 id="summary"><a href="#summary" class="header-anchor">#</a> Summary</h2> <ul><li>컴포넌트가 많아질수록 상태를 관리하기가 힘들어진다.</li> <li>이 때 컴포넌트에 종속적이지 않은 중앙집중형저장소(Store)를 만들어서 사용하면 편리하다.</li> <li>상태관리 시스템을 이해하기 위해선 <code>Observer Pattern</code>과 <code>Flux Pattern</code> 을 먼저 이해해야 한다.</li> <li><code>Observer Pattern</code>을 그대로 사용할 경우 매우 번거롭다. 이 때 <code>Object.defineProperty</code> 를 이용하여 자동화할 수 있다.
<ul><li>포스트에서는 다루지 않았지만 최신 브라우저에서는 Proxy를 이용해도 무방하다.</li></ul></li></ul> <h2 id="reference"><a href="#reference" class="header-anchor">#</a> Reference</h2> <ul><li><a href="https://beomy.tistory.com/44" target="_blank" rel="noopener noreferrer">[디자인패턴] Flux, MVC 비교<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://meetup.toast.com/posts/188" target="_blank" rel="noopener noreferrer">0.7KB로 Vue와 같은 반응형 시스템 만들기<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://vuex.vuejs.org/kr/" target="_blank" rel="noopener noreferrer">Vuex 공식문서<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/27/2021, 9:56:10 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TIL/Javascript/Design/Vanilla-JS-Component/" class="prev">Vanilla Javascript로 웹 컴포넌트 만들기</a></span> <span class="next"><a href="/TIL/Vuepress/Starter/">Vuepress 시작하기</a>
      →
    </span></p></div>  <div><div id="comment"></div></div></main> <header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><figure><img src="https://avatars1.githubusercontent.com/u/18749057?s=460&amp;v=4" alt="개발자 황준일"></figure> <div><strong>개발자 황준일</strong> <em>Today I Learned</em></div></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/TIL/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/junilhwang/TIL/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Repository
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/TIL/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/junilhwang/TIL/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Repository
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/TIL/" aria-current="page" class="sidebar-link">Home</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>회고</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Javascript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Domain</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Design</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/Javascript/Design/Vanilla-JS-Component/" class="sidebar-link">Vanilla Javascript로 웹 컴포넌트 만들기</a></li><li><a href="/TIL/Javascript/Design/Vanilla-JS-Store/" aria-current="page" class="active sidebar-link">Vanilla Javascript로 상태관리 시스템 만들기</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_1-중앙-집중식-상태관리" class="sidebar-link">1. 중앙 집중식 상태관리</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_2-observer-pattern에-대해-이해하기" class="sidebar-link">2. Observer Pattern에 대해 이해하기</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_1-publish" class="sidebar-link">(1) Publish</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_2-subscriber" class="sidebar-link">(2) Subscriber</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_3-적용하기" class="sidebar-link">(3) 적용하기</a></li></ul></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_3-리팩토링" class="sidebar-link">3. 리팩토링</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_1-object-defineproperty-이해하기" class="sidebar-link">(1) Object.defineProperty 이해하기</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_2-여러-개의-속성-관리하기" class="sidebar-link">(2) 여러 개의 속성 관리하기</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_3-여러-개의-observer-관리하기" class="sidebar-link">(3) 여러 개의 Observer 관리하기</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_4-함수화" class="sidebar-link">(4) 함수화</a></li></ul></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_4-dom에-적용하기" class="sidebar-link">4. DOM에 적용하기</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_1-일단-구현해보기" class="sidebar-link">(1) 일단 구현해보기</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_2-component로-추상화하기" class="sidebar-link">(2) Component로 추상화하기</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_3-고민해보기" class="sidebar-link">(3) 고민해보기</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_4-컴포넌트-외부에-상태를-만들어주기" class="sidebar-link">(4) 컴포넌트 외부에 상태를 만들어주기</a></li></ul></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_5-flux-pattern" class="sidebar-link">5. Flux Pattern</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_6-vuex-같은-store-만들기" class="sidebar-link">6. Vuex 같은 Store 만들기</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_7-redux-만들기" class="sidebar-link">7. Redux 만들기</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_8-심화학습" class="sidebar-link">8. 심화학습</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_1-최적화" class="sidebar-link">(1) 최적화</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#_2-proxy" class="sidebar-link">(2) Proxy</a></li></ul></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#저장소" class="sidebar-link">저장소</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#summary" class="sidebar-link">Summary</a></li><li class="sidebar-sub-header"><a href="/TIL/Javascript/Design/Vanilla-JS-Store/#reference" class="sidebar-link">Reference</a></li></ul></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vuepresse</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Book Review</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>코드스피츠</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>개발환경</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/TIL/Writing/" class="sidebar-link">개발자의 글쓰기</a></li></ul> </aside> <footer class="siteFooter"><div class="container"><p class="siteFooterCopyright">
      Copyright © 2019 All Right <em>개발자 황준일</em></p> <p class="siteFooterContact">
      tjsdlf4261@gmail.com .
      +82-10-5764-4483 .
      <a href="https://github.com/junilhwang" target="_blank">GitHub</a> .
      <a href="http://junil-hwang.com" target="_blank">Blog</a> .
      <a href="https://github.com/junilhwang/TIL/" target="_blank">Repository</a></p></div></footer></div><div class="global-ui"></div></div>
    <script src="/TIL/assets/js/app.2a77796b.js" defer></script><script src="/TIL/assets/js/3.c0cd15b9.js" defer></script><script src="/TIL/assets/js/8.ae0ed089.js" defer></script>
  </body>
</html>
